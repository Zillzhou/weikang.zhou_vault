# RDS 网页端后台管理页面介绍

## RDS 网页端后台管理页面介绍
## 运行监控
1701063269682-456a2876-f13e-453e-b3f5-82441db7adc8.png

注意：如果需要对地图页面大屏展示，可以点击页面的分享按钮，然后复制链接，到浏览器打开
1701074296703-d3517a01-afcf-477a-9636-1f5d07a23a23.png

1701074324364-558e405b-1541-44a3-b8b7-2e5041f3b51e.png

### RDS 运行监控页面，可以对以下内容进行监控：
显示机器人的运行线路、站点、区域和互斥区。
实时显示机器人的工作状态、运行情况和资源占用情况。
库位的空满状态和锁定状态。
实时显示电  梯、门和交通管制区等设备状态。
同时该页面也可以对机器人、设备等相关的交互性操作进行监控。
运行监控中使用的场景地图来源【 Core 】。如果场景发生变化，RDS 后台会自动拉取，实时通知界面更新场景。这里需要注意一下，我们会根据车型的模型文件名称的前缀来显示不同的车体，比如一下前缀文本：
## jack表示顶升
## fork表示叉车
## picking表示料箱车
## wash表示清洁车
例如一辆叉车原来的模型名是model，如果希望在运行监控显示的机器人为真实的叉车样式，则叉车的模型名可以改成forkmodel，以fork为前缀。
## RDS 运行监控界面划分：
## 搜索栏
## 工具栏
## 运行监控
## 底栏
1701063436898-32664f1b-b9f8-418d-8bae-c035e5804424.png

## 1.1 搜索栏
1701063460276-9477e192-3778-4bca-a2d9-5b6938cf6682.png

## 搜索栏具有的按钮：
## 搜索
## 轮回点击可打开或关闭搜索栏
## 区域切换

### 搜索栏提供了以下场景元素的相关搜索功能：
## 机器人
## 库位
## 站点
## 路径
## 高级区域

### 输入相关的查询文字可过滤搜索，如下图所示：
1701063542058-c7f7b831-3d96-4c7e-91b0-a75a62b25f5e.png

勾选搜索的内容时，地图将会主动性的移到搜索内容的“中心点”上（也会根据显示情况适当的放大），方便对相应的元素做进一步操作。
1701063572004-e54d9120-19b2-4ca0-9125-755805a7d038.png

## 1.2 工具栏
## 场景切换
### 如果 Core 中含有多个场景，可在场景切换中切换场景

## 机器人操作
### 可接单/不接单占用资源/不接单不占用资源
## 抢占控制权/释放控制权
## 导航的暂停/继续
## 确认定位

## 属性
主要是用来展示场景中元素的相关属性信息，点击属性面板可以选择打开或者收起。可用来展示属性的场景元素有：
## 机器人
## 线路
## 站点
## 高级区域
## 库位
## 电梯门

## 机器人的属性展示如下：
1701063600527-c511723c-31c9-43d5-bb7c-b91683a21c2e.png

## 主要展示机器人的以下信息：
## 机器人的定位状态
## 机器人的电量
## 机器人的置信度
## 机器人是否处于阻挡中
## 机器人的运行里程数、运行时间
上述的信息用于在实际的生产中查看机器人的大致使用情况。

## 线路
## 双线路的展示如下：
1701063624224-bdd5be98-c940-4e4a-b4c1-c8c2b5db680e.png

## 单线路的展示如下：
1653530166195-d919fca4-7bc7-41ba-af44-66fe95aee72d.png

## 线的类型有：
## 直线
## 贝塞尔曲线
## 圆弧线

## 站点
## 站点显示的属性如下图：
1701063654678-6509ba98-d3db-472b-ac37-d17d7c2a31f8.png

说明：站点是可以带方向的。

## 区域
1653530178071-ae536861-a28d-49f4-a4c8-2635d63ed5ba.png

说明：区域在场景中显示同样可以有方向。
1653530190642-6c42418a-4f16-4c41-bcca-b01fafd5e20f.png

## 库 位
## 显示如下图：
1701063681276-cc4585fa-8ee5-4c70-b96f-69172363d213.png

显示当前是否为多层库位。

## 场景设置
1701063707628-a88e2c12-de27-4dba-89d6-36a69057b309.png

通过勾选或者取消勾选，可以在场景中出现活隐藏对应的元素。

## 1.3 运行监控
## 整体示意图如下图所示：
1653530206017-27810340-dc2a-47b5-bbc0-f3949e6b4c94.png

右击空白页面，可以实现场景的拉取上传，并且实现页面的放大/缩小、测距和场景设置等快捷操作。
1701063738420-883465e0-6eb2-4de0-a6ff-a42183b045a2.png

## 场景元素
## 运行监控显示的元素有：
## 站点
## 线路
## 互斥区
## 库位
## 机器人
## 门、电梯

## 场景中的坐标系原点，示意如下：
1653530217714-2eda7380-9e9c-4fab-8cd7-b133b1ef50d4.png

页面左上部的比例尺用来表示地图大小与真实物理地图大小的比例。地图展示的实始比是 40 时，即在界面中 100 像素代表 0.4m 。
1653530223197-5fa1d278-690a-4e11-a111-37a5e3fc339d.png

## 鼠标交互操作
## 可按照以下指引操作：
鼠标按住，可自由拖动地图移动。
鼠标滚轮滑动可在当前鼠标所在的位置上自由的放大放小。
鼠标点在场景元素中，可选中它， 再点击属性按钮，右侧将显示该元素的属性信息。
鼠标右键点在元素中， 可弹出对该元素的右键菜单，如机器人的接单、释放权的操作，库位的占用、解锁等操作。

## 库位查看
点击在【库位】上，可以查看当前库位的多层库位，并显示每层库位的空满或锁定状态。
如果当前库位是无货状态，则显示为蓝色。
如果当前库位是满货状态，则显示为暖黄色。
如果当前库位是锁定状态，则显示锁状的图标。
1653530242562-a0d2b384-6ac2-47d1-a542-4d3e38dee8ce.png 

1653530246200-c8711bed-ca70-42bb-b7d4-5c7300c4f853.png 

1653530249473-6560c88e-bfc2-4c34-9ed7-35d2dbaafa7b.png

## 多机器人运行
## 1）机器人车体：
1701064577050-89ffb71e-631a-49f8-8668-745c0d545c53.png

## 机器人显示说明：
蓝色的光源和白光晕折角表示机器人的车头，即机器人前进的方向。
矩形框则表示机器人的车体，车体的大小是按着地图缩放比同步缩小的。。

## 2）多台机器人的整体运行示意显示：
如果机器人的前进路线上出现了大量的虚线圆圈，则表示当前路线已被相同颜色的机器人占用。
如果当前线路、区域颜色与机器人的颜色一致，则表示当前的线路、区域等资源已被该机器人占用。

## 操作按钮
操作按钮位于运行监控右侧底部，如页面没有显示，则表示被属性栏遮挡。关闭属性栏即可查看。
## 示意图如下：
1701063925058-07b26789-ca1f-4fb0-a1aa-484323d6d70a.png

## 操作图标从左到右依次为：
测量：点击后可测量场景中的距离。
路况：待完善。
机器人：点击显示机器人的列表。
放大：每点击一次会在原来的基础上放大 20% 。
缩小：每点击一次会在原来的基础上缩放 20% 。
显示全部：会在当前场景的缩小或放大后完全展示在当前屏幕中。

## 1.4 底栏
底栏可以实时显示机器人的在线情况，以及机器人有无发生报警。当发生报警时，则底栏显示为红色。
1701063987828-d728feb1-bbc7-4b6b-8a4f-6686d7b5be43.png

## 左侧
## 底栏左侧依次为：
圆圈（绿色表示正常连接，灰色则表示与 Core 断连）。
## 机器人的在线数量
“/”前表示当前与 Core 连接正常的机器人数据。
“/”后表示当前场景中的机器人。
可以点击，查看详细的机器人列表。

## 点击机器人的列表,，如下图显示：
1653530285013-1797349b-9185-4ed9-9f7f-78241c4eb557.png

## 列表中显示的信息依次为：
圆圈（蓝色表示机器人与 Core 正常连接，灰色表示机器人与 Core 断开连接）。
## 机器人的名称
## 机器人的电量
如果大于 50% ，则显示为绿色。
如果大于 30% ，则显示为黄色。
如果小于 30% ，则显示为红色。
## 机器人的置信度
如果置信度大于 0.8 ，则显示为绿色。
如果置信度大于 0.3 ，则显示为黄色。
如果置信度大于 0 ，则显示为红色。

## 右侧
右侧主要是用来告警，实时显示机器人报警的错误信息。
如果不存在错误，则显示为灰色。
如存在错误，则显示为红色。

点击告警按钮，可显示当前的报警错误信息。
1701064031992-20e61353-9df3-493c-837f-509323334a8d.png

## 1）机器人告警类型：
## 严重
## 错误
## 警告
## 通知

## 警告内容信息依次为：
## 触发的时间
## 错误码
## 次数
## 警告内容

## 2）系统告警
用来显示RDS系统运行的错误警告提示。

3）上方蓝色信封的告警标志，用来提示 RDS 系统的报警，点击该信封可以打开或者收起消息提醒，点击打开后的消息提醒，即可跳转到消息管理页面。
## 1.5 其他
## 切换语言
1701064120519-788ce885-0f3f-47c9-a567-4fdb67c1c201.png

点 击页面右上角的【admin】→【语言】，实现中英文切换。

## 主题
1701064675788-a8a7e0f3-a5f9-4adf-a52d-c099988c2235.png

1701064704462-a5344f75-4373-4244-82e1-ecabec487bdb.png

点 击页面右上角的【admin】→【主题】，实现主题的切换。

## 修改密码
1657872884566-f4a8c254-b13c-4d3e-93e2-788d8e49fe7d.png

点击页面右上角的【admin】→【修改密码】，输入新密码以后点击保存，即可完成密码的修改。
## 切换到手持端
1701064836786-b0c2cb05-2c73-408a-8a21-5684dff2d91c.png

点击页面右上角的【admin】→【手持端】，可以直接进入网页版的手持端页面。
1701064865478-fba25e92-a755-48ab-9319-d94782454448.png

## 切换登录
1701064912066-34c5c7c4-230e-465a-8352-e028b9b4a794.png

点击页面右上角的【admin】→【退出】，可回到初始未登录页面，输入新的账号和密码后即可重新登录。
## 机器人
机器人界面由两部分组成：工具栏和机器人列表， 点开工具栏的展开键，可见所有的按钮。
1701064996930-49308c71-56c2-4801-9221-6706e6199c20.png

机器人列表展示机器人的相关信息，包含机器人名称、IP、组、标签、（接单）状态、执行中的运单、运单状态、电量、置信度、控制权情况、定位状态、导航状态、机器人所在的地图名称和基本操作 。
接单状态 ：【可接单】、【不接单占资源】和【不接单不占资源】表示了机器人在场景中的状态。当机器人是【可接单】状态时，方可接单执行任务。当机器人是另外2种状态时，则不能接单执行任务。其中，【不接单不占资源】时，则等于于在场景中消失，其他机器人可以正常行驶不受该机器人影响，即便是机器人在道路中，也可以忽视该机器人正常行驶。【不接单占资源】表示在场景中的某个位置存在，其他机器人不可直接忽视该机器人驶过。
控制权 ：分为【抢占控制权】和【释放控制权】。用户只有在获取了机器人的控制权以后才可以让机器人接单或者执行其他任务。也可以主动放弃控制权，即【释放控制权】。
其他状态 ：【继续】、【暂停】可以控制机器人的行进状态。【确认定位】一般用于机器人重新定位的时候。【清除错误】按钮可以清除该机器人发生错误后产生的错误信息。【软急停】表示软触发的车的急停，与机器人本身的【急停】按钮不同，【急停】按钮一般在机器人车体上，按下【急停】按钮后机器人则会立刻停下。当不需要对机器人执行软急停操作后，则点击【取消软急停】。
换机器人进度 ：在换机器人功能中使用，见 2.1 。
第三方机器人 ：第三方调度系统对于自家机器人是否在交通管制区域的状态更新有延迟，为了避免这种延迟导致交通管制区域存在多家厂商的车的情况，开发此功能，便于 现场人员准确更新第三方机器人在交通管制区域的存在/离开状态 ，更好地实现精准的交通管制。详情见 7.12 小节。
### 2.1 换机器人功能
当车辆故障需要其他车辆接替继续执行任务时，则可以采用换机器人功能。
当任务开始运行，机器人接单执行任务以后，在机器人页面中，正在执行任务的机器人的行末操作列会出现【换机器人】按钮。点击【换机器人】按钮，打开换机器人页面。
1701065135716-763a8cc9-bbe6-43b8-9565-c5f8288c5f6b.png

在换机器人页面中，包含原机器人的信息：机器人名称、机器人组、标签和运单ID，用户可以参考原机器人的信息，在下方的换机器人选择中，选择符合条件的机器人，默认自动选择车型，也可以根据需要切换对应的机器人和机器人组，修改标签，并注明换机器人原因。
1701065167647-d36f4b1a-e295-44b9-b7be-ed7808bb6409.png

## 在机器人换车场景中，存在2种情况：
未载货时的空机器人更换；
已经载货后的满料机器人更换。
## 1、未载货时的 空机器人更换
在换机器人页面正常选择了机器人和机器人组，填写了标签和换车原因后，在【是否有货】中选择【否】，点击保存，即完成空机器人更换。
1701065280959-99e3ec02-26fc-4c7f-9c9d-2bba00ef0bac.png

### 2、已经载货的 满料机器人更换
在换机器人页面正常选择了机器人和机器人组，填写了标签和换机器人原因后，在【是否有货】中选择【是】。
1668768150666-0ff26e04-9c93-4c13-89bc-468317d1d0fe.png

## 弹出【取货方式】的选项：
【人工搬运到新 AGV 】——在机器人已经取了货的情况下，将货物人工转移切换到"新机器人"；
【机器取货】——在机器人已经取了货的情况下，人工将货物放置在就近的库位上，由“新机器人”自行来装载货物，完成货物在两车间的切换。
### 1）满料机器人更换时的人工搬运到新 AGV
在用户对【取货方式】选择了【人工搬运到新 AGV】后，需要选择换 机器人 的起点，这里的起点可以填写库位或者站点，不建议在地图中有相同名字的库位和站点。
1701065410431-eab9b377-2b81-4d5a-895f-e8c47cdc2688.png

## 2） 满料机器人更换时的机器取货
在用户对【取货方式】选择了【机器取货】后，除了选择换车的起点外，还需要选择机器人的动作值，可供选择的内容为 binTask、顶升 JackLoad 、顶降 JackUnload 、叉车取货 ForkLoad 和叉车放货 ForkUnload 。
1701065505412-d3075860-17fa-46cc-84de-d08d0cc74d8d.png

### 3、查看换车进度
完成换机器人操作以后，此时在机器人页面，点击【换机器人进度】，即可看到对应机器人的更换情况。对于还在选车中的机器人，还可以点击【取消换机器人】按钮来撤销该换车操作。
1701065598427-eb6a8eb4-324a-4f65-beae-3e6872d22f56.png

如果是有货物的情况，当点击了换机器人按钮并且完成货物转移后，在“新机器人”后的操作中点击放行，“新机器人”将会继续执行原机器人的任务。
1701065667189-a669136c-6433-4288-909e-0fa7cd90d0ce.png

### 2.2 第三方机器人
见第十四章的 14.2。
## 库位
1701065808443-68e918eb-908c-43e3-ba10-65ab0d7041f2.png

1701065836767-d4ab936e-b44f-4681-ad74-473cac1567f8.png

页面包含对库位的基本操作按钮和库位相关的信息。
其中，库位包含物理库位和逻辑库位。物理库位从 Core 中定义，禁止在 RDS 中进行增加和删除操作。逻辑库位从 RDS 中定义，可进行增加和删除操作。两种库位均可以有锁定、解锁和占用等功能。在该页面导出库位时，注意只能导出逻辑库位，不能导出物理库位。
## 工具栏说明 ：
1）如图，用户可以选择上排的绿色按钮对库位的状态进行设定。可供选择的指令包括：
设置内容：可增加该库位的货物；
占用：设置该库位的状态为占用；
未占用：设置该库位的状态为未占用；
锁定：用于锁定库位，锁定后其他机器人则不可使用该库位；
解锁：用于解锁库位，解锁后其他机器人均可使用该库位；
设置库位名称：设置该库位的库位名称；
设置标签：补充该库位的标签信息；
设置编号：可补充该库位的编号；
添加：可添加单个新的库位及信息；
导入逻辑库位：可根据已有的格式，导入逻辑库位的信息；
导出逻辑库位：批量导出表格中逻辑库位的信息；
启用：启用库位，以便所有机器人均可用该库位；
禁用：禁用某库位后所有机器人均不可用该库位；
清除同步失败：清除 rds 与 Core 同步光电库位时失败的状态；
扩展属性：可以在扩展属性中，增加库位页面中的列，并且可以修改名称或删除； 
1701065917124-803b28ba-dfbd-4746-b54e-5e244e993f33.png

库位操作记录：记录用户在该账号下对库位的锁定及解锁记录。 
1701066006779-d19a0ce3-fc52-4d80-86d1-51f61cd691ff.png

鼠标点击在【库位】上，打开属性面板，可以查看当前库位的多层库位，并显示每层库位的空满或锁定状态。关于库位的不同状态，分为无货、空料车、满料车、锁定、未锁定、禁用、启用几种。
如果当前库位是无货状态，则显示为蓝色外框和内里。
如果当前库位是满货状态，则显示为暖黄色外框和内里。
如果当前库位是空料车状态，则显示为暖黄色外框+蓝色内里。
如果当前库位是锁定状态，则显示锁状的图标。未锁定则不会有符号显示。
如果当前库位是禁用状态，则显示禁用符号的图标。启用则不会有符号显示。以此类推
1701066267292-98a3486d-2468-47b3-a7b6-32c7b8214d08.png

2） 每一行的库位信息均可以进行单独编辑。逻辑库位比物理库位多一个删除键，允许删除。
## 任务管理
任务管理界面由三部分组成： 搜索栏、按钮栏和任务列表。
1701066349997-5db654ed-5b5c-4587-a603-448144930e49.png

## 搜索栏
1701066416856-44b5ba4b-dde7-46d4-b02a-b07f5741927f.png

用户可以通过对任务列表中的任务运行状态、机器人名称、任务名称、实例ID、外部运单号、时间、级别（父任务&子任务）、是否为定时任务等内容下拉选择来搜索。
对于任务状态，分为运行中、终止、暂停、结束、异常结束、重启异常和异常中断。其中：
运行中：当任务正在执行中，则会显示该状态。
终止：人为在界面上操作的终止。
暂停：一般是人为控制运行中的任务暂停，任务运行时，在操作栏会出现暂停按钮，方便用户暂停任务。点击暂停后，也可以点恢复来让任务继续执行。
结束：当任务完成后，则显示为结束。
异常结束：当运单被终止后但没有终止任务时，则显示异常结束。
重启异常：重启 RDS 后，任务没有继续执行，任务状态就会变为“重启异常”。如需要系统重启后，任务保持重启前的状态继续运行，需要在系统设置中开启任务恢复功能。
异常中断：客观原因如站点不存在等原因造成任务无法正常执行下去造成的异常中断。
如果该任务有外部订单号，则允许根据外部订单号进行查询。任务名称可以按任务进行查询，实例ID支持模糊查询。另外还支持按任务的创建时间查询任务。
对于任务级别，有子任务和父任务的区分。如果在一个天风任务 A 中引用了天风任务 B，则任务 A 为父任务，B 为子任务。定时任务在天风任务中开始创建的时候选择决定。
## 工具栏
1701066502731-25daa0cf-f6b0-469e-9fc9-de67eb088dc9.png

终止所有任务：勾选任务后点击终止目标未完成的任务。
导出任务实例：可以导出勾选的任务。
设置任务优先级：对于正在执行中的任务，可以对该任务设置优先级。优先级越高，越优先执行。
获取缓存数据：获取任务中的 key 和 value。
## 删除：勾选需要删除的任务后点击删除
终止所有任务：批量勾选，可以终止多条任务。
删除全部任务：可删除全部任务。
## 任务列表
任务列表记录了任务实例ID、状态、机器人、任务名称、外部运单号、任务状态描述、优先级、创建时间、执行时间、结束时间、耗时和运行时间描述。
## 任务管理界面的字段说明：
任务实例ID：随机生成，唯一的。
状态：任务的状态。
机器人：执行运输任务的机器人。
任务名称：该任务的天风任务的名称。
外部订单号：如果RDS 系统与其他系统对接，需要关联到其他系统的ID，则可以使用该外部订单号展示。
任务状态描述：用来标注某条任务中需要的信息，如任务的起点和终点。
优先级：任务的优先级。优先级高的任务优先完成。
创建时间：任务创建的时间，或者任务发布的时间，而不是机器人开始运行的时间，此时任务中可能有其他与机器人无关的动作。
执行时间：机器人开始执行的时间。
## 结束时间：任务结束的时间
耗时：任务的流逝时间。
运行描述：任务运行的反馈，如任务结束、手动终止和异常结束。
## 监控
此外，在任务列表的左侧有两个按钮。
终止：终止单个任务。
监控：查看当前任务进行情况（如下图）。
1701066612137-e6560b06-851e-47b8-8ad5-5d8f5804ac26.png

输入参数的加号可以点开展开所有输入参数。
## 监控界面从上到下，从左到右分别是：
任务基本信息：任务名称、任务实例 ID，创建时间、状态、输入参数。
块记录：任务及各个块的详情。点击切换按钮，可以将参数格式化展示。
块日志：每个块的运行日志，鼠标移入块日志，出现“转到”按钮，点击可以跳转到块记录的相应块。
1701066653149-8d00d665-b46b-454e-af8c-5fa1f2c781b2.png

1701066683213-7b62ec96-4fb1-4faa-b98b-29cc0062f236.png

1701066703238-9e7e932e-cb3d-48dd-bacc-05f448e06214.png

## 子任务
当运行了子任务后， 每行前面操作列会出现子任务的标识。母任务列出现“进入子任务”按钮，点击后，可以查看具体子任务的运行情况。也可以在搜索栏搜索子任务。
1701066735079-1af78990-c773-451a-8dff-02051f9d4a31.png

1701066757942-e90de56c-0230-4764-b451-674bac582944.png

## 运单管理
运单管理页面由三部分组成：搜索栏、按钮栏和运单列表。
在天风任务运行后，所有已经下发的任务可以在任务管理中查看，包括已经分配了机器人和未分配机器人的任务。其中，涉及到机器人的运单，将会出现在【运单管理】模块中。
1701066801769-9441dcaf-141a-49b1-a19e-d8ae6ce8c905.png

## 搜索栏
在运单管理页面，可以对运单的ID、外部运单号、AGV的名称、运单的状态、外部运单号、起始时间做查询，并且查询是否是自动运单，机器人是否接单。
关于自动运单，这类情况有：机器人回停靠点或者机器人去充电，属于自动运单。
关于运单状态，分为：已创建、待分配、正在执行、完成、失败、终止、无法执行。
待分配：运单下发下去以后，还没有分配机器人时，状态为待分配。
已创建：在待分配的基础上，机器人已经分配好，但是还没有开始执行，运单已经创建。
正在执行：正在执行中的运单。
完成：执行完成的运单。
失败：为临时状态，可以手动重试，某些情况下也会自动重试。
终止：人为手动终止的运单。
无法执行：一般是机器人无法到达时呈现的状态，例如机器人标签、组别和机器人名称等内容冲突。
等待：运单中所有动作块都已经被执行完成了，但是运单没有被封口，等待后续指令。
## 按钮栏
## 1、终止：可终止已勾选的运单。
### 2、终止并不接单：可选择对执行该运单的机器人终止，但该机器人不接单。
### 3、封口：点击封口即可通知 Core 对任务进行封口。
## 目前创建任务分两种情况：
如果发送任务时（setOrder）指定为不封口（complete == false）任务，则可在 任务块 执行过程中继续向该任务添加 任务块 。
如果发送任务时（setOrder）指定为封口（complete == true）任务，则即一次性将所有 任务块 发送给 Core ，任务执行过程中不可再添加 任务块 。
删除：勾选后删除对应任务。
删除全部：可直接删除全部运单。
## 运单列表
运单列表包含运单ID、机器人、机器人状态、是否封口、描述、组、标签、优先级、创建时间、接单时间、完成时间、外部运单号、执行耗时、运单分数、操作和错误详情。展示的是所有运行过或正在运行中的运单。
## 合单管理
1701066927033-a9278150-a05d-4877-9d4d-76d8cf88d7fd.png

合单管理页面包含工具栏、搜索栏和运单列表。合单管理主要是针对多起点和多终点的机器人，如料箱机器人。该页面将记录料箱机器人的运单明细，包括分配的机器人、运送状态、起点库位、终点库位及耗时等信息。
## 需求单（待完善）
在【设置】页面配置 demandTask ，并开启该功能，则可以在页面上显示需求单。
1701067032805-d33f5abf-e723-4a11-8e31-593cb8939cfa.png

1701067050065-3e3d4930-90c9-4f4a-9339-dc49d437e04d.png

配置完成后，可以看到需求单页面出现了 chooseSite 的选项，点击【名称】一列的 chooseSite ，进入到需求单的明细页面。
该页面包含搜索栏和内容明细。
1701067074042-6c641d91-10eb-4534-bf6a-b524deb4a775.png

内容明细当中显示了需求单上面的详细内容，这与手持端中需求单的内容相对应，如下图：
1701067097813-43e11cc7-cb1e-470b-b78a-edb3310159af.png

手持端仅显示名称、描述和创建时间，另外类别、创建人、处理人、处理时间、状态、操作，以及另外配置的扩展字段是后台网页端独有。用户可根据需要在网页端查看。
具体如何配置需求单，可查看《脚本实战教程》中的 4.10 创建需求单 。
## 事件管理
事件管理为用户在【事件配置】页面完成配置并运行后，查看事件运行情况的页面。在查看本页前，建议优先在【事件配置】页面学习如果进行事件配置。
## 接口管理
接口管理】为用户在【接口配置】页面完成配置并运行后，查看接口运行情况的页面。在查看本页前，建议优先在【接口配置】页面学习如果进行接口配置。
在完成接口配置并触发了上位系统运行以后，则会出现一条新的接口管理信息，如下图所示：
1701067142082-630acffd-c7cd-4784-a690-cf748e35e284.png 

显示的信息包括：接口请求ID、URL、接口名称、任务ID 、请求方式、状态、创建时间和结束时间。上方的工具栏供用户根据需要自行查询。
点击每行的行首的【监控】，显示通过接口运行后的任务运行情况：
1701067172954-a5df5dc4-19d0-4e14-bdea-409637f5397a.png

## Modbus 管理（待完善）
## 任务
1701067811331-d4e86ab1-8f33-4425-8eef-99011f0f1dcc.png

相较于【天风任务】模块的初始界面，【任务】模块教直观的展示了在天风任务中编辑的所有任务极其版本。点击对应的 任务块 ，即可运行该任务。
## 天风任务
## 创建首条天风任务
### 进入【天风任务】页面，其菜单栏包含6个按钮：
定义新任务。
手动“刷新”当前天风任务列表。
“删除”选中的天风任务。
导入任务。
导出任务。
视图切换：可以切换天风任务为文件夹的形式，方便分类。
其中，【定义新任务】和【导入】是创建天风任务的两种方式。
1701068622240-884a8672-ae63-45fa-8a4e-4d8cfa2f4c4d.png

## 普通天风任务
我们通过 【定义新任务】 的方式创建一个名称为“T5”的天风任务，在弹出的新建框中，有2种任务可以选择，一般情况下选择普通任务，定时任务一般用于发起固定周期的任务。输入名称以后点击确认，如图：
1671522593112-68ce7dbe-962e-45cf-bce6-9c7207af7d91.png

### 点击【确定】之后，生成一条新的天风任务，包含：
任务 ID：这是 RDS 系统为该任务类型生成的唯一 ID。
任务名称：可由字母、数字、下划线构成，请不要使用中文字符。在一个 RDS 系统中，任务名称不能重复。
版本号：每次编辑并保存任务时，系统会自动更新。
备注：可以在天风任务工具栏中的“任务设置”中填写该条任务的备注信息。
模板描述：默认出现用户自有模板即用户自己编辑的天风任务，当启用模板管理页面中的模板时，在天风任务页面会出现对应的模板中已存的天风任务供用户学习和使用，但不可编辑和修改。
定时任务：创建任务后用于识别该天风任是否属于定时任务。
启用状态：在定时任务的操作列，点击【启动】，则可以开启定时任务。看到启用的周期和延时。停止任务时点击【停止】即可。
操作：包含运行当前任务、启用/禁用定时任务、编辑普通天风任务任务、导出任务至磁盘文件。
点击 T5 任务右侧的【编辑】按钮，进入任务编辑界面。如图所示，除【工具栏】外，该界面从左到右分别是：【块列表】、【可用参数列表】和【块编辑】。
1701068702337-fb57cb56-78db-46b6-ba08-8bc05caf1213.png

天风任务，是一种低代码编辑业务流程的工具。这个低代码流程的基本单元，我们称之为“块”，天风任务是由“块”组合构成的。每个“块”都执行一段特定的程序逻辑。块有输入参数、输出参数；有些块也可包含子块（如“ if ”，“串行执行”，“并行执行”等），子块全部执行完成，父块才能执行完成并退出。
在块列表中，选择一个块，按住鼠标左键，拖动至编辑区。当目标位置出现一条绿色的水平线段时，松开鼠标左键，即可将块插在该位置。
1701068736823-b73ee8c2-332b-4646-ab9b-bb2ed1c9791a.png

## 定时任务
如需创建定时任务，则在创建天风任务时，选择【定时任务】选项，点击确定即可。
创建完天风任务后，点击定时任务行末尾的编辑，进入到定时任务的任务编辑页面。
与普通天风任务的编辑页面几乎一样，但在定时任务中，我们可以在工具栏的任务基本设置里，设置定时任务的周期和延时时间，默认毫秒。
设置完以后点击保存，按照需要正常编写需要定时执行的天风任务即可。
1701068813326-9268ab76-e362-4c0b-b0b6-3f1c22874e7a.png

编辑完以后点击天风任务页面的启用，在任务管理页面切换定时任务，即可查看刚刚运行的天风任务。
1701068840586-b079ff12-bc56-45b3-a894-91dd3cee19a3.png

## 工具栏
保存：保存当前页面的天风任务（并自动升级版本号）。
运行：运行一次当前的天风任务。将弹出对话框，提示输入任务参数。
撤销：撤销上一步编辑操作。
重做：恢复撤销的操作。
全选：勾选全部块。
全不选：取消全部块的选择。
任务基本设置：修改天风任务的名称，描述。
任务输入参数：设置天风任务的输入参数。
删除：删除已勾选的块。
源码：查看天风任务 JSON 格式源码。
备份：点击备份后，输入备份的天风任务的名称，返回天风任务主页即可看到备份好的任务。
复制：勾选想要复制的块并点击【复制】。
黏贴：勾选复制以后，在想要黏贴的天风任务编辑中点击【黏贴】会自动黏贴在任务的下面，允许同一个和不同任务的复制和粘贴。
## 块列表
块列表中目前有10个部分。分别为：子任务、脚本块、HTTP 请求块、任务块、流程块、基础块、工作站、仿真块、调度块和设备块。
在块列表中，除子任务块以外其他块均可以通过点击右侧黑色的疑问号，打开后查看示例和说明。所有块默认折叠，需要展开时可以点击收起按钮展开。也可以在上面的搜索框中直接搜索对应的块。
1657873225455-4f25825e-1f06-451f-b304-cd5c2539b9e1.png

## 子任务
该区域显示所有已创建的天风任务。子任务可以像其他块一样，被插入进另一个任务中。当执行子任务时，将在 RDS 中创建一个该任务。
1657873261110-49b39120-f7c7-4618-90a4-d49c0ab200a8.png

注意，需避免子任务间的相互调用，或者循环调用。如 A 任务中执行子任务 B；B 任务中又执行子任务 A。这将会引发系统崩溃。
## 脚本块
1657873271093-4eda5eeb-b8c7-4f93-879e-a08fa3c64a42.png

## 该区域包含两个块：
## 运行脚本：
1657873281290-57fc8940-87a5-4523-bfb1-69ac35ae4503.png 

脚本定义函数名为 test 的函数，块的“函数名”字段填 test ，参数为函数的入参：

1653529881802-e5fe7af3-647b-4ce9-ac69-669d79e527c3.png

### 脚本设置 task.variables ：
1657873289455-a66bc4bf-0195-4926-b06c-5c829cbb6daf.png

脚本设置 task . variables 块运行函数 test ，函数返回结果为 result:JSON . stringify ({field:12345}) ，在其他块用 task.variables.field 取值，其中返回值结构的 result 字段固定，变量 field 字段为自定义字段名。
1653529897963-c98010fa-a34d-4117-b0b8-26e265d82097.png

## HTTP 请求
1669261277570-e5d2de26-06b7-438c-973a-29ebe7f7351b.png

## 该区域包含两个块：
发送 GET 请求：用于发送 GET 请求， 在块编辑框中输入请求的 URL 地址即可。 
发送 POST 请求：用于发送 POST 请求， 在块编辑框中输入请求的 URL 地址和请求的参数类型。
## 任务块
1657873298623-c3030470-77d3-479a-bd71-3ddc7f5fa260.png

## 该区域包含七个块：
缓存数据：缓存 key 和 value ，即键和值。
获取缓存数据：获取缓存 key ，用于获取缓存块缓存的数据。
标记任务开始：标记任务状态为开始。RDS B 1.2.0 版本以后，已停用。
设置外部订单号：在表的外部订单号中设置一个值，该值会保存在表中以便后续使用。
设置任务变量：创建或编辑变量。变量统一由字典 task.variables 来管理，并且会持久化到数据库中。
设置任务状态：给任务添加状态码和描述。
触发任务事件：触发任务事件，将事件交给 JavaScript 脚本中的事件监听器来处理。
## 流程块
1701069069455-331ab833-4ade-42db-a989-7d511be151cd.png

## 该区域包含十三个块：
break：使用本块后会直接退出循环，一般用在while块或者遍历数组块内。
延迟：任务暂停指定的时间（毫秒）。
If （包含子块）：需要输入条件判断语句，当条件满足时，执行所有子块内容。
If-Else：当满足 if 条件时，进入if块；当满足 else 条件时，进入else 块。
If-Else_if-else：当满足 if 条件时，进入if块；满足else-if 条件时，进入else_if 块；当满足 else 条件时，进入else 块。
遍历数组（包含子块）：顺序遍历数组，并可将数组元素传递到子块中做处理。
并行执行（包含子块）：并发执行所有子块。
并发执行N次：并发执行子块 N 次。
重复执行N次（包含子块）：需要输入执行的次数 N ，执行 N 次该块内的所有子块。
return： 使用本块后会直接返回，后面的块将不再执行。
串行执行（包含子块）：顺序执行子块。
抛出异常：本块用于抛出异常，并可设置异常信息文本，抛出异常后，当前任务将变成“异常结束”状态，任务运行描述中则显示该异常提示文本。
while ：需要输入条件语句，当条件满足时，执行所有子块内容。
## 基础块
1701069163118-420437b0-592e-4a90-bab7-0f54be644054.png

## 该区域包含15个块：
校验任务实例 Id 是否存在：本块用于校验任务实例 Id 是否存在.
创建唯一 id ：用于在天风任务中给子任务指定ID，而不是随机生成。
当前时间戳：本块用于获取当前系统时间戳，格式例：1662537487533。
执行 sql：用于执行 SQL 语句。
查询 sql：用于查询 SQL 语句。
发简单邮件：发送邮件。
字符串 Md5 加密：将输入的字符串进行 Md5 加密 输出为加密后的 32 位字符串。
修改手持端按钮的背景：可以通过menuId定位修改手持端按钮的背景色(重启之后会失效，恢复到初始状态)。
修改手持端按钮是否禁用：可以通过menuId修改对应手持端按钮是否禁用。
修改手持端的按钮label：可以通过menuId定位修改手持端按钮的label(重启之后会失效，恢复到初始状态)。
通知手持端（工位/岗位）：给手持端发送对应岗位和工位的消息。
通知手持端的用户：用于通知手持端用户帐号任务运行状态。
打印：将指定的内容，输出到日志中。
当前时间：获取当前系统时间。
设置岗位/工位：用于设置用户的岗位和工位。
## 库位
1701069185369-6002479b-da2e-4f90-b308-6eebc8ee04e2.png

## 该区域包含十二个块：
批量设置库位：用于批量设置库位内容、占用状态，可同时设置多个库位或者多个库区的库位。如果库位Ids和库区集参数都有，表示同时设置满足这两个参数的库位。
获取密集库位：当在场景中有一排密集的从里到外的库位时，将库位的名称以库位号＋下划线+数字的方式命名，并且库位从外到里的数字大小为递增的方式，这样放货时会优先放进靠里（数字大）的库位，取货时相反。
获取库位：随机从众多工作站中获取一个未锁定的工作站。
光电库位校验：用于光电检测的库位延迟比较久的场景，机器人取完或者放完货物后，用此块来确认光电检测完成，并且调度系统已知。
查询库位：用于查询符合条件的库位。
## 设置库位扩展属性：设置库位的扩展属性
设置库位货物：设置工作站的具体货物。
设置库位为空：设置工作站的状态为空。
设置库位为占用：设置工作站的状态为已占用。
锁定库位：锁定该工作站。
设置库位标签：为指定库位设置标签字符串。
解锁库位：解锁该工作站。
## 仿真块
1701069210563-9eb537f6-a089-470d-aa8a-8eaceda44960.png

## 该区域包含两个块：
时间耗费模拟：可以让当前任务在运行到当前块的时候阻塞一段时间（毫秒），这个时间可在输入参数"毫秒"中配置。
随机生成库位：用于模拟仿真时按照配置的规则随机生成库位名称。
## 机器人调度块
1701069230018-0d6e2a0c-238a-4119-84d0-8e48e8ca8732.png

该区域显示和 Core 运单相关的块。
库区转运：叉车 APP 专用，用于库区转运。
机器人通用动作：令机器人前往某个库位/站点，并执行一个动作。
拼合单机器人：本块用于多层料箱机器人，在处理不同任务中取送物料，自动进行拼单、合单的块。默认为阻塞块。
选择执行机器人：向 Core 声明一个运单，并为此运单获取到机器人。可选参数有优先级，截止时间，机器人名称，标签，机器人组，候选机器人和关键路径。
分拨单：本块用于一次取货后，将货物分拨到多个目标点，完成分拨之后将托盘、料箱归还到指定点。支持中途"挂起"、"继续"子任务，没有可执行子任务时去指定的"等待点"等待。此块不需要借助选择机器人块，单独使用。
获取 bintask 返回值：获取 binTask 动作结束后的返回信息。
注意，通常情况下，机器人动作块，作为选择执行机器人的子块而存在。
## 设备块
1701069253548-7a8ea736-05bd-416b-ae36-306175538c4e.png

## 该区域包含二十三个块：
获取机器人PGV码：用于车体上有上视 PGV ，机器人每次动作之前扫码，扫码之后使用此块后，可以在任务中拿到扫码的信息。
读取 MELSEC 值：用于通过 MC 协议读取设备三菱 PLC 的值。注意，DS 三菱 PLC 通讯，采用 Qna 兼容 3E 帧协议实现（兼容SLMP的报文格式），需要先在 PLC 侧的以太网模块配置为二进制通讯 。
写入 MELSEC 值：用于通过 MC 协议写入设备三菱 PLC 的值。
通用读取 Modbus 值：通过配置目标 PLC 的 Host 和 Port 等参数，读取目标 PLC 的状态值。如果读取 PLC 的过程中出现异常（比如网络连接异常），该块将阻塞，直到成功读取 PLC 中的值。
通用读取 Modbus 值（Name）：通过配置 modbus 实例名称参数，读取目标 PLC 的状态值。如果读取 PLC 的过程中出现异常（比如网络连接异常），该块将阻塞，直到成功读取 PLC 中的值。
通用等待 Modbus 值：通过配置目标 PLC 的 Host 和 Port 等参数，查询该 PLC 指定的地址编码中的状态值，如果查询结果与期望的目标值相同，则该块完成结束，否则将一直轮询等待。如果查询 PLC 的过程中出现异常（比如网络连接异常），该块将阻塞，直到异常恢复。
通用等待 Modbus 值（Name）：通过配置目标 PLC 的实例名称，查询该 PLC 指定的地址编码中的状态值，如果查询结果与期望的目标值相同，则该块完成结束，否则将一直轮询等待。如果查询 PLC 的过程中出现异常（比如网络连接异常），该块将阻塞，直到异常恢复。
通用写入 Modbus值 ：通过配置 Host 和 Port 等参数，将期望的值写入目标 PLC。如果写入 PLC 的过程中出现异常（比如网络连接异常），该块将阻塞，直到成功将期望值写入 PLC 中。
通用写入Modbus值（Name）：通过配置 Modbus 实例名称，将期望的值写入目标 PLC。如果写入 PLC 的过程中出现异常（比如网络连接异常），该块将阻塞，直到成功将期望值写入 PLC 中。
Func03 批量读取保持寄存器的值：通过配置目标 PLC 的 IP 和端口等参数，读取目标 PLC 的一个保持寄存器的值。注意，该块只能用于读取功能码为 0x03 的目标 PLC 的状态值。如果读取 PLC 的过程中出现异常（比如网络连接异常），该块将阻塞，直到成功读取 PLC 中的值为止。
Func04 批量读取输入寄存器的值：通过配置目标 PLC 的 IP 和端口等参数，读取目标 PLC 的输入寄存器值。注意，该块只能用于读取功能码为 0x04 的目标 PLC 的状态值。如果读取 PLC 的过程中出现异常（比如网络连接异常），该块将阻塞，直到成功读取 PLC 中的值为止。
Func01 批量读取线圈量的值：通过配置目标 PLC 的 IP 和端口等参数，读取目标 PLC 的线圈状态值。注意，该块只能用于读取功能码为 0x01 的目标 PLC 的状态值。如果读取 PLC 的过程中出现异常（比如网络连接异常），该块将阻塞，直到成功读取 PLC 中的值。
Func02 批量读取离散输入的值：通过配置目标 PLC 的 IP 和端口等参数，读取目标 PLC 的离散输入值。注意，该块只能用于读取功能码为 0x02 的目标 PLC 的值。如果读取 PLC 的过程中出现异常（比如网络连接异常），该块将阻塞，直到成功读取 PLC 中的值。
Func0f 批量写入线圈量的值：通过配置目标 PLC 的 IP 和端口等参数，通过功能码 0x05，批量将线圈量状态值写入目标 PLC。如果写入 PLC 的过程中出现异常（比如网络连接异常），该块将阻塞，直到成功将输入值写入 PLC 中。
Func10 批量谢日保持寄存器的值：通过配置目标 PLC 的 IP 和端口等参数，通过功能码 0x06，批量写入目标 PLC。如果写入 PLC 的过程中出现异常（比如网络连接异常），该块将阻塞，直到成功期望的值写入到 PLC 中。
Func03 读取保持寄存器的值：通过配置目标 PLC 的 IP 和端口等参数，读取目标 PLC 的一个保持寄存器的值。注意，该块只能用于读取功能码为 0x03 的目标 PLC 的状态值。如果读取 PLC 的过程中出现异常（比如网络连接异常），该块将阻塞，直到成功读取 PLC 中的值。
Func04 读取输入寄存器的值：通过配置目标 PLC 的 IP 和端口等参数，读取目标 PLC 的输入寄存器值。注意，该块只能用于读取功能码为 0x04 的目标 PLC 的状态值。如果读取 PLC 的过程中出现异常（比如网络连接异常），该块将阻塞，直到成功读取 PLC 中的值。
Func01 读取线圈量的值：通过配置目标 PLC 的 IP 和端口等参数，读取目标 PLC 的输入寄存器值。注意，该块只能用于读取功能码为 0x04 的目标 PLC 的状态值。如果读取 PLC 的过程中出现异常（比如网络连接异常），该块将阻塞，直到成功读取 PLC 中的值。
Func02 读取线圈量的值：通过配置目标 PLC 的 IP 和端口等参数，读取目标 PLC 的离散输入值。注意，该块只能用于读取功能码为 0x02 的目标 PLC 的值。如果读取 PLC 的过程中出现异常（比如网络连接异常），该块将阻塞，直到成功读取 PLC 中的值。
Func05 写入线圈量的值：通过配置目标 PLC 的 IP 和端口等参数，通过功能码 0x05，将单个线圈量状态值写入目标 PLC。如果写入 PLC 的过程中出现异常（比如网络连接异常），该块将阻塞，直到成功将输入值写入 PLC 中。
Func06 写入寄存器的值：通过配置目标 PLC 的 IP 和端口等参数，通过功能码 0x06，将一个期望的寄存器值写入目标 PLC。如果写入 PLC 的过程中出现异常（比如网络连接异常），该块将阻塞，直到成功期望的值写入到 PLC 中。
等待线圈量的值：通过配置目标 PLC 的 IP 和端口等参数，查询该 PLC 指定的线圈量地址的值。如果查询结果与期望值相同，则结束当前块；否则将一直轮询，直到从 PLC 读取到期望的值。同时，如果读取 PLC 的过程中出现异常（比如网络连接异常），该块将阻塞，直到从 PLC 读取到期望的值。
等待寄存器的值：通过配置目标 PLC 的 IP 和端口等参数，查询该 PLC 的指定寄存器地址中的值。如果查询结果与期望值相同，则结束当前块，否则将一直轮询，直到从 PLC 读取到期望的值。同时，如果读取 PLC 的过程中出现异常（比如网络连接异常），该块将阻塞，直到从 PLC 读取到期望的值。
读取 opc 值：用于读取设备 opc 值。使用之前需在 app/application.yml 配置 opc 客户端连接地址 opcuaEndpointUrl。
写入 opc 值：用于读取设备 opc 值。使用之前需在 app/application.yml 配置 opc 客户端连接地址opcuaEndpointUrl。
等待DI值：读取机器人的 DI ，与读取DI值的区别是，等待块会等待到期待值才会继续运行。
读取 DI 值：用于读取机器的 DI 。
设置 DO 值：用于设置机器的 DO 。
等待放行：等待手持端放行。
## 补充说明：
关于 RDS 适配的通用协议有：HTTP 协议、ModbusTCP 协议、MC 协议、OPC-UA、Websocket 协议等等，需要注意，RDS 不适配总线协议！！！例如 ModbusRTU、ModbusASCII、RS485、RS232 等等。
## 可用参数列表
参数列表由四部分组成：固定的【常用参数】和【任务】参数（每个天风任务都存在），根据任务内容动态变化的 【任务输入参数】 和 【块输出及上下文参数】。
## 常用参数
1701069424277-b8b24af9-d914-4e28-b5e3-022cc4e77a64.png

常用参数集合了系统中频繁使用的菜单参数列表，方便用户直接选择参数填入块内容，集合的菜单包括：机器人ID、机器人组、机器人标签、库位Id、库区、站点、binTask、工位、岗位、用户、缓存。在右侧编辑块的时候，如选择机器人，可以直接点开常用参数，选择想要填入的机器人，即可填充进块内容中。
1701069444694-7bc54b6f-2e0f-491b-a578-bfb03a520c6c.png

## 任务参数
点击一个块的输入参数框，然后再点击参数列表中，某参数右上角的“ = ”号，即可将参数填入。
1701069461837-ea865994-05d0-4505-a0fa-9ec4a1cd9c93.png

## 任务输入参数
在上方的按钮中，点击任务输入参数，添加参数，中间的任务输入参数部分就会新增刚刚手动添加的输入参数，任务输入参数可以直接点击等号填充进块中，表示该块的该内容通过任务输入参数传入。
1701069489463-410cabfe-d05a-4636-b977-25ce92b5120d.png

## 块输出及上下文参数
该部分参数是由块的拖动产生的块输出参数，可用于块之间互相取用参数。
1701069511808-9e70e5f7-4e50-4db6-b9b9-68ab7dddd1c3.png

## 编辑任务
## 调度示例
大多数情况下，我们定制天风任务都是需要机器人执行运输任务的，因此以下示例将从【选择执行机器人】开始入手，创建一个两点运输任务。
## 设置输入参数
首先，设置输入参数。点击【工具栏】的"任务输入参数"，输入我们运输的起点和终点，点击完成。
1701069656809-a03cc864-58f1-46f9-8642-f0cef2279400.png

## 添加块
拖出一个【选择执行机器人】块，然后将【机器人通用动作】块拖动到前者的子块区域内。
1701069677514-1f6c784d-ae72-47c3-b10b-85065f154ac6.png

## 编辑块
注意此时，可用参数列表（如下图所示），会自动添加四个参数，输入参数 "起点" 和 "终点"，输出参数 "选出的机器人"和“料箱名”。
1701069695552-f3c3e924-bfca-4dcf-beb9-85fed9fb988d.png

料箱名：料箱车动作的时候，因为有个背篓，这个参数指返回这次动作是由哪个背篓执行的。正常情况下不使用。
块的参数输入框 ，仅有两种类型，分为“简单值”和“表达式”两种类型。简单值类型，将在系统解析时，通过块的参数类型，直接做推断。表达式类型，将被系统推断表达式的输出结果。可用参数列表中的参数除【常用参数】外，均是表达式类型。
1701069722065-ed2ce5c1-6439-43bf-829d-c22cc042e6c0.png

块参数 是在设计一个块时，就定义好的，支持多种类型，常见的有字符串，整型，浮点类型，布尔值，JSON 对象和数组等。
编辑“机器人通用动作”块，分别将"机器人ID"，"站点"，"动作"填入，机器人ID在【机器人】页面中可以选择。点击①【 机器人ID】，再点击 ②【绿色等号】，表达式类型参数将会自动填入 ③【参数输入框】 处。并编辑“选择执行机器人”块，填入关键路径（不填入指定机器人时，填入关键路径则可以让系统在任务中选择机器人时，选择距离“关键路径”较近的一辆 AGV） 。图中带红色*号的输入框为必填。指定机器人可以选填。如下图：
1701069742119-c2c10492-b668-4c5b-9dae-c54656835b92.png

若任务需要“机器人在到达起点和终点时，均原地等待2秒”，需要为参数输入固定值，可以将 延迟块 拖动至【机器人通用动作】之下，并通过简单值的方式手动输入，如下图：
1701069759380-fbf05911-64cf-4f4e-be0a-3c959f8b09b8.png

编辑完起点和终点后，点击左上角"保存"任务。
## 令机器人执行 binTask 动作
首先对机器人通用动作做简要介绍。
### 点击【机器人通用动作】拖到箭头所指方向，如图所示：
1701069782946-d7cd4b12-e635-404f-9935-b61e6b854f6f.png

【指令】参数提供一个下拉菜单，可以选择机器人的动作，所有任务指令参见：任务指令
1701069803994-25923277-bde1-4dca-a6a7-e6ffa399bf39.png

【无】指定机器人不做任何动作。
【binTask】指定机器人在库位上要做的动作。
【preBinTask】指定机器人在库位的前置点上要做的动作。
【顶升 JackLoad】将顶升顶起。支持顶升机器人的料架识别，机器人到达指定的目标站点会上升顶升机构（Roboshop 会显示载货中）。
【设置顶升高度 JackHieght】设置顶升车高度，不改变顶升状态
【顶降 JackUnload】将顶升降下。支持顶升机器人的识别动作，当机器人到达目标站点会放下顶升机构。
【等待 Wait】即移动机器人到达指定的目标站点，不做任何动作。
【叉车取货 ForkLoad】货叉升起。支持叉车的识别动作。
【降低叉齿 ForkUnload】货叉降下。支持叉车的识别动作。
【边走边升降叉齿 ForkHeight】设置货叉高度，不改变货叉状态
### 【自定义指令CustomCommand】
【ctuNoBlock.py】料箱机器人执行动作的脚本。
【syspy/setDO.py】控制多个DO的开关的脚本。
【syspy/waitDI.py】等待DI触发的脚本。
以上动作中，binTask 最为特殊。对 binTask 类型动作，除了动作名称外，所有的动作参数都无需指定，都可在 Core 层配置和处理。
我们以叉车取货和卸货为例。首先，找到在 Roboshop 中找到该料箱机器人，如下图中的【2000-1】：
1701069908162-afa1fb9d-127b-44c5-90b1-3f290b0a0696.png

鼠标左键双击该机器人选项卡，连接成功后，点击【启用编辑】，进入 smap 编辑界面。选择左侧工具栏中，倒数第二个图标，新建库位。我们在 AP32 点附近，建立一个库位 Loc-01。
1701069923754-954a3522-640e-47bc-bc57-16b716f4588b.png

随后选中该库位，会在右边自动弹出属性栏，在【站点】处，填入 AP32，表示机器人需要走到 AP32 来操作该库位。
1701069945697-1c8a34e1-9632-4ed9-b5f9-7b537d5cb250.png

在【动作轨迹】处，点击【编辑】，选择【添加】，在【键】处填入 “LOAD”（注意，“LOAD” 字符串是自定义的，用户可自行编写），值处填入下图所示的 JSON 字符串，点击【确定】。
1701069962885-cf4d8897-87df-4ec5-8b30-64672c987ab2.png

使用同样的操作方法，建立 AP5 附近的库位 Loc-02。并绑定操作 “UNLOAD”（动作轨迹的键值对，参见链接：任务指令）。
1701069984826-aa616dff-258b-4d82-b991-3ac84a1c7de9.png

编辑完毕后，选择【退出编辑】，并且推送场景地图。
再次进入 Core，点击【拉取场景】。
1701070019471-da9652cb-8c4c-47a5-8918-3afe712b0c82.png

打开 RDS，进入天风任务页面。拖出一个【选择执行机器人】块和两个【机器人通用动作】块，填入指定的机器人名称，脚本名选 binTask，目标站点为 Loc-01 的参数填入 LOAD，目标站点为 Loc-02 的参数填入 UNLOAD。保存后，点击左上方的运行，就可以在【运行监控】页面看到机器人的运行动作。
1701070054787-6756a638-f40f-4bde-9b5b-e1329b06b461.png

## 确认机器人状态
运行任务如果出错，可以到机器人页面查看任务对应的机器人是否为可接单状态。并可通过上排的按钮对当前机器人进行设置。
1701841299342-275932a3-f34d-40b0-8098-0a65b50d9090.png

机器人页面，包含机器人操作按钮和机器人信息列表。机器人列表中，列出了机器人的名称、IP地址、组别、标签、状态、执行中的运单、运单状态、电量、置信度、控制权、定位状态、导航状态和地图。其中：IO 表示机器人车体的数字输入/输出状态。
在勾选对应的机器人后，用户可以选择上方工具栏的按钮，对机器人的行为或状态进行设定。
选中一台机器人后，页面右侧将展示机器人的详细数据。包括：该机器人的模型号、设备ID、IP地址、备注、Robokit 版本号、地图名、固件版本号、累计行驶里程、今日累计行驶里程、累计运行时间、本次运行时间、是否被阻挡、实际速度、当前站点、地图、抱闸、电压、电池电流、重定位状态、急停、软急停、置信度、电量和（是否）充电。这其中：
Robokit 为机器人内置软件，机器人的一切功能，包括定位、导航、执行动作等，都由 Robokit 来处理。
机器人位置，注明了机器人的全局二维坐标和朝向角度。
机器人实际速度，展示了机器人在自身坐标系下的矢量速度。
1701841322016-ce9790a4-7003-4c22-847d-28848652e063.png

## 运行任务
## 任务发起的方式有三种：
在任务编辑界面，或者任务列表，或者任务按钮界面，通过按钮发起。
被插入其他任务，作为子任务运行。
在 JavaScript 脚本代码中，用后台提供的接口方法生成任务。
本文仅介绍第一种。
在任务编辑界面，保存了 5.3 中的任务以后，点击【运行】按钮，就可以运行天风任务。运行时填入输入参数【起点】和【终点】，系统将创建任务实例，运行任务逻辑。
1701841367488-6953a3a8-d705-4f4a-b042-454d424c1b8b.png

回到【天风任务】页面，任务列表中，点击对应任务操作中的【运行】按钮（如下图），也可以发起任务。
1701841388746-1d6f1b3d-9ffe-426e-80d0-89005a5353a0.png

## 切换视图
天风任务支持列表视图和分类视图。如图，点击“视图切换”按钮，可以从初始状态的列表视图切换为分类视图。再次点击可以回到初始的列表视图。
1701841418224-ff812d82-a7c1-4fd4-ae6e-14dc3161b298.png

分类视图下，会显示当前所有的天风任务，默认是没有分类的，为了便于天风任务的管理，可以点击“添加分类”按钮，为当前天风任务做一个分类管理。
1701841437469-b57d27a6-3d41-4b05-b4ad-f29d0c8ff39b.png

添加后，可以看到在列表最上方出现了一个“分类1”文件夹，点击文件夹右侧的减号，可以删除该分类文件夹。
1701841456321-0a840f6d-1aac-40bc-a4e5-7af367b54133.png

鼠标左键选中底下任意的天风任务，可以看到右侧会出现该任务的详情。
1701841475057-228ddd44-f03b-41a3-bf02-6e0c34a28d00.png

选中该任务拖拽至分类文件夹下方出现一个横线时（如下图），拖入文件夹中，即实现天风任务的分类管理，在天风任务数量巨大时，该分类管理便于用户快速找到需要的天风任务。
1701841490887-9fd31c44-8270-47e6-842e-fa89e4174a4b.png

分类视图支持打开并切换多个天风任务，如下图。
1701841509454-9e23d804-fe1b-496c-9bb9-9ec5fab7996b.png

可以点击左侧的展开按钮，将天风任务平铺整个页面。
1701841525004-32f7e9c5-7da1-4d01-8efc-88524b576e9c.png

## 事件配置
响应事件的含义是：当任务/动作达到一定条件，如任务终止/失败、动作完成/失败、库位数据改变等，可以通过事件配置，来自定义任务/动作达到条件以后想要触发的逻辑（即响应），如动作完成向其他上位系统上报信息。
事件配置功能目前提供以下13个响应事件：websocket发送消息事件、机器人新的严重错误告警事件、分拨单库位运行状态事件、监听tcp传输事件、机器人接单状态改变事件、机器人错误或异常信息改变事件、动作失败事件、动作完成事件、任务终止事件、库位数据改变事件、分拨单事件、任务失败事件、任务完成事件。该13个事件标识作为唯一id，不可重复，即在定义新事件时，如已定义了动作失败事件，将无法再新建第二个动作失败事件，每个事件只允许被定义一次，但每个事件中的逻辑可以自由编写。
根据响应事件对应的使用场景，每个响应事件都被预设了固定的输入参数，在编写事件逻辑时，可以通过获取天风任务中相应代码块的信息，作为事件配置的依据，从而将事件配置和天风任务运行关联起来。
响应事件提升了任务编写效率，如机器人动作完成后需要触发动作的上报，那么可以在事件配置中编写好不同动作完成后触发的不同逻辑，而不需要在天风任务的每个动作块之后拖入相应的响应块。
## 具体配置过程可以查看：
## 响应事件配置教程
## 接口配置
进入【接口配置】页面，点击页面上的【添加】按钮添加一个新的接口：
1701067848901-514941a2-9c86-40b5-90dc-762434d59eee.png

在弹出的【添加接口】框中输入对应的接口名称和 URL ，需要注意的是， URL 必须以" /handle/register/ "开头，选择 POST 或 GET 为对应的请求方式，并根据需要选择手持端接口/公共接口类型。
举例说明：通过请求设置的接口下发一个天风任务，天风任务中设置库位内容（从接口参数中接收），首先新建一个名为 InterfaceTask 的天风任务并按照图中编辑：先添加两个参数，然后拖拽设置库位货物块到块编辑区，将任务输入参数中的两个参数：targetSiteId 和 content， 分别用“=”填入 库位Id 和 货物 中 ,保存。
1701067891953-90cdc3d8-6fb0-476d-8c6d-573f3b8b23c6.png

## 非 PDA 任务
回到接口配置页面，添加接口，填入对应的内容，选择公共接口类型，点击保存：
1701067974000-49209946-8727-4508-aebb-9ba5267ad44f.png

## 保存后出现了一条新的配置内容：
1701067996382-282dc30d-0faf-46ce-9b94-08d91340b2bb.png

点击行末的【编辑】，进入到接口的任务编辑页面，点击上方工具栏的【接口输入参数】，新增两个参数，targetSiteId 和 content，在天风任务块集合中，拖入刚刚创建好的 InterfaceTask 任务，将任务输入参数填充进去，再拖动一个接口响应块，填入响应内容和响应码。
1701068032992-210ad281-49c1-4a57-9e07-a9039bfdabb0.png

1701068049016-0c64ed7f-f6d3-4a3e-8e3e-7650a392692f.png

### {   "message": "任务接收成功。" }
## 并按业务需要完成任务编辑：

1675316054538-b14f8c02-a3b3-4d21-b859-867572d3b860.png

## 接下来使用 postman测试接口：
1701068123879-80427d38-2f4b-405e-882e-1544fc20e405.png

## 此时完成了库位的占用和货物设置：
1701068153786-5c0ffb25-8837-4b8e-a96d-59464a1c0a1f.png

## PDA 任务
### 添加一个新的手持端类型的接口，按以下内容输入，保存：
1701068189905-e8ad5737-2d1f-40a4-88ee-9dc26b20256e.png

点击接口配置的编辑按钮，进行接口逻辑的编写，设置接口输入参数，拖入以下块，点击保存：
1701068253660-c3280510-8ef1-4e2e-b1aa-3d3210dd1973.png

1701068264074-cda92060-0155-42b8-8bce-a92ab4854504.png

接下来需要配置手持端按钮，来模拟手持端通过接口配置的自定义接口进行任务下发的过程。配置手持端按钮有两种方式，1.配置文件的方式；2.组态配置，即图形配置，图形化的方式配置手持端。
假如通过配置文件的方式，设置界面参数配置填入以下内容，入口为 RDS 界面找到【设置-参数配置】，配置如下：
1701068282579-85aeb56d-2a53-4030-a053-279d9947ff7c.png

假如通过图形配置的方式，那么直接点进设置界面，就是图形配置的方式。点击任务右侧的加号，填入以下内容，点击确定：
1701068300478-082178d0-47d9-46dc-93ab-43b7cb3795e6.png

可以看到仿真手持端上多了一个按钮，我们双击该按钮，将两个下拉菜单组件拖入该按钮的详情页中：
1701068325372-66a0f3e2-3d1d-42c2-bbcf-2a117dfe5941.png

### 点击这两个下拉菜单，分别按照下图配置组件的属性：
1701068341126-c53712d8-adcf-4ad5-9cbd-241c22c9692d.png

1701068353636-3eb64e65-cb07-4fdb-8cf7-58e1907a9701.png

1701068371611-350091a7-1649-495c-bcf6-e09fdf2ccd3d.png

1701068385056-f16f9151-2477-46fc-8067-22ec25a1c7f3.png

除了配置下拉菜单的一些内容以外，我们还需要配置下单的路由，即下单按钮通过我们在接口配置页的接口来发起任务。所以我们将路由填写为接口url中的后缀 interfaceTaskPDA（因为手持端的开启自定义接口已经默认了前缀是/handle/register/了），下单后的确认提示文本填入：确认下单吗？打开“开启自定义接口”的开关，即代表通过自定义接口来发起任务。所有的编辑完，点击界面右上角的保存按钮。
1701068412319-0d85097c-9e50-40f6-a6c3-c00ce806c947.png

1701068430199-1c5e5c4c-1984-43fe-b9ba-157380e773b4.png

### 此时可以通过 PDA 来测试接口，点击按钮发起任务：
1701068444351-01622258-76b9-4007-90db-0f0c7f179703.png

## 任务库位设置已完成：
1701068457828-08b690b4-2a5f-4c9e-b257-2433b8958407.png

## 在线脚本
在【在线脚本】页面中，点击工具栏的新增，点击新增按钮，增加一个 ” boot.js “ 文件。
1701070590869-c1827a0b-b1cd-460c-8b7a-5e0d91a089e6.png

在页面中输入脚本代码，鼠标右键可以对脚本进行一些操作。
1701070704929-b4027096-0a44-442a-bf39-ea0282fd103d.png

点击【保存】并启动。
1701070608208-8e9f73a0-2b68-4006-aaec-6821f1f85bd2.png

具体操作可以参考【脚本实战教程】和【脚本方法】文件。可在页面左侧下拉，找到【脚本方法】和【脚本实战教程】点击后，在页面中显示。
1701070634613-27047f48-ea07-4ae1-9586-e0787eee439b.png

1701070653048-a61c3d3c-d727-44ff-a263-c16b68c2a5c4.png

## 交通管制区域
第三方调度系统对于自家机器人是否在交通管制区域的状态更新有延迟，为了避免这种延迟导致交通管制区域存在多家厂商的车的情况，开发此功能，便于 现场人员准确更新第三方机器人在交通管制区域的存在 / 离开状态 ，更好地实现精准的交通管制。
## Roboshop中添加高级组
进入roboshop中的场景，启动编辑，点击高级组，点击加号按钮，增加高级组。
1683191369334-ed8aa0b3-17a1-42bc-8087-4584e0a8ba29.png

1683191420527-9495d0c2-9a3c-43d9-9a49-4a7459d39ae6.png

1683191428913-fda0c058-35c4-40d3-9138-d8ab190b7a3e.png

选中想要添加互斥区的LM点、AP点和路线，然后鼠标放到互斥组的名称上，右键选择“添加选中元素到高级组”。
1683191458381-492d4b51-83d9-4afb-b822-bdf5c4ee7c7d.png

点击组名，在右侧属性区域选择 mutex （一般是默认）。
1690252259348-736dfa95-3f0f-4ac5-9b2d-2bc1ed136143.png

添加以后，保存，推出编辑，推送场景。RDS的运行监控会出现相应的互斥区，颜色与高级组的颜色一致。
1683191466806-04c4acdb-19a4-48d9-9b76-cfad9d06da17.png

## 第三方机器人
选择机器人页面，点击“第三方机器人”按钮。
1683191475518-e25e5a31-9419-4c95-ac1b-68416a1a02ed.png

新增第三方机器人，填写机器人ID。
1683191484208-1f0981a2-1b4c-420e-afcc-d148cd312752.png

1683191492964-29f0afd7-8f2e-4bfc-aec6-cae2b0e68382.png

1683191500919-b051351f-ad66-4af7-838f-b456b4b28891.png

可以添加多个第三方机器人，双击机器人ID可以修改ID信息，支持删除机器人。
1683191512616-8aabdb46-fe18-4411-a16f-b6e298f3963b.png

## 交通管制区域
切换到交通管制区域页面，在现场的第三方机器人，如果进入了互斥区，操作员可以在此界面手动让机器人进入互斥区，这个操作跟接口调用申请互斥区的资源是一样的作用。点击“机器人进入”按钮。
1683191521514-dfcc3caa-71dd-4632-98be-1df2f459e7d1.png

选择刚刚添加的第三方机器人，点击确定。
1683191530269-68f3ee20-f866-4060-938b-79ef3566b378.png

确定C1占用互斥区。
1683191538415-0a278152-2d29-498b-bceb-a5510dde95b1.png

这时候我们假如有天风任务的机器人用到了该占用区的站点，那么由于该互斥区被第三方机器人占用，我们的机器人就会在互斥区外等待。（该天风任务要到互斥区内的LM10点执行任务，运行它）
1683191546217-30267c98-e40c-4667-ab62-3a2dfc856329.png

机器人被堵在互斥区外。
1683191553981-37ca543d-228b-4658-aecb-2cbbb8c20447.png

系统提示sim_01被在互斥区内的C1堵塞。
1683191564433-bfb8aee3-8577-449b-9a24-579655bcc233.png

现场的第三方机器人离开互斥区以后，用户可以回到交通管制区域，点击机器人离开按钮，就可以将C1离开互斥区，释放资源。
1683191573455-511ba4e2-a854-4055-985b-55d87581eb72.png

1683191581759-7a410f30-3961-4c75-aa17-f94bcdd9bd23.png

1683191591950-4162470b-79e3-447b-a1f9-f2d328e59123.png

离开以后，sim_01可以正常进入互斥区。
1683191600007-3caa5a14-93dc-40b7-8c0e-58bd41b0fede.png

列表显示此时互斥区的状态是使用中，并且使用的机器人是sim_01。该列表可以显示互斥区的状态已经被谁占用。
1683191611389-c4a65673-44f5-45ee-b8cc-b64fb8d63716.png

## 设置
设置界面呈现功能配置，分为几部分：岗位工位、任务、系统配置、需求单、数据单、数据卡片。点击参数配置按钮可以切换到参数配置页面。
1701070840428-f3de4dcb-56ed-4729-ae7e-b91e3d7ecb43.png

## 功能配置
功能配置用组态的方式来让手持端配置变得更加简单直观。
## 岗位 工位
点击岗位工位，在中间编辑区填入岗位工位的id和名称就能配置成功。
1701070860008-37102a21-ab0a-493a-9c87-8f1fcdf6b120.png

## 任务
任务配置即手持端的menu配置，可以通过编辑按钮的属性来配置menu项的字段。
1701070878355-b0ffe27c-2551-4d6f-9ff4-267eb3f357e9.png

可以点击详情将按钮需要的组件拖入中间工作区，点击组件可以在右侧查看其属性，根据项目需求填写属性值。
## 组件介绍如下：
## 单行输入组件属性
1680844280440-2ee12fd5-4032-48ff-8e6f-aa3eb1b6c964.png

## 多行输入组件属性
1680844286136-6e4dc4e0-1448-42d0-bb99-09ddcb58df7e.png

## 下拉菜单组件属性
1680844291901-7aefdb9c-31b3-4a0a-acbe-c58e594f17b4.png

## 下拉选项可以设置二级联动
1680844298437-56d13b5f-4902-4e04-bc6f-ac3073b9105b.png

## 多选下拉菜单组件属性
1680844304117-7ba02731-c128-42e9-924c-8cc624349c2c.png

## 库位下拉菜单组件属性
1680844335972-6ca179fd-acf0-4a53-908d-da94b2325194.png

1680844320951-99c5f9bc-1180-4e33-a386-eb12b9424d6d.png

可以对下单按钮进行自定义接口、路由、弹窗提示等的配置。
1680844366109-b5f850d3-16f9-432e-aeef-6bce2ef07fe3.png

编辑完成点击保存，然后点击预览按钮可以看到预览效果。
1680844381675-90c3042b-dfb1-4aa1-af07-21ab7693b934.png

### 预览效果如下，关闭预览后打开手持端可以看到配置的内容生效：
1680844392855-6da261ad-06f8-4bba-8572-793658dcd0f1.png

1680844397943-9d14ee04-4751-4480-9d5b-a538ae0e59d4.png

1680844404230-0396110a-c934-41e5-9c07-7e2d867e026a.png

## 系统配置
修改后需重启 RDS。包含 RdsCore 配置、Https 配置、邮件配置、MQTT 配置、OPC 配置、其他配置、单点登录配置。
## RdsCore 配置
1701071168947-952949ac-2bba-4cd8-9c8a-93da27c87bc3.png

## Https 配置
支持keyStore和crt两种文件格式。keyStore类型支持 JKS 和 PKCS12。
1701071180043-0844c5ad-a280-4f7d-924b-5e9932811806.png

## 邮件配置
1701071191605-94500c0c-93b9-4d96-a35d-5f90e298c16f.png

## MQTT 配置
1701071203733-2546b560-1a95-4292-a0f4-2cb5fcd6c366.png

1701071212385-7bfc0095-2ba0-4946-9675-2df19a4ce481.png

## OPC 配置
1701071226234-4977f3b1-246d-4fe3-90f0-afc40a457654.png

## 其他配置
1701071239756-5878a5fa-8e8c-4077-8437-6cdc3dc205f8.png

1701071263846-97bebb8f-614d-4c38-b190-0463f17176ba.png

## 单点登录配置
1701071277906-5bfdbe7e-dd68-416c-97b7-51bd328c0cc0.png

## 需求单（待完善）
## 数据单（待完善）
## 数据卡片（待完善）
## 参数配置
以yml文件的格式配置手持端。
1680844410876-aad0ad1d-7c60-4ac4-b3cb-280a79d0dbcc.png

## 系统资源
1701071449639-7e3ef70a-d975-406b-8135-836b0e8567bc.png

## 1、导入文件时，需以 zip 格式的压缩包导入文件，并将需要导入的文件放在压缩文件的第一层；
### 2、也可以选择在导出文件后，再将导出文件夹里的文件替换成新的文件;
3、天风任务导入时需确保后照名为 .ask，在线脚本导入时需确保文件名为 boot，配置文件导入时需确保文件名为 appilcation-biz.yml，接口文件导入时需确保文件后照名为 .api;
### 4、天风任务和在线脚本导入后需要刷新，配置文件和 application.yml 导入后则需要重启 RDS；
### 5、清除运单数据功能仅用于清除测试数据，正式生产后请勿乱用!!! 数据制除后不可恢复；
### 6、制除数据前，请确保任务管理,运单管理,没有任何正在运行的数据。
## 回放监控
回放监控页面的功能主要是”情景再现“式展示之前发生的错误情况，方便工程师快速的分析和定位问题。
如页面所示，页面有四个按钮，默认显示在【本地回放】，后面依次为【导入回放】、【启动】和【导出】。下面为当前时间，最底下左侧为【时间选择】按钮，往右为时间进度条。
1701071623080-8d50a081-a274-40c7-9a4b-574aecc54eb4.png

【本地回放】的功能在于，可以查看本机的运行监控的回放，通过【时间选择】确定需要查看的时间后，点击启动按钮即可查看。
对于需要导出的片段，可以点击【导出】按钮，选择导出的时间区间，建议选择同一天的时间区间，支持选择到小时。点击确定后导出。
当工程师收到现场导出的回放以后，点击【导入回放】切换页面，此时点击【导入】按钮，导入对应的文件。
移动到需要看的时间，点击启动，即可看到回放内容。也可以【暂停】。在该页面中，如果想查看其它回放内容，可以继续点击【导入】，导入的新文件将覆盖原来的文件。
1701071656576-2f2845cd-9d91-4c19-a2b1-9a5c9431bbd2.png

## 服务监控
1673254861403-3c275e25-6cdc-41c3-82aa-a932f616a8bb.png

对于安装了 RDS 的计算机或服务器，其信息包括 CPU 、内存、服务器信息、Java 虚拟机信息和盘符路径，都将会呈现在服务监控页面。
## 系统日志
1701071770106-b47a69ce-b02e-4365-8cc0-e4f62f992da2.png

系统日志页面由两部分组成：页面将记录用户在该账号下的所有操作。展示内容包括：创建时间、级别、操作、消息、消息中文和操作人。级别包含4种：TRACE、DEBUG、INFO 和 ERROR。
### 在该系统中的操作均会记录在系统日志中，如：
1）在 RDS 界面进行操作，如对库位进行操作；
2）与其他系统进行的交互；
3）与设备的交互，如通过 Modbus Tcp 与设备通信、电梯和打印机等。
## 消息管理
1701071790968-45d9a28e-200e-46ed-a03c-d310c680f1fa.png

该消息管理页面与底栏的告警略有不同，底栏的机器人告警和系统告警，是与 core 联通，如 core 的权限未激活、 PP 点 / CP 点未绑定等消息提醒，而此处的消息管理则是提醒用户 RDS  页面本身的报错，如机器人故障。
## 消息弹窗需满足以下条件：
任务缓存到内存，且不是终态；
消息是未读状态；
勾选对应弹窗等级。
## 模板管理
该页面中预存了3个较为经典的模板，分别是：脉动产线模板、拼合单模板和密集库位模板。另有一个用户当前正在使用的模板，称之为用户自有模板。通过右侧的【启用】按钮，可以切换到不同的模板，运行对应的模板后可在【运行监控】页面查看运行情况。
模板中预存了天风任务、脚本文件和配置文件，并且3个模板的天风任务均会在用户使用自有模板时展现在天风任务界面，方便用户参考借鉴，但不可修改。
用户可以在此界面对业务模板（后文统称为模板）进行操作，包括但不限于：
启用模板，并进行相关的业务操作，例如下单。
查看当前模板的脚本文件、配置文件、天风任务。
用户可对所需业务相似的模板（ userTemplate 除外）进行修改，以达到期望的业务需求。（ 模板是“只读”的，用户无法直接修改模板的任何文件。 ）
1701073167910-faead975-8f92-4c1f-85ae-22760125d23c.png

## ① 模板的提示信息
会以滚动文本的形式显示 已启用 的模板的名称。
## ② 模板管理菜单按钮
点击此按钮之后，会在右侧区域中显示模板管理界面。
## ③ 模板名称
模板的名称，都是用英文描述的，不受国际化的影响。

## 模板名称

## 模板描述

## 备注

## userTemplate

## 用户自有模板

为了便于管理，将用户自己编辑的脚本文件、配置文件、以及场景文件，都归并到用户自有模板（ userTemplate ）中进行管理。 严格来说， userTemplate 不能算是模板 。

### Pulsating production line

## 脉动产线模板

描述了基础的脉动产线的业务逻辑。

## Assemble order

## 拼合单模板

描述了基础的拼合单的业务逻辑。

## Dense peak bit

## 密集库位模板

描述了基础的从密集库位取货放货的逻辑。
## ④ 模板描述
模板的描述，会受国际化的影响。
## ⑤ 状态
描述了当前模板的启用状态。

## 描述

## 备注

## 未启用

表示 RDS 还未启用当前模板。

## 启用完成

表示 RDS 正在使用当前模板，并且会在 ① 中显示当前模板的名称。
## ⑥ 操作
当前模板支持的操作。

## 操作描述

## 按钮名称

## 备注

## 启用模板

## 启用

启用未启用的模板，只有处于“未启用”状态的模板，才会显示此按钮。 启用模板之后，RDS 会加载当前模板的脚本文件、配置文件、以及场景文件，但是不会修改用户编辑过的上述文件。 启用成功之后，可直接使用当前模板，详见相关的操作说明。

## 查看脚本文件

## 脚本

新建一个浏览器的标签页，并显示当前模板的脚本文件的内容。

## 查看配置文件

## 配置文件

新建一个浏览器的标签页，并显示当前模板的配置信息（即 application.yml 中的内容）。
## 注意事项
不能在生产环境切换模板。
用户只能启用模板，并使用模板自带的功能，却无法编辑模板。
## 可视化管理
可视化管理页面的作用是，可以在 RDS 中内置某个网页。在未开启的情况下，系统的菜单栏看不到可视化管理的菜单。需要打开，以仙工官网（ https://cn.seer-group.com/ ）为例，
点击【设置】页面的【系统配置】按钮，找到 其他配置，在可视化页面功能配置栏输入网页的名称和地址，翻到页面底部，点击保存，如图所示：
1701073280877-30dd3da5-6138-411d-b860-6305f54d09f2.png

修改后，重启RDS，即可看到 RDS 的可视化管理中内置的仙工官网页面：
1701073308979-40748ee9-6ae6-4840-bd67-1bb9cf919cf1.png

## 用户
主页面展示现有的用户名、角色、是否被禁用和创建时间。可通过页面上方的工具栏创建新用户，或点击每行末端操作列的编辑对已有的用户进行管理。
1701073356692-a620816e-f9de-4988-af46-8ff881aa9d0a.png

如图所示，点击左上角的【添加】按钮，输入登录的用户名、密码，并分配角色（用户在【角色】页面设置后，可从中选择），点击【保存】完成新增。点击【禁用】或【启用】，能实现对用户权限的管理。
1701073446706-d8b6c9ae-ea15-4fb3-b32a-530c142efde2.png

点击每行末尾【编辑】，可以对该用户的角色进行更换。
1701073466097-856a8708-345f-4c43-8692-fd2027e4155a.png

## 角色
【用户】页面和【角色】页面类似，主页面展示现有的角色、权限、岗位、工位和创建时间。
1701073536069-83f94610-3e5c-49e7-8817-de8027116802.png

点击页面上方的 添加 ，新增角色，根据需求配置角色的权限、岗位、工位（非必填）。角色的权限分为RDS Web和手持端，选择不同选项可以看到不同页面。
1701073551247-05fac3ff-e74d-4b04-9036-2facbde2eb0d.png

有的项目涉及到不同角色需要操作不同机器人、库区、天风任务，也会根据角色来分配一些按钮权限。这就涉及到了数据权限和操作权限。要实现此业务需求，需在 设置 界面的 其他配置 中，开启“是否开启数据权限和按钮级别权限”（修改后需重启RDS）。
1701073569060-6b475ba1-5613-4b77-ad6b-e59e268ec066.png

开启后，权限页面出现了一个新的分类，数据权限。rds web和手持端的内容也有变化，未开启数据权限和按钮级别权限时，我们选择的是整个页面（包含内容显示和按钮操作）的权限。开启数据权限和按钮级别权限时，我们可以按需选择每个页面上的分配的按钮权限。
1701073586269-41b82131-73d7-44dd-915e-2f69be555a42.png

如下图，运行监控的菜单中，第一个表示能看到此页面，其后的选项表示不同的按钮权限。假如只勾选运行监控，不勾选监控页面库位操作权限、机器人操作权限、场景操作权限，那么我们只能看到运行监控该页面，而不能在运行监控对库位、机器人、场景做任何操作。其他页面同理。
1701073616739-1b7d8872-1bfe-4193-a215-1f398d84e7cb.png

数据权限中，我们目前只针对库区、天风任务、机器人做了分类。
1701073635159-e7467431-10bd-4858-a396-cc4670fe6317.png

库区首先根据区域来分类，其次再显示区域中的库区，如图，linde和new是我库位列表页的区域，3是属于linde区域的库区，1和2是属于new区域的库区。选择了哪个库区，就表示只能对该库区进行操作。
1701073651989-f9096a02-29f5-44a4-944f-bf0c2daeb695.png

天风任务根据天风任务名称分类、机器人根据机器人id分类。
1701073682574-cabc0596-1cab-4eb9-bcd5-a4bb37d0c704.png

以某个需求示例：新建一个角色，包含运行监控页面（无任何操作权限）、机器人（仅可设置sim_01机器人接单）、天风任务（仅可对天风任务进行导入导出）。那我们应该勾选以下按钮：
rds web中：运行监控-运行监控、机器人-机器人&可接单、天风任务-天风任务&导入&导出
数据权限中：机器人数据-sim_01。勾选完毕，保存。在用户中为一个用户分配刚刚建立好的角色，保存。
1701073706899-5093f0ae-6949-4e9c-a769-9bf2af21cc01.png

退出登录，登录用户名2，那么看到的界面只包含了三个页面，运行监控（无法进行任何操作）、机器人（只能设置sim_01可接单）、天风任务（仅支持导入导出功能），界面如下。
1701073726601-053026e0-7930-46d2-8b0b-16e1eb0d8a75.png

1701073735518-a3388f32-5d73-4a37-925c-f9cb61083c33.png

1701073746086-e746b06b-dc5e-464b-acd6-02070f164137.png

## 统计（待完善）
## 机器人跟踪统计
目前统计内容分为四个部分：图形部分的2个部分为机器人跟踪统计和任务跟踪统计，图表部分的2个内容为机器人运行记录和运单详情。
机器人跟踪统计中，以图形的方式展现了机器人的情况，其中默认展示的有机器人的状态、空闲情况、执行情况、电量情况、接单情况、运行路程和故障情况等内容。

1675315590768-e6f2c93d-6423-4f95-b348-ce40e6998e9b.png

同时，还可以点击页面右上角的【自定义】——【添加卡片】，在弹出的添加卡片选择框中，选择其他卡片，如机器人执行时间趋势、机器人空闲时间趋势等内容，对于已经存在在页面中的图表，右侧会显示【已添加】字样，方便区分。

1675315603700-d8e1546f-e9f4-4456-9a50-5c3ef04af037.png

添加完毕后点击保存即可。

值得注意的是，其中标题含【趋势】字样的图表，统计内容为一段时间内的趋势演变，默认为全部机器人总和的趋势演变，如需切换个别机器人，可以点击单个图表右上角的 “..." ，选择【设置】，切换需要查看的机器人后保存。关于执行效率，计算方式为：执行效率=执行时间/工作时间，系统默认执行时间为8小时。如需更改，也可以点击图表右上角的 “..." 调整工作时间。

如果需要清除此前添加的图表，点击【重置】即可。趋势类的图表每 15 分钟更新一次数据，其余图表每 10 分钟更新一次。

1675315613975-69b10d62-5b89-40e2-acaa-e1997ebcd9e0.png

## 任务跟踪统计
任务跟踪统计以图形的方式展现了系统中任务的情况，其中默认展示的有任务的创建情况、异常情况、完成情况和滞留任务等内容。
1675315628411-57758f15-3ffa-4d7c-a305-7929f935fc90.png

同样点击页面右上角的【自定义】——【添加卡片】，在弹出的添加卡片选择框中，可选择其他卡片自行添加。已经存在在页面中的图表会显示【已添加】字样，方便区分。
1675315638988-9cc7fd66-18ab-46fc-bbeb-512b7eef2fa0.png

## 机器人运行记录
机器人运行记录的图表完整的记录了所有机器人在所有时间的状态变化。
1675315648612-ee5f5d2d-4e21-46b1-9a1d-24f182eb9e42.png

例如，当对机器人和时间做出筛选以后，点击查询后可以完整的看到机器人在当天的 0-24小时的状态变化情况，其中涉及到运输任务的即状态为运行的，可以看到此次运行的终点。
1675315658553-a42c9e74-28df-42ef-aeb6-50c22d4a8f6d.png

## 运单详情
机器人运行记录页面以机器人为维度，与之不同的是，运单详情页面以运单为维度，直观的展示所有的运单情况和货物的终点情况。
1675315672032-5dbad040-81d4-4b67-8a43-a1f97abf3786.png

## 故障记录
1673254842089-b85362b7-6f36-4bd0-a3d3-a56cc1d84530.png

故障记录页面记录了机器人在过去一个月内发生的故障情况。这些故障信息包括: 故障编号、机器人名称、故障等级、故障开始时间、故障结束时间、故障持续时间和故障说明。
故障编号是机器人发生故障时分配的代号，可以在【仙工智能帮助中心】的【机器码报警说明】中查看其对应的解释说明。故障等级分为"warning"、"error"和"fatal"三种，严重程度依次递增。在搜索栏中可以对机器人、故障等级和时间分别搜索，如需要也可以导出该故障记录。
## 归档
## 系统配置文件
1701073995456-2d732980-a5e0-4b44-9cfd-26537dd30300.png

如果用户修改了系统的配置文件，那么在重启 RDS 后，可以在系统配置文件页面中看到修改的信息。点击行末的【配置文件】可以快速查看已修改的配置文件内容，或者点击【切换】来切换到对应的版本。
## 脚本文件
1701073984596-f797d3e3-1062-4542-bdcd-79ca8fa357e4.png

## 手持端配置文件
1701074007233-f25f98d2-56d7-4f72-b2ab-1a659b62b96c.png

## 协议管理（待完善）
## 设备
## 充电机
在充电机页面显示了充电机的信息，包括名称、IP、端口号、是否在线、状态、电压、电流、充电情况，或可点击每行末尾的【详情】来查看充电机的更多信息。
1673254928094-ed885125-5912-4f0e-b8c1-fc8d0dcd51ff.png

更多需要可以通过 查询充电机信息 和 添加充电机信息 的接口文档来获取。
## 呼叫器
注意：呼叫器需要让厂家加上 断电保持按钮和灯信号值 的功能。
## 呼叫器创建任务实例
点击“添加”按钮，输入以下信息，添加呼叫器（目前仅支持ModbusTCP的协议类型和艾智威品牌的呼叫器）。勾选底部记住本次编辑，可以保留本次编辑。
1678857618494-4af04da6-49ba-4ef8-9d19-29c156444828.png

点击按钮右侧的“添加”按钮，可以编辑按钮的地址、备注、灯地址、按下灯亮绑定的天风任务和取消后触发的天风任务（如给上位机上报已取消任务）等信息。如果不小心添加错按钮，可以点击右上角的叉号删除按钮。
1678857630762-e28b2c2d-8dff-405d-a03e-93aa8f079a13.png

添加完以后保存，会看到呼叫器页面多了一列，点击右侧的编辑，可以对该呼叫器的信息进行二次编辑。
1678857643834-2792f6d3-249b-4412-b206-d8ed935bb628.png

点击呼叫器的IP蓝色字体，可以进入呼叫器详情页面，看到呼叫器的具体信息。
1678857652135-32333255-33e0-45ee-8e63-95e494cc2af6.png

这里列表显示的行数与该呼叫器的按钮数有关，当添加呼叫器时添加了几个按钮，就会出现几行，即每一行对应该呼叫器的一个按钮。
1678857659977-5f0bf06a-f8ec-4b79-9ae1-4ece829a050c.png

如下图，我添加了两个按钮，显示两行也可以点击该页面的“添加”按钮继续添加按钮。
1678857668639-0229ac4a-809a-4d64-8070-427649068919.png

## 上图中，圈出来的部分进行以下说明：
值（按钮）的问号：鼠标悬浮上去，会显示值的含义，0：关，1：开；
值（灯）的问号：鼠标悬浮上去，会显示值的含义，0：灯灭，1：长亮，2：快闪，3：慢闪；
开关：人工对呼叫器的按钮进行操作后，界面上的开关会显示相应状态，如人工按下后，界面上的按钮值和灯值都会呈现开启状态，鼠标悬浮到开关上会显示当前该信号的具体值；
编辑：可以对当前呼叫器的当前按钮的属性进行编辑修改，如下图。
1678857682660-aef83712-2448-4cd5-941f-ee5fcae62ae2.png
