# 机器人状态统计

## 机器人状态统计
### 适用 rds-F1.9.5-B1.7.20 及以上
查询指定时间段内机器人的状态统计信息。源数据：Core 获取所有机器人信息
统计周期：level为Hour，每十分钟更新一次数据；level为Day，Month，Year，每十五分钟更新一次数据。
## 请求
## 方法： POST
### 接口说明： /api/stat/agvStatus
POST "http://127.0.0.1:8080/api/stat/agvStatus"
## 请求 body 参数

## Name

## Type

## Description

## Required

## start

## string

统计的起始时间，支持 4种 格式的时间参数。 yyyy-MM-dd HH , yyyy-MM-dd , yyyy-MM , yyyy ，分别对应时报，日报，月报和年报，和参数 level 相关。

## 是

## end

## string

统计的结束时间，支持 4种 格式的时间参数。 yyyy-MM-dd HH , yyyy-MM-dd , yyyy-MM , yyyy ，分别对应时报，日报，月报和年报，和参数 level 相关。

## 是

## level

## string

统计等级，支持 4种 参数， Hour ,
Day , Month , Year 。

## 是

## types

## string

统计的类型，见 状态统计类型 ，需要统计多个类型时用逗号','隔开。

## 是

## vehicle

## string

指定目标车辆进行统计。不填则统计所有车辆。

## 否

## timeUnit

## string

统计的类型为时间时有效，支持 3种 格式， sec ， min ， hour ，默认返回结果的时间单位为毫秒。

## 否
## 请求示例
查询 AGV-01 在 "1970-01-01 12" ~ "1970-01-01 14" 之间每个 小时 的 空闲 时间
## 时间区间： [start, end)
## 正确示例
## {
    "start": "1970-01-01 12",
    "end": "1970-01-01 14",
    "level": "Hour",
    "types": "VehicleIdleTime",
    "vehicle": "AGV-01",
## "timeUnit": ""
## }
## 错误示例
## {
    "start": "1970-01-01 12",
    "end": "1970-01-01 14",
    "types": "VehicleIdleTime",
    "vehicle": "AGV-01",
## "timeUnit": ""
## }
## 响应
排除接口错误或网络异常等原因，响应的 HTTP 状态码为 200。响应体中有不同业务码，成功为 200，失败业务码可参考 业务错误码列表 。
## 响应 body 参数

## Name

## Type

## Description

## code

## number

## 业务码(非 HTTP 状态码)

## msg

## string

## 业务成功/失败信息

## data

## object

## 请求的业务数据
## 响应示例
## 成功示例
## {
  "code": 200,
  "msg": "Success",
## "data": [
## {
      "level": "Hour",
      "time": "1970-01-01 12",
      "type": "VehicleIdleTime",
      "value": 0,
## "id": "AGV-01"
    },
## {
      "level": "Hour",
      "time": "1970-01-01 13",
      "type": "VehicleIdleTime",
      "value": 0,
## "id": "AGV-01"
## }
## ]
## }
返回的数据 data 中，参数 value 表示累计时间。时间单位是请求参数中指定的单位，默认毫秒。以 time 字段为起始时间，以最近的 下一个同等级时间为结束时间 。
## 失败示例
## {
  "code": 9035,
  "msg": "字段 level 缺失或不支持的名称",
  "data": "Missing `level` field"
## }

## 状态统计类型

## Type

## Description

## VehicleIdleTime

AGV 的空闲时间。空闲不一定 AGV 停止不动，当执行返回停靠点/充电点的运单时，也属于空闲状态。

### VehicleExecutingTime

AGV 执行业务的时间。执行业务时并不表示一定在行进中，当执行业务时，访问被其他 AGV 占用的互斥区，造成的行进停止或其他业务交互是也属于 AGV 执行时间。

## VehicleChargingTime

AGV 充电时间，AGV 处于充电状态的时间。

### VehicleUnavailableTime

AGV 不可用时间。当 AGV 处于不可接单的状态或者 AGV 的控制权不在调度管控下的时间，该状态优先级高于以上其他状态。

## VehicleErrorTime

AGV 故障时间。当 AGV 遇到异常情况处于报警状态的时间，该状态优先级高于以上其他状态。

## VehicleOfflineTime

AGV 离线时间。此处的 AGV 离线并不是指关机，而是指调度连接不上 AGV 的所有情况，优先级最高。
不同于机器人故障统计中统计的时间，本文中的VehicleErrorTime统计的是AlarmsErrorsTime和AlarmsFatalsTime这两种需要人工处理异常的时间的总和。如需要知道机器人处于Warning（警告），Error（错误），Fatal（严重）状态的时间和发生次数，请看机器人故障统计
