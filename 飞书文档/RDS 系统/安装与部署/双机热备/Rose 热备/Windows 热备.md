# Windows 热备

## Windows 热备
## RoseMirrorHA7.0安装：
Rose 是支持双机热备的第三方软件， 安装配置以及后期维护具体细节可以查看文档： RoseMirrorHA7.0 安装配置维护(Windows&Linux)-2020-v1.4
下文均为 RDS 热备的基于 Rose 的配置方法。

## 一 安装环境准备：
### 活动主机、备用主机（两台服务器都需要是双网口）两条心跳线
1653990110952-9768747b-728f-4e6c-87bb-12b3bb3062fa.png

## 操作系统配置要求：如下图
1653990111990-87652501-caea-476a-adf7-493acfaa0eff.png

## 二 应用安装：RDS
## 应用以RDS为例：
主备机安装的应用软件版本需要完全一致。
主备机应用软件需要安装在完全相同的路径下，配置方式、参数、密码等要完全一致
### 将应用开机自启动设置为手工方式（由Rose控制启停）

## 三 RoseMirrorHA安装配置：
## 安装RoseMirrorHA：
### 主备服务器均需要安装RoseMirrorHA（无顺序要求）
安装向导中，可根据实际需求进行路径和模块调整，如无特殊需求，默认全部选择“Next”即可。
1653990112587-e7014709-e2ea-4c06-bc6a-5be9ee88318a.png

## 打开RoseMirrorHA控制中心：
### 双击服务器桌面上的“访问RoseMirrorHA”
### 通过浏览器访问： http://服务器IP:9999
## 默认密码：webadmin
## 支持的浏览器，如下图：
1653990113804-9d8800d6-16a0-4766-8133-867e54540f35.png

开始创建方案：初次创建方案，界面上会显示“开始创建方案”，点击进去配置向导。
1653990118133-8eceefb0-291f-43de-8e06-9f0526142336.png

## 方案向导：点击“下一步”，进入配置向导
## 选择活动服务器：
在指定新服务器处，输入主机服务器的IP地址，然后点击“下一步”
## 在登录界面，输入Rose的内置账户密码
1653990118564-32cd6d54-68b3-4fab-984a-ab0ca579d02a.png

选择备用服务器：同“选择活动服务器”配置一样，需要吧IP改为备用服务器IP
## 设置注册码：
### 复制主备服务器的主机ID好，给供货商，申请临时或者永久授权
## 点击“注册码”，导入授权文件
1653990119232-fe620f5b-1c75-4042-8434-3f586e09ba95.png

## 配置链路：
## 点击“添加链路”
1653990119684-712b3a25-5671-49ef-b2af-4e21f4df475f.png

### 选择用于心跳和数据镜像的IP链路地址，建议添加两组链路地址
1653990120437-0a5fe945-e4b3-4d59-9354-255eaa72a19f.png

## 完成配置心跳和数据链路
1653990120955-28db341f-2373-42d9-b657-7893868a14c1.png

## 应用类型：选择UserDefine
1653990121507-846bff78-bbc0-4c56-bdc6-348d95244ea5.png

## 绑定数据：
## 选择“修改”进入绑定数据集选择
1653990122071-70af651c-7e6d-435c-ad5e-3d3513c8b0c2.png

选择需要进行实时复制的文件或者文件夹：下图是RDS需要选择的数据
选择完成点击“确定”后自动勾选数据集，RDS绑定的数据集【如下图】
1653990122537-27cdccd7-e0e7-4e04-8fb8-e446002dc2a0.png

## IP资源：
## 点击“添加”，进入配置界面
1653990123080-471349d3-ae37-4645-b497-304b2182fc3f.png

## 在“网卡”处，勾选挂载活动IP网卡
在资源处，输入活动IP地址和掩码（例如主机IP为192.168.6.12，备机IP为192.168.6.13，则活动IP自定义为局域网内未被占用的IP如：192.168.6.xxx）
## 如果需要可以添加多个IP资源
1653990123643-13777860-37af-4583-a366-21e05bd07b6e.png

## NT服务资源：
### 根据实际需要通过“添加”按钮加入NT资源
1653990124173-8d2a6b4e-be4e-44f4-9c3a-668140696855.png

配置MySQL资源【如下图】。（依赖资源 选择先前定义好的的IP资源）
1653990124618-69f4c03e-8a18-4102-a61a-4eff84942b73.png

## 进程资源：
## 配置需要监控的.exe程序
1653990125484-2e5f04ab-ca7a-4d8d-969e-ba2551bc48a6.png

点击“添加”，进入配置界面。
在点击“添加”-->“浏览”,选择需要监控的.exe程序（我们RDS需要监控RobodPor.exe【如下图】）
1653990126533-04e96edb-b1e0-43c2-a443-52a9a76b7fd5.png

其余的资源监控都为可选项，我们RDS不需要对其进行配置。
最后到“配置详细信息”页面可以对照查看绑定的数据，然后点击“完成”完成方案配置。

## 四 功能按钮使用说明：
## 1、主菜单栏：
1671177749920-7d3c8806-2540-4aed-8d85-a43aba984a26.png

## 添加方案：进入本地配置向导
### 注销：退出Web登录，进入Web登录界面
## 语言：中英文切换按钮
## 恢复：创建恢复任务
## 在线日志：查看在线日志
菜单：授权管理（服务器授权入口）、主机管理（增加修改主机）、修改密码（修改登录密码）、帮助（Rose帮助文档）、关于入口（查看rose版本信息）
### 2、应用服务操作栏：
1671177787168-bc03a13b-1d10-47b3-815e-b361ee1b14fa.png

带入：主机会启动活动IP、启动业务系统、数据开始同步（备机应用会自动停止）
### 带出：主机会停止业务系统、停止数据同步，停止活动IP
## 切换：资源组从主机切换到备机运行
## 离线：Rose会停止该资源组的监控
修改/查看：常规（应用服务的名称、类型）、数据（能够修改绑定需要传输的数据）、策略（配置应用服务切换的策略）
更多操作：选择数据源（当两台服务器数据不一致时，选择数据源的同步方向）、交换主机位置（主从机调换显示位置）、删除资源组、强制启动
## 五 常见问题及操作说明：
## 1、问题1：因主从服务器IP改变，导致网卡异常，rose无法正常使用；
（1）：选择对应主机-->更多-->更新网卡信息（两台服务器均需要进行次操作）
1671177946028-2e723410-abcf-488c-b6d9-1fec0d4cfe0e.png

（2）：选择对应主机-->操作（链路配置）-->点击修改按钮
1671178326214-20371be0-a77a-4249-b613-ac95ba60c602.png

（3）：点击IP地址下拉选框，点击改变后的IP，最后点击确定
1671178479087-9815f7b6-cd89-4214-b51e-d4b3c116b1ac.png

### （4）：选择应用服务-->操作（链路配置）-->点击修改
1671178633492-dbdeb774-b856-49cf-93ce-5dd51e487b7c.png

（5）：点击IP地址下拉选框，点击改变后的IP，最后点击确定
1671178751657-4239c0b1-0dd8-4e9d-b68e-f88003b63c17.png

### 2、操作1：修改活动IP；
（1）：先带出-->选择应用服务-->选择IP资源-->点击操作按钮-->点击属性；
1671179189181-a23cee22-773e-4bde-b911-e3ecc52f7f1f.png

（2）：修改IP地址、IP掩码，最后点击确定；

1671179339524-5c9bdf4d-3080-4762-826f-42bbf955103d.png
