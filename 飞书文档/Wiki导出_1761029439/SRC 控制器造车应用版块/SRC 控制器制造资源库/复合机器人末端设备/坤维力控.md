# 坤维力控

## 坤维力控

## 版本

## 更新日期

## 更新说明

## 文档状态

## 维护责任人

## V1.0

### 2024.3.25

## 语雀迁移至飞书

## 使用中

## 一、说明
不同型号的力控具体参数可能存在差异，在使用力控之前务必仔细查阅力控厂商提供的使用说明
## 1. RBK 版本
### 3.4.0.4+

### 2. 型号
## KWR94 系列
### 3. 通信方式
## RS485
## 波特率：460800

### 4. 支持平台及连接方式
## SRC800
## 使用 RS485 连接
### 通过 USB 转换器（USB 转 RS485）
## SRC2000
### 通过 USB 转换器（USB 转 RS485）

### 5. USB转换器型号
1663667917321-c99dde0a-d108-4563-919b-562d15d0b547.png 

1663667936382-c4c3bdd1-fdc8-4d29-b3df-4459ff1374c7.png

### 6. 线序
### 不同型号力控可能存在差异，以实际线序说明为准

### 7. 供电
## 9~24VDC

### 8. 设备手册

KWR94系列六轴力传感器用户手册V21.6.94.11.4LB-28字节(485)(1).pdf

## 六轴力传感器KWR94供货图.pdf

### 二、设备参数配置
## 1. 说明
力控默认以 1KHz 频率自动上报数据，需要把力控从自动上报数据模式变成问答式上报数据模式，只有未设置过的力控需要进行该项设置，如果打开串口助手发送力控没有数据上报，在保证力控接线正确（电源线和通信线）并且力控正常工作（力控指示灯闪烁）的情况下，调过步骤 2 ，直接进入步骤 3 验证阶段。
### 2. 初始化力控
使用 USB 转 485 正确连接设备 485 后，USB 端插在调试电脑上，打开串口助手SSCOM，找到自动识别到的串口，打开串口，串口助手设置如下图，正确打开串口后会看到力控自动上报数据报文；
发送初始化报文： 51 00 0D 0A ，发送报文成功后看到力控停止自动上报数据报文表示设置成功。
1657590185019-48499e7f-a015-47d7-bba8-e96488ee178a.png

### 3. 验证配置
### 使用串口助手发送查询报文 49 AA 0D 0A

1657590911841-7a11caae-6469-4f4c-99d7-8ac42e667952.png

发送查询报文后可看到力控回包，回复报文帧头是 49 AA ，帧尾是 0D 0A ，如果帧头或帧尾不对，联系力控供应商；回复报文的完整格式如下：

1657590955330-342af69d-0934-465e-bfcf-8e9b1d858bdd.png

### 4. 重启设备
## 设备参数配置完成后重上电生效

### 三、模型文件配置
## 1. brand
### KunWei-ForceSensor-485

### 2. RS485 直连
## 模型参数目录：type-devName
## /dev/ttyUart x
## 具体Uart几按照 串口说明 填写配置

例如： 通信线接 pin1 和 pin2，devName 填 dev/ttyUart0

### 3. 通过 USB 转换器
### 该配置方法 SRC800 和 SRC2000 通用
### SRC 只保留与设备相连的 USB 转换器，其余全部拔掉
使用 MobaXterm_Personal 远程进 SRC， MobaXterm_Personal 使用方法 
输入指令：ls /dev （ls 与 /dev 之间 有空格 ）
观察返回数据是否有 ttyUSBx 字样，把 ttyUSBx 填到模型文件 devName 中
有新 USB 设备时，重复步骤 1~4，新增 USB 设备时，无需拔掉第一个已经识别到的 USB 设备，否则 USB 名称会重新分配

如下图，识别出来的 USB 设备名为 ttyUSB0，devName 填写 dev/ttyUSB0

1657512204502-c11e2e61-f8c1-4d9c-9094-f7864360fe3f.png

### 四、FAQ
### USB 转换器只能使用小盒子，不能使用大蓝盒子
力控厂商提供USB转换器型号，如果 USB 转换器使用错误，会出现数据截断的情况，帧头和帧尾会出现错乱（USB 转换器型号待补充...）
## 力控无数据
## 力控坏了，现象：力控指示灯不亮
USB 转换器型号用错，现象：使用串口助手观察到出现数据截断，帧头不是 49 AA
USB 转换器在控制器识别的名字错了（USB0 或 USB1）
