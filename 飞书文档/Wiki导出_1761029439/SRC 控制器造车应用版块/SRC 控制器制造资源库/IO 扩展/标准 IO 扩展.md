# 标准 IO 扩展

## 标准 IO 扩展

## 版本

## 更新日期

## 更新说明

## 文档状态

## 维护责任人

## V1.0

### 2024.4.29

## 文档从语雀迁移至飞书

## 使用中

## 通讯协议
## Modbus TCP 功能码使用如下：
## /*
### * modbus_read_bits 读线圈 fc=1
* modbus_read_input_bits 读输入线圈 fc=2
* modbus_write_bit 写一位数据（强置单线圈） fc=5
## */
### 读DO是modbus_read_bits
### 写DO是modbus_write_bit
### 读DI是modbus_read_input_bits

## 一、使用场景
对于主控扩展 I/O 数量有更多要求的客户可以使用支持 Modbus TCP 协议，通过网络链接进行 I/O 扩展。
### 二、Roboshop配置
1653655341611-e6c4c633-a36b-4d3e-887a-587a4cdaf015.bmp

## 在参数配置中勾选显示更多
### 参数 ModbusIP 配置为扩展设备相应 IP
### 参数 ModbusDINum 配置为扩展设备 DI 数量
### 参数 ModbusDONum 配置为扩展设备 DO 数量
参数 ModbusDIOffset 配置为扩展设备 DI 地址偏置
参数 ModbusDOOffset 配置为扩展设备 DO 地址偏置
参数 UseModbusIO 配置为 true 则启用扩展设备
### 三、机器人模型配置
### 3.1 扩展DI设置
## 1.上述roboshop参数配置完成后，在模型文件中找到DI设备类型。如下图，右单击设备即可添加新的DI设备。（ 可添加需要使用的DI，不使用不需要添加。 ）
1653654605816-2f7e977c-2d9c-4ccb-85f2-07c060779f69.png

### 2.单击DI设备，在右侧的属性窗口中，更改id。Modbus id的范围如下图提示，即在roboshop参数中设置的扩展DI数量 按照17-80序号进行排序。

1653654605811-ecbad4e5-dd71-441c-960c-e224c91c7173.png

### 3.inverse属性为DI的高低电平反转设置。
### 4.功能配置可见 DISensor 设备及 Trigger 设备。
### 3.2 扩展DO设置
## 1.上述roboshop参数配置完成后，在模型文件中找到DO设备类型。如下图，右单击设备即可添加新的DO设备。（ 可添加需要使用的DO，不使用不需要添加。 ）
1653654605810-7fcec1f5-84ae-41f7-838a-ff2fca035abe.png

### 2.单击DO设备，在右侧的属性窗口中，更改id。Modbus id的范围如下图提示，即在roboshop参数中设置的扩展DO数量 按照8-71序号进行排序。
1653654605823-3e6d7878-d83f-4fb0-8bf3-0d7cbb8185b8.png

### 3.default属性为DO的在 控制器上电时的首次状态 。
### 4.功能配置可见 IndicatorLight 设备。
### 四、设备配置
配置扩展设备 IP 至 192.168.192.XX 网段，一般使用192.168.192.66
标准的 Modbus TCP 协议的端口是 502；
### 五、应用案例——使用 PLC 作为 Modbus TCP 的扩展 I/O
### 5.1 原理概述
### 5.1.1 为什么使用 PLC 进行 Modbus TCP 的 I/O 扩展？
首先选用支持 Modbus TCP 的 PLC 进行扩展； 其次因为 PLC 在执行机构的稳定性和网络延迟方面具有不可忽略的作用 ；PLC 在 I/O 上扩展上具有可插拔的特性，可以随时进行扩展。
### 5.1.2 PLC 的选择要求
首先 PLC 需要支持 Modbus TCP 通讯，且 I/O 点在 Modbus TCP 的地址上必须是连续的；其次 PLC 的以太网可以进行 IP 地址和端口修改，而不是只能使用出场的默认地址+端口号；对于长时间开合的 DO 信号尽量选择晶体管输出类型；尽量选用对 PNP/NPN 输入传感信号都支持的型号。
### 5.2 推荐 PLC 选型
### 5.2.1 台达系列 DVP26SE11T/DVP12SE11R
概述： DVP26SE11T 是是一款小型网络型 PLC,12DO/14DI，支持 Modbus TCP/RTU 通讯以及串口通讯协议，产品截面数据图如下：

1653654606654-a728b3a1-f013-40ff-8c22-0c304002cf78.png

对于体积要求过高的客户可以考虑使用。
## 配置说明：
1.IP 设置，该款 PLC 出厂的时候已经配置好了网络 IP，所以对于 IP 和网端有要求的客户需要使用台达官方提供的设置软件（DCISoft）修改静态 IP，连接如下：
https://downloadcenter.delta-china.com.cn/zh-CN/DownloadCenter
1703836513330-867a4ae8-d044-4c05-bf13-e8d4142489fe.png

在下载的网页中找到如图如上图片进行软件的下载，下载完成后直接进行安装。
安装完成后在软件的运行界面中依次按照下图进行操作，在步骤3中就可进行静态 IP 的设置，点击确认即可；（注：首次链接的时候保证 PC 的 IP 静态地址是 192.168.1.**，因为 PLC 的默认 IP 是192.168.1.5）
1653654606698-47236403-9413-4d89-aa8c-de249cc247ed.png

如果上述方法不能刷新出网络配置，使用下图步骤进行 IP 添加，设置步骤如下：
1653654606871-1123cc71-2380-4350-88d4-114a2f2a43cc.png

### 2.PLC 程序的编写和下载
需要使用台达 PLC 的编写软件进行 ModbusTCP 通讯，软件下载地址和 PLC 编程软件的下载地址相同。
## 下面是PLC程序的链接：

## Dvp-tcp.zip

在上述的下载链接中下载如下图的软件并进行安装。
1703836558721-a765b143-1127-4563-a571-82ab5d6acdf1.png

## 安装完成之后如下如的快捷方式：
1653654607418-10a92281-a59a-4f6f-87ab-3165f90a8247.png

## 运行软件之后如下图操作：
1653654607777-a2d709b7-8d31-47f3-8b74-006d60937654.png

注: 如果过程中出现 PLC 与记忆容量不符合的情况请设置机型为 SE 再下载程序到 PLC，如下图。

1653654607964-a2a972f4-9fa5-4cfc-86c3-1c0b0b543764.png

### 3.IO 说明
DVP26SE11T/DVP12SE11R 系列对应的 ModbusTCP 只读/读写位，需要在 Roboshop 中进行地址映射，配置方法如下图所示：
1653654608274-b99cd84c-de34-4333-9a8d-36a055a4d137.png

### 4.程序锁定说明
### 5.3 使用扩展模块的地址断层现象
注1:台达 DVP(26/12)SE 系列的 Modbus TCP 地址如上所示，但是由于系列不同或者品牌不同会导致这个起始地址发生变化，所以在换非我司提供的选型时候就需要您咨询 PLC 供应商获取 ModbusTCP 对应的输入输出地址。
注2:如果 PLC 的本体使用的点数任然不能够满足需求，此时需要在 PLC 本体上加入扩展 I/O，此时需要注意，这个地址并不是顺延的，例如 DVP12SE 系列的输入/输出分别是8/4口，如果您想分别加入8个点的输入和输出模块各一个的话，这个时候在 Roboshop 中配置的modbusDInum>8+8+8(第一个8代表 PLC 本体的X0至X7,第2个8代表X8至X15。
注3：台达 PLC 将 Modbus 起始地址的输入/输出的前16位给 PLC 本体使用，不管 PLC 本体有没有16个点。所以针对上述的 DVP12SE 来说这个8就算在 Roboshop 中配置了也没有实际操作意义；但是如果您选择的本体是 DVP12SE 您又想使用扩展模块就必须要这么使用，最后这一个8就代表8输入的DI模块的点数，modbusDOnum>28，与上述 DI 配置的说明相同。

### 六. 附件
PLC 的接线说明（注：文档只有电气接线参考，有的也有尺寸等信息，具体的使用可至官方网站进行详细的资料下载）
## 台达系列：
## DVP26SE11T

## DVP_26SE11T.pdf
## DVP12SE11R

## DVP_12SE11R.pdf
