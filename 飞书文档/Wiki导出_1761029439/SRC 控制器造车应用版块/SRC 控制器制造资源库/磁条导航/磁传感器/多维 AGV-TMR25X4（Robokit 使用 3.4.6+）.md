# 多维 AGV-TMR25X4（Robokit 使用 3.4.6+）

多维 AGV-TMR25X4（Robokit 使用 3.4.6+）

## 版本

## 更新日期

## 更新说明

## 文档状态

## 维护责任人

## V1.0

### 2024.4.29

## 更新发布

## 使用中

## V1.1

### 2024.7.25

## 添加串口配置

## 使用中

## 一、适用范围
适用于 SRC-2000 / SRC-800 / SRC-3000 / SRC-880 等支持 USB 接口的控制器。
Robokit 使用 3.4.6+ 版本，Robokit 3.4.5 暂不支持磁条导航功能。
### 二、功能原理
磁导航传感器具有一到多组微型磁场检测传感器，每个微型磁场检测传感器对应一个探测点，例如 AGV-TMR25X4 具有 16 个探测点。
磁条、磁道钉、通电的电缆会产生磁场，当磁导航传感器位于磁条上方时，每个探测点上的磁场传感器能够将其所在位置的磁带强度转变为电信号，并传输给磁导航传感器的控制芯片，控制芯片通过数据转换就能够测出每个探测点所在位置的磁场强度。根据磁条的磁场特性和传感器采集到的磁场强度信息，越靠近磁条磁场强度越大，控制器就能够确定磁条相对磁导航传感器的位置。一般磁条正上方四个探测点所在位置的磁场最大，其它探测点所在位置的磁场强度相对较弱，特别是远离磁条的探测点所在位置的磁场强度几乎为零。磁导航传感器由此获得磁条的磁场分布，从而确定磁条在磁导航传感器探测点的点位。
如果小车沿着磁条行进，磁导航传感器应该位于磁条正上方；当磁导航传感器检测到磁条不在传感器的正下方，而是偏左或者偏右，小车就可以通过左转或者右转进行前进方向调整，直到传感器检测到磁条位于传感器的正下方为止，从而校正行进路线，达到导航的目的。
### 三、机械尺寸
### AGV-TMR25X4 外形尺寸图（尺寸单位：mm ）：
1702524867556-d5312e93-cf32-4e4c-b705-93cbffd34951.png

AGV-TMR25 系列磁导航传感器底部与宽度 30 mm ~ 50 mm 的磁带垂直高度建议在 10 mm ~ 40 mm 区间内。
### AGV-TMR25X4 装配示意图（尺寸单位：mm）：
1702524891355-b50d6688-01b9-4509-9b1a-b840ecef2eda.png

### 四、技术规格

工作电压 VCC： 10 V - 30 V。
支持 N 极磁场、S 极磁场及 N / S 极磁场的三种工作模式。
支持16 位检测通道数字信号量输出和1 mm 精度绝对位置量输出。
支持三段磁条同时检测。
支持 RS-232 自定义配置。
支持 RS485 通讯。
防护等级：IP65。
工作温度：-25 ℃ ~ 80 ℃。

### 五、接线说明
AGV-TMR25X4 接口型号：GSP002RC-2.5-06P-11-600A(H)
1702524949132-6eaf7271-80e3-42b5-9628-db78dabfbdf0.png

### AGV-TMR25X4 接口定义（俯视图）：
1702524963411-566ff99a-1c11-4503-b382-bcc27fbb0647.png

## 序号

## 1

## 2

## 3

## 4

## 5

## 6

## 接口定义

## VCC 10V-30V

## GND

## 232_RX

## 232_TX

## 485_A

## 485_B
供电后，485-A 和 485-B 分别和控制器的 485-A 和 485-B 接口连接通信。
### 六、状态指示
## 工作模式状态：

## LED 状态

## 绿色 LED 常亮

## 红色 LED 常亮

## 红绿 LED 交替闪烁

## LED 熄灭

## 工作状态

## N 极模式

## S 极模式

## N/S 极模式

## 设备故障
### 七、出厂配置
准备一个串口工具，将串口工具的 RS232 的 RX TX GND 和 AGV-TMR25X4 的 RS232 的 RX TX GND 连接。
打开 AGV-TMR25X4 的配套软件 AGV Guide Sensor。

### AGV-TMR25xx上位机软件.zip
进入产品型号选择界面，下拉框里使用对应的传感器模式，点击start 启动按钮。
## image.png

接着进入232 和485 参数设置界面。
## image.png

点击通讯菜单，出现下拉按钮— 串口连接和串口断开，可对232 串口的连接状态进行设置。
## image.png

点击参数菜单，出现下拉按钮—参数读取和参数写入，可对AGV-TMR25X4 的系统参数进行读取或者写入操作。
## image.png

RS-485 通信参数设置，可对RS-485 通信的产品进行地址，波特率、校验及从机的应答方式进行设置。参数设置完成，点击参数菜单栏下的参数写入按钮，产品断电重启生效。
注意：从机地址需要配置成模型文件 magnetic 的 id 一致，比如使用两个磁传感器，magnetic 的 id 为1 magnetic1 的 id 为2，两个磁传感器的从机地址需要分别改成 01 和 02 ，同时模型文件配置的 /dev/ttyUSBx 需要和对应磁传感器的实际USB接口一致；波特率设置为 115200，无校验。
## image.png

系统参数读取状态栏，点击参数菜单栏下的参数读取按钮，可查看当前产品内部系统参数，确保已修改的参数生效。
## image.png

### 八、参数配置

在模型文件找到 magnetic 设备。
1702969882544-5b8bd899-62bb-41ce-b0ab-bfa1f619f25b.png

默认禁用 magnetic 设备，先启用设备。
1702969891573-cda2d140-9766-46a2-bdab-0b81d923b5d3.png

设置磁传感器的设备号 id，默认为 1 ；如果使用两个磁传感器则 id 分别设置为 1 和 2，以此类推。
1702969900590-f3393e1e-5953-4de7-a4af-4170a0931bd4.png

设置磁传感器相对于车体中心的安装位置，单位为 mm。
1702969907524-a738579f-3ccd-4127-94fe-daa2cea5ed39.png

设置磁传感器探测点的距离和数量，DuoWeiAgvTMR25 默认探测点间距为 10 mm，数量为 16 个探测点。
1702969916070-e4582356-2f10-44e2-9213-c9a7c16029eb.png

设置磁传感器的品牌为 DuoWeiAgvTMR25 。
1702969923254-02a2619b-86c3-4f6e-8d2f-07349c6fc6d1.png

设置磁传感器的通信接口为 RS485， 默认波特率 115200 hz，设备名需要和实际连接的 USB 串口保持一致，通常设备名为 /dev/ttyUSBx ，x 表示具体串口号。
1702969930952-53900c77-1705-4869-adb0-597ce22a69cd.png

### 九、串口配置

SRC-2000 USB 串口与 devPath 配置对应关系：
## 2000USB.png

例如 USB 设备插入到上图中 ttyUSBS0 箭头指向的 USB 口，devPath 需要配置为 /dev/ttyUSBS0。
注：SRC-PATCH-X86 需要升级到 0.1.7+ 版本，且为源控工控机版本。
