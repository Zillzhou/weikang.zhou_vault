# 托菲编码器

## 托菲编码器

## 版本

## 更新日期

## 更新说明

## 文档状态

## 维护责任人

## V1.0

### 2024.4.30

## 语雀迁移至飞书

## 使用中

## 托菲编码器配置文档
## 1 适用范围
### 针对托菲LCF80J系列-CANopen编码器
## 2 端子配置
1670207781111-332dad65-2f90-4fbc-b30e-2e6ce788d23a.png

## 3 机械图
1670207781516-f813b43b-910b-4245-afb6-928c5ff59636.png

## 4 配置方法
注意：读写数据均为16进制，初始波特率为125k，初始node-id为20；
（直接从我司采购的LCF80J-3.6m型号，所有参数均已配置完成，无需重复配置，默认波特率为250khz）
## 拉线编码器的安装方向情况：
 正方向：一般情况下拉线编码器安装在货叉的底部，正速度的是拉线拉长的方向。
 反方向：拉线编码器安装在货叉的顶部，正速度是拉线缩短的方向。若是此种安装方向，则需要配置2.2.4(将拉线编码器的计数方向反向)。
### 5 默认上电收到id720，数据00的信息，如图：
1670207782036-42c1f71a-44ea-4d74-b9fc-3eafb8fe5d52.png

## 6 保存参数
object 1010h:sub index=01 保存参数（注意： 读写此寄存器都起到保存参数的作用 ）
## a.读操作：
### send: 40 10 10 01 73 61 76 65
### rcv: 43 10 10 01 00 00 00 00
## b.写操作：
### send: 22 10 10 01 73 61 76 65
### rcv: 60 10 10 01 00 00 00 00
## 7 恢复出厂设置
### object 1011h:恢复出厂参数值
## a. 读操作：
### send: 40 11 10 01 6c 6f 61 64
### rcv: 43 11 10 01 00 00 00 00
## b. 写操作：
### send: 22 11 10 01 6c 6f 61 64
### rcv: 60 11 10 01 00 00 00 00
## 8 设置报文周期(心跳)
### object 1017h: heartbeat 报文周期
## a. 读操作：
### Send: 40 17 10 00 00 00 00 00
### Rcv: 4b 17 10 00 d0 07 00 00
### b. 写操作：1000 ms (0x03E8)
### Send: 22 17 10 00 E8 03 00 00
### Rcv: 60 17 10 00 00 00 00 00
### 9 设置设备id.(can-id，按实际情况配置)
### object 3000h:encoder 通信 ID
## a. 读操作：
### Send: 40 00 30 00 00 00 00 00
Rcv: 4f 00 30 00 20 00 00 00 node_id=0x20
## b. 写操作：
### Send:22 00 30 00 06 00 00 00
Rcv:60 00 30 00 20 00 00 00 node_id=0x06
## 10 配置波特率 （按实际情况配置）
## object 3001h:通信速率
## 通信波特率参数如下：
### Baud=0 -----------20K bps
### Baud=1 -----------50K bps
### Baud=2 -----------100K bps
### Baud=3 -----------125K bps
### Baud=4 -----------250K bps
### Baud=5 -----------500K bps
### Baud=6 -----------800K bps
### Baud=7 -----------1M bps
## a.读取
### Send: 40 01 30 00 00 00 00 00
Rcv: 4F 01 30 00 baud 00 00 00
## b. 发送：
Send: 22 01 30 00 03 00 00 00（125Kbps）
### Rcv: 60 01 30 00 00 00 00 00
## 11 启动模式
## object 3005h: 启动模式
编码器有自启动及上位机控制启动两种方式，前者编码器上电后自动上传编码器读数信息，
后者需上位机启动命令后才能正常上传编码器读数信息。
### Mark_auto=0 编码器受上位机控制启动
## Mark_auto=1 编码器自动启动
## a. 读操作：
### Send: 40 05 30 00 00 00 00 00
Rcv: 4f 05 30 00 Mark_auto 00 00 00
### mark_auto 为编码器自启动标志位
## b. 写操作：
Send: 22 05 30 00 Mark_auto 00 00 00
Send: 22 05 30 00 01 00 00 00  配置为自启动
### Rcv: 60 05 30 00 00 00 00 00
设置好自启动模式后，需要将当前参数进行保存，上电重启后编码器的启动方式就是用户设定的模式。
## 12 设置单圈分辨率
Object 6001h ：单圈分辨率(先设定单圈分辨率，再设定总分辨率)
## a. 读操作：
### Send: 40 01 60 00 00 00 00 00
### Rcv: 43 01 60 00 00 10 00 00
## 由此得到单圈分辨率为 4096
## b. 写操作：
### Send: 22 01 60 00 00 10 00 00
### Rcv: 60 01 60 00 00 00 00 00
### 设定单圈分辨率为 0x1000(4096)
## 13 设置完整分辨率
### object 6002h:完整分辨率（多圈+单圈）
## a. 读操作：
### Send: 40 02 60 00 00 00 00 00
### Rcv: 43 02 60 00 00 00 00 01
### 由此得到完整分辨率为 4096*4096
## b. 写操作：
### Send: 22 02 60 00 00 00 00 01
### Rcv: 60 02 60 00 00 00 00 00
## 14 设置PDO发送时间间隔
## PDO 发送测量值周期
## a. 读操作：
### Send: 40 00 62 00 00 00 00 00
### Rcv: 4b 00 62 00 05 00 00 00
通过回读数值得到发送间隔时间为 5ms.
## b. 写操作：
### Send: 22 00 62 00 10 00 00 00
### Rcv: 60 00 62 00 00 00 00 00
将周期设定为 10~100ms。
注：本编码器建议 PLC 使用 250K 以上通信速率，如果使用 250K 以下通信速率请相应调
整编码器上传数据周期，如果周期时间太短，会造成 CAN 总线数据阻塞， 如果数据阻塞，可以把数值加大 。
## 15 编码器计数方向
### object 2100h : 编码器计数方向
### Bit0＝0 (主轴顺时针旋转，数据增加 )
### Bit0＝1 (主轴逆时针旋转，数据增加 )
## a. 读操作：
### Send: 40 00 21 00 00 00 00 00
### Rcv: 4b 00 21 00 00 00 00 00
## b. 写操作：
### Send: 22 00 21 00 01 00 00 00
### Rcv: 60 00 21 00 00 00 00 00
将顺时针修改为逆时针旋转计数增加。
## 16 保存参数后自动重启
### object 2300h : 保存参数后自动重启
## a. 写操作：
### Send: 22 00 23 00 AA 55 55 AA
### Rcv: 60 00 23 00 00 00 00 00
按红色报文设置即可。
