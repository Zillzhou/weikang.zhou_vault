# 立澈编码器

## 立澈编码器

## 版本

## 更新日期

## 更新说明

## 文档状态

## 维护责任人

## V1.0

### 2024.4.30

## 语雀迁移至飞书

## 使用中

## V1.1

### 2024.12.23

## 增加编码器方向配置
## 优化文档格式

## 使用中

## 一、适用范围
本文档针对 立澈-系列 拉线编码器的配置方法进行说明。
### 二、调试资源
## 上位机软件：

### USB_CAN+TOOLSetup(V9.12).zip
### 三、检查接线
### 将拉线编码器的 can 接到 can模块 上面

### 注意： canH 接 canH ， canL 接 canL

注意：在操作过程中，必须保证 can 总线上面只有拉线编码器这一个设备。( can 模块和拉线编码器直接相连)
### 四、拉线编码器参数配置
## 前言
## 拉线编码器的安装方向情况：
 正方向：一般情况下拉线编码器安装在货叉的底部，正速度的是拉线拉长的方向。
### 拉线编码器要根据模型文件的配置情况进行配置激活：
（1）在叉车上面只使用一个拉线编码器的情况，配置方法请参照 二、使用单个拉线编码器配置方法；
（2）如果是三向叉等使用多个拉线编码器的车辆，配置方法参照三、使用多个拉线编码器配置方法；
配置多个拉线编码器时候要对照相关模型文件的配置文档，对应好不同的拉线编码器对应的货叉的动作。
## 拉线编码器的初始状态
立澈系列的拉线编码器的初始波特率是自动识别的，不需要配置波特率。
### 4.1 单个拉线编码器配置方法
## 配置拉线编码器的步骤：
打开 can 上位机软件 USB-CAN ,利用软件打开设备，将波特率设置为125K。

注：立澈系列的拉线编码器的初始波特率是自动识别的，不需要配置波特率；
### 4.1.1 预操作配置
### 4.1.1.1 启动总线命令
### enable the LSS mode:
The encoder will not reply to this message.
## 发送报文：
## ID: 00 00 00 00
## DATA: 01 00
1685607244879-b18e8e4b-df68-4262-968d-16a47b7663df.png

### 看到 回复的帧ID是0x704 ，则nodeID为 04
### 4.1.1.2 进入预操作模式
## 发送报文：
## ID: 00 00 00 00
## Data: 80 00
1685607424322-916150d0-d260-4206-97cd-6a091f017339.png

### 4.1.1.3 修改node ID 为 5
### 4.1.1.1中回复报文 node ID 是 0x704，此处的 ID 为 0x600 + node ID = 0x600 + 4，
## 发送报文：
## ID: 00 00 06 04
### DATA: 2F 01 21 00 05 00 00 00
1685607586595-e7bfa699-4d67-4ae2-a2b5-5f90c71ff6ed.png

## 返回报文：
## ID: 0x584
### DATA: 60 01 21 00 00 00 00 00
### 4.1.2 设置数据传输PDO模式
### 4.1.2.1 设置拉线编码器PDO的COID
（4.1.1.3 设置为节点地址为 0x05，拉线编码器上报数据设置为 0x185（为0x185 + node ID））

注：（设置为节点地址为 0x05，拉线编码器上报数据设置为 0x185（为0x185 + node ID））
### 4.1.2.2 设置传输的模式为PDO模式
## 发送报文：
## ID: 00 00 06 05
### DATA: 23 00 18 01 85 01 00 00
note: ID should be 0x600 + nodeID
1685608035351-392eb895-da68-42ee-8a13-0fac60906c34.png

## 返回报文：
## ID: 0x585
### DATA: 60 00 18 01 00 00 00 00
### 4.1.2.3 设置传输的周期为10ms
## 发送报文：
## ID: 00 00 06 05
### DATA: 22 00 64 00 0A 00 00 00
data[4:7] indicats the period in milliseconds.
1685608115510-40c19149-9c79-4f1f-81b8-c6b111bb10a3.png

## 返回报文：
## ID: 0x585
### DATA: 80 00 64 00 02 00 01 06
### 4.1.2.4 触发改为周期
## 发送报文：
## ID: 00 00 06 05
### DATA: 2F 00 18 02 FF 00 00 00
## 返回报文：
## ID：0x585
### DATA: 60 00 18 02 00 00 00 00
### 4.1.3.4设置循环周期
## 发送报文：
## ID：00 00 06 05
### DATA: 2B 00 18 05 32 00 00 00
## 返回报文：
## ID：0x585
### DATA: 60 00 18 05 00 00 00 00
### 4.1.3 设置编码器方向（可选，根据实际安装情况配置编码器方向）
## 设置顺时针方向数据增大（默认配置）：
## 发送报文：
## ID：00 00 06 05
### DATA: 2B 00 60 00 04 00 00 00
## 否则设置逆时针方向数据增大：
## 发送报文：
## ID：00 00 06 05
### DATA: 2B 00 60 00 05 00 00 00
## 返回报文：
## ID：0x585
### DATA: 60 00 60 00 00 00 00 00
### 4.1.4 保存参数
## 发送报文：
## ID: 00 00 06 05
### DATA: 23 10 10 01 73 61 76 65
1685608305750-484cb54a-2028-4a3d-9943-2ae6d8d14565.png

## 返回报文：
## ID：0x585
### DATA: 60 10 10 01 00 00 00 00
### 4.1.5 重新上电
重新给拉线编码器断电之后，上电。确认货叉降到底，标零拉线编码器。
### 4.2 使用多个拉线编码器的配置方法

注意：在使用多个拉线编码器的情况，由 outencoder ID 来区分不同
### 4.2.1 修改拉线编码器的node-ID

注：此步骤在多向叉车上面配置多个拉线编码器，若叉车上面只有一个拉线编码器，则忽略此步骤，若需要修改拉线编码的 nodeID ，请看 4.1.1.3、修改拉线编码器的 nodeID
### 六、测试
模型文件配置：linear中的 encoderLine 配置为 1024 ，reductionRatio 配置为 200；
### 七、常见问题
