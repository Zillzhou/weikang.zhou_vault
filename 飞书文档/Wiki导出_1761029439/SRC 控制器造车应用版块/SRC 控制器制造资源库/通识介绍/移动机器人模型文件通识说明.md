# 移动机器人模型文件通识说明

## 移动机器人模型文件通识说明

## 版本

## 更新日期

## 更新说明

## 文档状态

## 维护责任人

## V1.0

### 2024.8.30

## 初版编辑

## 使用中

## 模型文件作用

## image.png

## image.png

定义机器人的物理结构与运动模型：机器人模型文件能够精确地描述机器人的机械结构，以及机器人运动学和动力学相关的参数及约束条件，这些信息对于机器人的运动控制和轨迹规划至关重要。
描述传感器与执行器：可以对机器人搭载的传感器和执行器进行详细描述，包括传感器的类型、安装位置、测量范围和精度，以及执行器的驱动方式、力 / 扭矩输出等特性。这使得机器人控制系统能够正确地配置和使用这些设备，实现感知环境和执行任务的功能。
满足个性化需求：用户可能有各种个性化的需求和特定任务，配置机器人模型能够根据用户的具体要求，对机器人的功能、参数等进行调整，提供个性化的机器人解决方案。
## 模型文件页面概览
      在使用 Roboshop 连接机器人时，可以在标题栏中看到模型文件选项，连接成功后可以进行拉取，可以查看到当前所有支持的模型文件，每个不同的模型文件对应着机器人身上不同的部分。
## image.png

## ① 文件操作选项
【加载】：加载已配置的模型文件。
【拉取】：从机器人端拉取模型文件到本地。
【推送】：从本地推送修改后的模型文件到机器人。
### ② 机器人模型布局图（机器人俯视效果图）
我们可以在模型布局图中大致看到激光、电机、充电口的相对位置，激光的扫描范围，以及车体形状等。
模型布局图中还包括机器人坐标系（遵循右手坐标系）。机器人坐标系的坐标原点即为机器人的旋转中心，通常机器人坐标系的原点规定为两轮轴距的中心点（四轮差动车除外，4个驱动轮对角线的交叉点）。

## image.png

## image.png

## image.png

## ③ 模型文件类型
不同的模型文件对应着机器人身上不同的部分。
## ④ 属性窗口
在属性窗口中点击【启用设备】可以开启使用该模型，并在布局图上显示。可对机器人模型参数进行具体配置。
## 模型文件配置
## image.png

## 控制和运动模型类
## chassis 底盘
## image.png

## basic
name：车体名称。
shape2chassis_x：车子轮廓的几何中心相对于里程中心坐标下的 x 。
shape2chassis_y：车子轮廓的几何中心相对于里程中心坐标下的 y 。
shape2chassis_theta：车子轮廓的几何中心相对于里程中心坐标下的角度。
## image.png
## shape2chassis_x=0.3
## shape2chassis_y=0
### shape2chassis_theta=0

### Robokit版本 > 3.4.6.13
对于全向车（如：多舵轮车、多差速模组车），可以任意选择运动中心，按固定线路导航。对于实际应用中一些车体轮廓的几何中心与里程中心不同时，我们可以按车子轮廓的几何中心来导航。车子轮廓的几何中心相对于里程中心的位姿，可以由模型文件中的 shape2chassis 来定义。
## mode
## differential差动车
wheelNum：轮子数量，地牛类搬运叉车一般配置为 2。

## image.png

## image.png

## steer单舵轮车
realWheelDrive：是否是后轮驱动。
wheelBaseShiftLength：叉车在升起后（加载货物时），主动轮与从动之间的轴距的变化值，默认为0。
allowWheelBaseShiftLengthCalib：允许轮距偏移长度校准，主要用于搬运车车型，货叉升起后从动轮相对车体位置发生变化的情况。
## image.png

## multiSteers多舵轮车
## image.png

## omni全向车
## image.png

## dualDiff多差速模组车
## image.png

## RGV2双向轨道车
## RGV4四向轨道车
## shape
## rectangle矩形（工业机器人）
## image.png

width：车体的最大外宽度。
head：机器人坐标原点（旋转中心）到达车头的距离。
tail：机器人坐标原点（旋转中心）到达车尾的距离。
height：矩形车的高度。
## circle圆形（服务型机器人）
## image.png

radius：圆形车的半径。
height：圆形车的高度。
## polygon多边形
## image.png

polygon：多边形车的顶点坐标。（相对于里程中心的位置）
polygon 顶点属性按照json格式配置，如下，注意，顶点必须按照顺序书写，不论是顺时针还是逆时针顺序。
## [
## {
        "x": 0.4,
## "y": 0.01
    },
## {
        "x": 0.23,
## "y": 0.544
    },
## {
        "x": -0.392,
## "y": 0.348
    },
## {
        "x": -0.375,
## "y": -0.42
    },
## {
        "x": 0.256,
## "y": -0.58
## }
## ]
height：多边形车的高度。
## controller 控制器
## image.png

## basic
Bax：x 轴加速度计偏置。
Bay：y 轴加速度计偏置。
Baz：z 轴加速度计偏置。
x：控制器在小车坐标系下的 x 坐标。
y：控制器在小车坐标系下的 y 坐标。
z：控制器在小车坐标系下的 z 坐标。
## qx
## qy
## qz
## qw
SSF：灵敏度缩放因子。
isExternalUseForCancelTask：是否在外部控制模式下取消任务。
## voltage
controllerRatedVoltage：控制器额定电压（标准电压值）。
overVoltage：控制器过压阈值。如该参数填 10% ，即输入电压超过controllerRatedVoltage的 10% 时会报警告。
warningVoltage：控制器警告电压。如该参数填 5% ，即输入电压低于标准电压的 5% 会报 warning。
errorVoltage：控制器报错电压。如该参数填 10% ，即输入电压低于标准电压的 10% 会报 error。
faultVoltage：控制器故障电压。如该参数填 20%，即输入电压低于标准电压的 20% 会报 fault。若 fault电压状态维持 120s（controllerShutdownStillTime），控制器将会自动关机。
controllerShutdownStillTime：电压状态维持多少时间后关机。
fullPercentage：电池充满百分比。
## CAN

2000控制器的 CAN 总线最多接 8 个设备，核心控制器提供 2 路 CAN，1 路 CAN 最多接 4 个设备。
## image.png

## canPort
 port1：CAN 的通信端口 1。
 port2：CAN 的通信端口 2。
## image.png
## SRC-2000

CAN总线接线与模型文件中配置的【canPort】保持一致。
如下图所示，当机器人安装有多个驱动器(数量 ≥2)时，所有从站的 CAN_L , CAN_H 引脚直接相连即可，采用串联方式接线。
## image.png

## baudrate
该路 CAN 的通信波特率，根据实际情况进行选择。
## basic
terminalResistance：该路 CAN 的终端电阻是否存在。默认勾选，可以匹配总线阻抗，提高数据通信的抗干扰性及可靠性。
为保证 can 通讯质量，需要将距离核心控制器最远的驱动器上的 120Ω 终端电阻打开，如上图中将 Driver1 驱动器上终端电阻通过拨盘打开；其他 Driver2,3,4 的终端电阻关闭，打开时终端电阻开关如下图所示：
## image.png

## DI

不同的控制器以及不同的固件版本，DI 数量是不同的。超过此数量后新添加的 DI 则为虚拟设备或扩展 DI。
SRC-800 和 SRC-2000 的 DI 都是 NPN 型，SRC-3000 既有 NPN 型又有 PNP 型。
SRC-2000 控制器中有 11 路 DI（NPN型）。
## 以 SRC-2000 为例：
## image.png

id：DI 的 id 号。
## Normal id：0-10
指机器人核心控制器中有 11 路物理 DI（DI0~DI10）。
## Virtual id：11-18
虚拟 DI，没有实际的硬件。可以实现某个协议交互，通过协议触发 DI 做测试。
## Modbus id：19-80
因为控制器的 DI 数量有限，通过 PLC 模块拓展的 modbus DI。
inverse：反向电平触发，虚拟 DI 和 curtisk 扩展DI除外。
## DO

不同的控制器以及不同的固件版本，DO 数量是不同的。超过此数量后新添加的 DO 则为虚拟设备或扩展 DO。
SRC-2000 控制器中有 10 路 DO。
当 Power DO 接感性负载时，如继电器、接触器等，需要在继电器或接触器上加续流二级管消除感性负载断开时产生的反电动势对系统电路干扰。
## 以 SRC-2000 为例：
## image.png

## id
Normal id：0-9（指机器人核心控制器中的 10 路 DO）

DO0 - DO7 为 Power DO 接口，为外部设备提供 24V 供电。
DO8、DO9 为普通 DO 接口，输出为 400mA。
### reserve：10-17（预留 DO）
Modbus id：18-79（控制器的 DO 数量有限，通过 PLC 模块拓展出更多 DO）
default：开机时默认上电状态。
## 安全行为触发和保护类
## EMC 急停
## image.png

## basic
recycleControl：勾选此参数，即拍下急停按钮时，将从调度系统回收控制权。
powerOffWhenCANError：勾选此参数，当 CAN 通信出现错误时，使电机失去电源。
resumeTask：勾选此参数，当拔出急停时，继续机器人当前的任务/导航。
cancelTask：勾选此参数，当按下急停时，取消机器人当前的任务/导航。
## func
driver IO EMC：通过驱动器的 IO 信号进行急停，电机处于失能状态 。将 SRC 控制器的急停输出接入驱动器的 DI 进行急停（需要配置驱动器），急停的效果取决于驱动器急停效果的配置。
stop and enable：AGV 停止运动且电机保持使能状态 。（不对外使用：为特殊客户应用）
stop and power off：AGV 停止运动且采用将驱动器断电的方式进行急停 。（不对外使用：为特殊客户应用）
driver protocol EMC：驱动器通过协议进行急停。Trigger配置enableMotor或disableMotor时勿使用此功能。

驱动器不具备 DI 或不能配置急停或使能，则通过CANOpen指令进行协议失能（严格意义上不可靠，推荐选型具备 DI 的驱动器）。
power off： 采用驱动器断电的方式进行急停。直接断开SRC控制器的继电器输入从而关断驱动器电源（若电气连接上无关联，则无效）。
## Trigger 触发器

img_v3_02ek_5a25203b-d30a-4d89-ba5c-818cb6fc9bbg.jpg

## image.png

## source
DI：通过控制器中的 DI 信号触发。
DO：通过控制器中的 DO 信号触发。
EMC：使用 EMC 作为触发来源。
externalControl：使用外部控制模式作为触发来源。
motorInfo：使用电机信息作为触发来源。
errorCode：使用错误码触发值。
## type
## risingEdge上升沿触发
## fallingEdge下降沿触发
## func
## suspendTask 挂起任务
## resumeTask 继续任务
## cancelTask 取消任务
### releaseControl 释放控制权
### recycleControl 回收控制权
### powerOffDriver 关闭继电器
## powerOnDriver 上电继电器
## openDO 打开 DO
## closeDO 关闭 DO
### switchToSRCControl 切换到内部控制
switchToExternalControl 切换到外部控制
## navToTarget 导航到目标点
## resetMotor 标零电机
### clearMotorFault 清除电机错误
## toggleDO 翻转 DO
## enableMotor 使能电机
## disableMotor 去使能电机
## runScript 运行脚本
### repowerDriver 重上电驱动器
## reopenDO 重上电 DO
## 应用
通过配置两个 Trigger，实现当机器人在调度下执行任务出现异常时，拍下急停按钮，机器人自动抢占控制权；松开急停按钮，机器人执行机构复位动作，完成后自动释放控制权。之后控制权会被调度自动抢占，并继续重新执行任务。
Trigger 配置了 EMC 上升沿信号（即拍急停）触发一个功能，抢占控制权。
## image.png

Trigger1 配置了 EMC 的下降沿信号（即松急停）触发一个功能，功能为执行机构脚本 containerRobot.py 的 zero 操作。
## image.png

### safeMoveCheck 安全移动检查
对于料箱机器人和叉车机器人等，导航前需要先将机构回到特定位置。通过模型文件配置safeMoveCheck，指定机器人移动前需要执行的脚本命令，实现使机构回到特定位置的功能。等价于，在机器人移动前，自动执行了一个原地任务，这个原地任务是执行一段脚本程序。
## image.png

## basic
scriptName ：被运行的脚本名称。
例如：ctuNoblock.py。
scriptArgs ：被运行的脚本参数，是一个 json 字符串。
### 例如：{"operation": "zero"}
即料箱车在移动前，会先执行标零动作，再去往下一个站点。
### collisionShape 自定义碰撞形状
自定义碰撞形状是机器人外形上额外附加的形状。碰撞形状是一个矩形，并且包含一个 groupId 。
## image.png

## basic
xMin：机器人额外碰撞区域在车体坐标系下 x 坐标的最小值。
xMax：机器人额外碰撞区域在车体坐标系下 x 坐标的最大值。
yMin：机器人额外碰撞区域在车体坐标系下 y 坐标的最小值。
yMax：机器人额外碰撞区域在车体坐标系下 y 坐标的最大值。
groupId：机器人额外碰撞区域的 id 号。
## 应用
通过在特定线路或者特定高级区域中配置groupId，可以加载相应的碰撞形状，从而实现机器人外形特殊的变化。

比如，机器人靠墙走，希望机器人在墙外那侧的形状大一些，就可以在靠墙线路或者靠墙区域中将 collisionGroupId 配置成相应碰撞形状的 groupId ，从而，当机器人运行在这条线路上时可以加载那个形状。
## image.png
## 线路属性

## image.png
## 高级区域属性

## 动力单元类
## battery 电池
## image.png

## basic
lowVoltage：用于电池最低电压报警阈值，-1默认不启用。低于最低电压阈值，即表明电池完全没电。
temperatureThreshold：温度报警限制，-1默认不启用，单位摄氏度。电池超过此温度阈值会报错，代表电池温度过高。
warningPercentage：电池告警百分比，用于指示电池低电量告警阈值。
errorPercentage：电池错误百分比， 用于指示电池电量低于多少进行报错。
shutdownPercentage：剩余电量低于多少百分比，执行关机命令，默认 -1，表示不启用。
timeoutThrowError：电池和控制器通信超时的报错时间。
chargeCounter：连续多少次判定为充电，默认为 0，表示不启用。
quantityFilter：电量滤波阈值。在电池电量低于此滤波阈值后，通过 BMS 通讯获取的数据是不可信的，就需要对它进行一些滤波，过滤掉这些数据。
shutdownStillTime：关机后电池维持对外放电的时间。
fullPercentage：电池的满电阈值，当电池大于此阈值，充电任务到点后，会立刻完成。
## brand
电池的不同品牌，对应不同的电池协议，请按照实际电池品牌和协议进行选择。
## image.png

已适配的常用品牌/型号电池；
通信脚本类电池，此类电池与控制器的通信通过串口（一般是 RS485）或 CAN 实现，通过电池穿透脚本实现与电池通信。
## voltage
电池的电压值，请按照电池的实际情况进行选择。
## capacity
电池容量的大小，请按照电池的实际情况进行输入。
### percentageCal（电池容量数据来源）
byProtocl：通过 BMS 获取电池信息。
byVoltage：通过计算电压获取电池信息。（如果通过协议无法获取电池容量的信息，可以通过电压映射的电池容量百分比换算）
## type（电池通讯方式）
### RS485 terminator 要勾选
## RS232
## CAN
## baudrate
当选择RS485、RS232时的通信的波特率，请按照电池的实际情况进行选择。
## ChargingVoltage
电池允许的最大充电电压。
## ChargingMode
protocolCharging：协议充电。充电桩根据车体识别文件和电池协议中允许的最大充电电压及电流来进行输出，两者小的数值优先。
stateCharging：状态充电。充电桩根据车体识别文件限制输出，在识别文件允许的最大充电电压及最大充电电流内，充电桩根据内部的充电曲线来进行输出，即充电桩模型文件中自动模式下的大小恒流。
### batteryCapacity：电池总容量
handoffBatteryLevel：大小恒流切换的电量阈值。AGV 电量超过该值之前使用大恒流充电，之后使用小恒流充电。
bigCurrent：大恒流值（大恒流的电流输出值，该值为单个模块输出值）。
smallCurrent：小恒流值（小恒流的电流输出值，该值为单个模块输出值）。
## charger 充电口
## image.png

## basic
x：充电口在车体坐标系下 x 轴方向的值。
y：充电口在车体坐标系下 y 轴方向的值。
theta：充电口在车体坐标系下 z 轴的角度偏移值。
## image.png
## 充电口在车体上的位置

switchDO：充电 DO 的 id 号，-1表示不存在这个 DO。

说明：所要控制的充电 DO 必须装配有充电回路继电器。若无该继电器或不需要控制该充电 DO 时，将 switchDO 设置为 -1 即可。例如：在充电时需要打开充电 DO3，则该数值应该填写为 3。对于叉车，如果配置了 switchDO，那么叉车离开充电桩前，需要同时保证 switchDO 关闭，并且充电电流小于 0。
switchDOTimes：在无法一次成功打开 switchDO 情况下，尝试打开 switchDO 的次数。
switchDODuration：充电 DO 打开关闭中，保持打开的持续时间。
openDODist：开始充电距离，机器人与充电桩距离小于该距离时开始充电；当这个值配置为 0 时，将会启用新逻辑：通过看是否有 DI 被配置成 "openCharge"，如果有，那就导航直到有一个符合要求的 DI 被触发后停下，之后再将充电 DO 打开。

特别注意：如果不存在硬件 DO，而是使用虚拟 DO 进行控制，需要在模型文件中 DO 列中添加一个 DO。对于叉车适配我司充电器存在一个特殊逻辑，当该值配置小于 -0.1 时，到达目标点后，会先等待充电桩伸出到位后，再打开 switchDO，从而避免充电开始打火花的现象。
chargeDI：如果该 DI 被触发，表示 AGV 有充电信号。-1 表示不存在这个 DI。
openChargeDI：如果该 DI 被触发则车体会停下，之后再将充电 DO 打开。-1 表示不存在这个 DI。
chargeActionTime：自动充电执行最长时间，任务开始时计时。
chargeStartTime：充电器上电最长时间，到达充电位置开始计时。
说明：当机器人到达充电点，充电信号有时候并不是立刻有，因此机器人需要等待一段时间。-1，则表示达到充电点后，立刻完成充电任务。
chargePathSpeed：充电运行速度。
recChargeAheadDist：机器人采用两段直线方式自动充电的前置距离。
recChargePlanAheadDist：当充电点和 AGV 侧向距离偏差较大时，采用两段直线方式规划前移距离。

## image.png
## 充电桩和机器人侧向偏差距离较小

## 20240923-153940.png
## 充电桩和机器人侧向偏差距离较大

recBeizer：是否基于贝塞尔曲线规划到 CP 点的路径。不勾选，即采用两段直线线路；勾选，则采用贝塞尔曲线。
recBeizerAheadDist：机器人采用贝塞尔曲线方式自动充电的前置距离。
recBeizerPlanAheadDist：当充电点和 AGV 侧向距离偏差较大时，采用贝塞尔曲线方式规划前移距离。

## image.png
## 充电桩和机器人侧向偏差距离较小

## image.png
## 充电桩和机器人侧向偏差距离较大

disableByEMC：拍急停是否关闭充电 DO，勾选则为拍急停断开充电 DO，反之将充电 DO 置于打开状态。
chargerUseOdo：按里程定位去充电。对于AMB，由于充电时，车头的激光对向充电桩，因此激光定位不准。此时就需要基于里程定位去充电。
chargeDisableMotorTime：完成充电任务前，需要将walk电机或者抱闸电机去使能相应的时间后再恢复使能。

说明：对于部分种类的机器人，比如料箱机器人或者具有抱闸功能的机器人。因为这种机器人在充电过程中是与充电桩直接接触的（接触式充电），因此在接触良好的情况下机器人与充电桩之间会产生应力过大的问题。由于机器人始终处在受力的状态，而电机需要保持零速状态，因此会表现出“用力对抗”的现象。长时间处于这种状态下，经常会导致电机过热、过流，从而使的驱动器报错。因此基于上述现象，在机器人充上电后，我们可以让电机去使能片刻，进行泄力，从而避免驱动器报错。电机的泄力时间由参数 chargeDisableMotorTime 控制。如果时间太短可能导致泄力不足，而时间太长，车子也有可能被充电桩弹出。
autoShieldLaser：自动添加激光扣除区域。为了避免充电桩的激光点阻挡，导致AGV无法充电的问题。
## powerOffDO
id：表示充电到点完成后进行关闭的 DO 编号（用于关闭设备进行充电的场合）。勾选即机器人从充电处离开前，机器人起步前，执行任务前，会自动打开 poweroffDO，避免漏电等状态。
## 导航、定位、避障类
## laser 激光雷达
## image.png

## basic
id ：激光在模型文件中的唯一id。
x ：激光在小车坐标系下的 x 方向偏差。
y：激光在小车坐标系下的 y 方向偏差。
z ：激光在小车坐标系下高度。
yaw：激光在小车坐标系下 z 轴方向安装的朝向角度。
step：激光的角分辨率。表示激光雷达在单帧扫描过程中每两根扫描线之间的夹角。不同的激光参数不同，具体参数在帮助中心查询适配过的激光的配置文档。
minAngle：激光扫描的起始角度。
maxAngle：激光扫描的结束角度。
maxRange：激光检测的最大距离。（RBK3.4.6.18+）
 Upside： 激光是否正装。
 useForLocalization ：激光只用于定位使用，不勾选，则默认用于避障。
 ip ：激光的上位机软件中设置的激光 IP 地址。
 port ：激光的上位机软件中设置的端口号。
3DLocalization：该激光是否用作 3D 导航。
3DObstacleDetection：该激光是否用作 3D 障碍物检测。
useForBinDetection：该激光是否用作库位状态监测。
maxLaserDistance：判断动点激光的生效距离。
## removedArea
## 根据设置切区角度扣除点云的功能
useAreaRemove：是否使用切区功能；一般在潜伏式顶升场景中会使用切区功能，需要将货架支腿在激光扫描区域中进行切除。
areaStartAngle：开始切区的角度值。
areaEndAngle：结束切区的角度值。
## brand
## 根据实际激光选型选择对应品牌
minValidRange：最小的有效探测距离，默认设置为0。
## laserGroup 激光组
作用：在线路上或者高级区域中屏蔽特定激光组。
## image.png

## basic
laserId：激光对应的 Id。
groupId：激光组 Id。
## 应用
防止放货过程中货架腿触发阻挡报警，临时屏蔽后置激光。
## 配置激光组laserGroup
## image.png

## 画高级区域，并选择屏蔽的激光组id
## image.png

### laserDeductArea 激光扣除区域
激光扣除区域用于扣除随车移动的激光噪点或者物体，激光扣除区域可以定义多个。
## static
static 静态激光扣除区域，用于将 AGV 体内的激光点扣除掉。这样可以避免 AGV 被一起移动的激光点阻挡。
应用场景：激光雷达大于 180 度时，扣除地牛两侧杆子引入的激光噪点。
## image.png

xMin：静态扣除区域的最小 x 坐标。
xMax：静态扣除区域的最大 x 坐标。
yMin：静态扣除区域的最小 y 坐标。
yMax：静态扣除区域的最大 y 坐标。
zMax：静态扣除区域的最大 z 坐标。
ignoreZ：如果为 true，所有 z 方向的障碍物点都会扣除。
laserGroupId：扣除特定激光组的激光点，如果 -1 扣除所有激光组的障碍物点。
## dynamic
dynamic 动态激光扣除区域，用于在指定的 conditionName 条件为 true 的时候，将 AGV 体内的特定激光点扣除掉。
应用场景：当叉车货叉伸出会遮挡叉车尾部激光时，可以在激光尾部配置一个动态激光扣除区域，再加上一个 condition 策略。
## image.png

xMin：动态扣除区域的最小 x 坐标。
xMax：动态扣除区域的最大 x 坐标。
yMin：动态扣除区域的最小 y 坐标。
yMax：动态扣除区域的最大 y 坐标。
laserGroupId：扣除特定激光组的激光点，如果 -1 扣除所有激光组的障碍物点。
conditionName：启用 condition 条件的名称。
模型文件中的 condition 模块，用于自定义条件。下面这种图片的含义是，定义了名字为 c1 的自定义条件。这个条件具体为：当电机 motor2 的 position 小于 0.2m 时，这个条件为 true 。
1677675607215-19329f39-8070-4afd-bd88-3c9eb75be15c.png

### laserProtectArea 激光保护区域
激光保护区域是指车体参与碰撞检测的区域。比如当叉车叉取货物时，由于车体进入货物，可能会导致虚拟激光或者真实激光触发碰撞，无法叉取货物。
## image.png

红色矩形为激光保护区域，只有预测到激光或者虚拟激光点与红色区域发生重叠，才会触发碰撞。而其他传感器，比如红外等依然采用真实叉车轮廓，进行碰撞检测。
## image.png

## basic
xMin：激光保护区域在车体坐标系下 x 坐标的最小值。
xMax：激光保护区域在车体坐标系下 x 坐标的最大值。
width： 激光保护区域的宽度。
## camera 相机
每个相机品牌支持的功能各不相同，因此功能选择区域会跟相机品牌不同略有差异。
## 易福门
## image.png

### brand（IFM-O3D303-TCP）
ip：相机上位机配置的 ip 地址。
port： 相机上位机配置的端口号。
useForObstacleAvoidance：是否启用相机的避障检测功能。
useForHasBinDetect：是否启用货物有无检测功能。
识别思路是在目标点的上方构造一个长方体box，判断box内是否存在一定量的点云，如果存在，则认为上方存在货物，否则认为没有货物。
1688439712554-8371d5f4-5378-42d2-aa6a-b5d8158546ee.png

maxLength：最大视野范围。
HorizontalFOV：水平视场角。
VerticalFOV：垂直视场角。
## basic
id：相机在模型文件中唯一 id 。
x：相机在机器人坐标系下 x 方向的位置。
y：相机在机器人坐标系下 y 方向的位置。
z：相机在机器人坐标系下 z 方向的位置，即相机的离地高度。
## image.png

roll：相机在机器人坐标系下 x 轴方向的偏差角。
pitch：相机在机器人坐标系下 y 轴方向的偏差角。
yaw：相机在机器人坐标系下 z 轴方向安装的朝向角度。
## image.png

isUpside：相机是否正装。安装姿态为正装需要勾选，否则反装不需要。正反装的配置方法可参考各自相机的配置文档。
timeDelay：用于修正相机通信的时间延迟问题。
## 大疆Livox Mid-360
## image.png

### brand（DJI-mid360-TCP）
ip：相机上位机配置的 ip 地址，注意不要与其他设备的 ip 冲突。
minLength：3D相机检测的最近距离。
maxLength：相机最远成像距离，超过该距离的相机数据会被截断。（RBK3.4.6+）
useForObstacleAvoidance：是否启用相机的避障检测功能。
useForLocalization：是否用于定位。
### useForDetectBinShape
useForHasBinDetect：货物有无检测。
## image.png

## image.png

horizontalStartAngle：水平起始角度。如上图性能参数表，水平 FOV 范围是 360°，即水平方向的起始角度是 -180°。
horizontalEndAngle：水平结束角度 。如上图性能参数表，水平 FOV 范围是 360°，即水平方向的结束角度是 180°。
verticalStartAngle：垂直起始角度。如上图性能参数表，竖直 FOV 范围是 -7°~52°，即竖直方向的起始角度 -7°。
verticalEndAngle：垂直结束角度。如上图性能参数表，竖直 FOV 范围是 -7°~52°，即竖直方向的结束角度 52°。
## basic
id：相机在模型文件中唯一 id 。
x：相机在机器人坐标系下 x 方向的位置。
y：相机在机器人坐标系下 y 方向的位置。
z：相机在机器人坐标系下 z 方向的位置，即相机的离地高度。
## image.png

### roll：3D 相机在车体坐标系下 x 轴的角度偏移值
### pitch：3D 相机在车体坐标系下 y 轴的角度偏移值
### yaw：3D 相机在车体坐标系下 z 轴的角度偏移值
## image.png

isUpside：相机是否正装，安装姿态为正装需要勾选。正反装的配置方法可参考各自相机的配置文档。
在 RBK 3.4.5 版本中建议安装姿态为 M12 接口朝上安装（如下图），并勾选参数“isUpside”。
## image.png

在 RBK 3.4.6 及以上版本中，可以任意姿态安装，并勾选参数“isUpside”。
timeDelay：用于修正相机通信的时间延迟问题。
## pgv 位置引导视觉系统
## image.png

## basic
onOpenTime：pgv 开机时间。
id：pgv 的设备 id 号。
x：pgv 在机器人坐标系下 x 轴方向的安装位置。
y：pgv 在机器人坐标系下 y 轴方向的安装位置。
z：读码相机镜头到二维码的距离，单位 m。
yaw：pgv 在机器人坐标系下 z 轴方向的朝向角（安装角度）。
upside：pgv 的安装位置是否为正装，若正装则勾选该项，反装则不勾选。
xUnit：读码相机返回的 X 数值单位，单位需换算为 m。
xRange：读码相机能看到的 X 方向的范围 ，单位需换算为 m。
yUnit：读码相机返回的 Y 数值单位，单位需换算为 m。
yRange：读码相机能看到的 Y 方向的范围 ，单位需换算为 m。
blinkDO：闪光灯 DO 序号，-1 表示不启用。
angleUnit：读码相机返回角度信息的单位，单位需换算为角度。
## func
### adjust调整（一般为上视 pgv 配置）
### localization定位（一般为下视 pgv 配置）
adjustLocalization调整加定位（ 既包含二维码导航也包含下视二维码调整）
## brand
## 根据需求选用已适配的品牌
## P+F-R4-485 倍加福 PGV
## MS-PGV-485 大华 PGV
## magnetic 磁传感器
磁导航传感器具有一到多组微型磁场检测传感器，每个微型磁场检测传感器对应一个探测点，例如 AGV-TMR25X4 具有 16 个探测点。
## image.png

## basic
id：磁传感器的设备号 id，默认为 1 。
x：磁传感器相对于车体坐标系 x 轴方向的安装位置，单位为 mm。
y：磁传感器相对于车体坐标系 y 轴方向的安装位置，单位为 mm。
yaw：磁传感器在机器人坐标系下 z 轴方向安装的朝向角度，单位为 度。
step：磁传感器探测点的距离，DuoWeiAgvTMR25 默认探测点间距为 10 mm。
resolution：磁传感器探测点的数量，DuoWeiAgvTMR25 默认数量为 16 个探测点。
## brand
磁传感器的品牌为DuoWeiAgvTMR25。
## port
设置磁传感器的通信接口为RS485。
devPath：设备名，需要和实际连接的串口保持一致。

一般 x86 平台设备名为 /dev/ttyUSBx（x 代表串口号）
ARM 平台设备名为 /dev/ttyUartx（x 代表串口号）
baud：RS485 的波特率，默认波特率 19200 hz。
## 外部传感器行为功能类
## DISensor DI传感器
## image.png

## type
## goodsDetect货架检测
## ignoreTask忽略任务指令
## collision防撞条 （最常用）
## infrared红外
## ultrasonic超声
## fallingDown防跌落传感器
## basic
id : DI 模块里设置的对应 id 号。
## shape
 arc ：扇形。
## x ：机器人坐标系下的 x 位置
## y ：机器人坐标系下的 y 位置
 yaw ：机器人坐标系下朝向角。
 minDist：最小范围，为该设备触发的最小有效距离。
 maxDist：最大范围，为该设备触发的最大有效距离。
 range ：扇形角度，为该设备的触发扇形的张开角度。
 vertx：多边形。通过长按红点进行形状变换，双击蓝色圆圈可增加控制点，实现多角度拖拽。
## func
## stop ：停止
## slowdown ：减速
### distanceSensor 距离传感器
## image.png

## basic
id：距离传感器编号，不可重复。
x：距离传感器在车体坐标系下 x 轴方向的值。
y：距离传感器在车体坐标系下 y 轴方向的值。
z：距离传感器在车体坐标系下 z 轴方向的值。
yaw：距离传感器在车体坐标系下 z 轴方向安装的朝向角度。
minDist：距离传感器最小检测距离（盲区），单位为 m。（最小/最大距离可通过查看距离传感器使用说明书方式获得）
maxDist：距离传感器最大检测距离（盲区），单位为 m。
range：距离传感器接收半角（距离传感器发射的散射角度），单位：度。（接收半角可通过查看距离传感器使用说明书方式获得）
minRSSI：距离传感器的最小信号强度，信号强度低于设定最小值距离传感器测距数值无效。（最小/最大信号强度可通过查看 distanceSensor 使用说明书方式获得）
maxRSSI：距离传感器的最大信号强度，信号强度高于设定最大值距离传感器测距数值无效。
## brand
根据实际传感器选型选择对应品牌。
## BeneWake-TFmini-i
## Panasonic-HG-C1000
## EICo-OSM4x-485
## port
距离传感器通信端口。如果选择 RS485 端口，需配置设备名称 comID，terminator 需勾选。
### distanceNodeGroup 距离传感器组
作用：在线路上或者高级区域中屏蔽特定距离传感器组。
## image.png

## basic
distanceNodeId：距离传感器的 id。
## image.png
## 模型文件-distanceSensor

groupId：距离传感器组的 id。
## 应用
在模型文件 distanceNodeGroup 中设置对应距离传感器组，然后在线路上或者高级区域中配置 forbidDNodeGroupId ，就会在碰撞检测时不考虑对应距离传感器组内的距离传感器。

比如：将模型文件 distanceNodeGroup 中的 distanceNodeId 配置为 0， groupId 配置为 0。
如果在相关线路的 forbidDNodeGroupId 配置为 0，那么机器人在行驶这条线路时，会在碰撞检测时屏蔽对应 groupId为 0 中的 distanceNodeId 为 0 的距离传感器。
## image.png

## WeighingDev 称重传感器
## image.png

brand：称重传感器的品牌。
type：称重传感器的通讯方式，canPort 需要和实际接线一致。
baudrate：通信波特率，根据实际情况进行选择。
## 外部机构类
## fork 货叉机构
## image.png

## basic
cargoContactDI：叉车取货到位开关。叉车取货时，如果到位DI触发，则叉车停止。
CheckAllCargoContactDI：是否检查所有叉车取货到位开关。
当没勾选时，会检测所有配置的 cargoContactDI，只要有一个配置的 cargoContactDI 触发了，就认为到达终点，然后进行下面的动作；
当勾选时，会检测所有配置的 cargoContactDI，只有所有配置的 cargoContactDI 触发了，才认为到达终点，然后进行下面的动作。
ContactDIXPos：到位 DI 到里程中心的距离。
## image.png

contactDi：叉齿上的货物检测 DI，如果为 -1 表示不起作用。
contactTime：货物检测防抖动时间。与 contactDi 配合使用，用于货物检测DI的滤波。
detachmentDi：叉齿上的货物分离 DI，如果为 -1 表示不起作用。
loadTime：加载货物延时时间，即最长执行时间。
unloadTime：卸载货物延时时间，即最长执行时间。
upDO：货叉抬升前控制 DO 的 id。
upDOStatus：货叉抬升前控制 DO 的状态。
downDO：货叉下降前控制 DO 的 id。
downDOStatus：货叉下降前控制 DO 的状态。
## forkBlockRegion
当 AGV 叉车抬起货叉的时候，叉车的架子会遮挡一部分激光，如下图所示。需要用扣除区域将这部分激光去除，防止碰撞检测误触发。只有当货叉抬升的高度大于 enableHeight ，扣除区域才起效。如果货叉高度低于 enableHeight ，扣除区域无效。
## image.png

enableHeight：叉车扣除区域起效的货叉高度。
width：叉车坐标系下扣除区域的宽度。
xmax：叉车坐标系下扣除区域在 AGV 坐标系下的 x 最大值。
xmin：叉车坐标系下扣除区域在 AGV 坐标系下的 x 最小值。
## image.png

### forkTailDi 货叉尖端 DI 型传感器
id：此 id 一般是货叉尖端两个 DI 的 id 名称，可以配置成数组。
filterTime：货叉尖端 DI 滤波时间，-1 表示不启用。
enableAtLoad：叉取货物时，是否启用 forkTailDi 的开关。关闭后，可以避免取货时货叉尾部 DI 被误触发的场景。
enableAtUnload：放货物时，是否开启 forkTailDi 的开关。开启后，增加了放货前检查库位是否有货物的功能。
autoClearError：是否要自动清除 52161 错误的功能。如果开启，当库位上的货物没有了，自动清除 52161 报错。
failTask：是否当 52161 报错后，任务要变成失败。如果开起来，当库位上检测到货物，报 52161 错误后，机器人的任务就会自动失败。
forkTailDistanceNode货叉尖端测距型传感器
distanceNodeId：此 id 为叉尖端两距离传感器的 id，可以配置成数组。
obsStopDist：叉取货物时，特殊的碰撞距离。该值小于0表示用默认的碰撞距离。
## BackLaser
id：叉车后视 DI 型激光的 id。
laserId：后视距离型激光的 id。
moveableLaserId：随着货叉移动的后视激光雷达 Id。 此激光雷达不参与碰撞检测，用于测量货物高度。

说明：当叉车后面存在两个后视激光雷达，一个是固定在车体；一个固定在货叉上，随着货叉上升的激光。固定在货叉上的激光是不参与避障，专门用于货物高度检测。那么需要在模型文件中将激光 id 配置到 moveableLaserId中。
enabledHeight：叉车后置激光起效的货叉高度。
pitch：后置激光雷达安装俯仰角，即激光线相对于货叉平面的夹角。
zToFork：后视激光雷达相对于货叉上表面的高度。高于货叉为正，低于货叉为负。
slowUpHeight：后视激光雷达检测到货物顶端后，额外提升的高度，避免货叉骤停。
## image.png

forkTailLaserId：货叉尾部点云激光的 Id。
laserDetectionWidth：后视激光检测宽度。在叉车去载货，载货中，去卸货，卸货完成去前置点上时，只考虑forkTailLaser中心宽度范围laserDetectionWidth内的激光点。
## image.png

## Weight

如果叉车使用了称重传感器，可配置 maxWeight (最大重量)，maxWeight 小于 0 则该功能不启用。
maxWeight：最大重量报错阈值。如果小于 0，超重报错功能不启用。
filterTime：最大重量保持时间。
## type
## none
## byDO
pumpDO：泵电机 DO。
leakDO：泄流阀 DO。
topDI：抬升到位 DI。货叉举升过程中，该 DI 触发可以结束货叉举升过程。
bottomDI：下降到位 DI。货叉下降过程中，该 DI 触发可以结束货叉下降过程。
upDelayTime：上升延时时间。货叉举升过程中，此参数用来限制货叉上升的最大时间，若超过此延时时间举升未到位，举升动作也会停止。
downDelayTime：下降延时时间。货叉下降过程中，此参数用来限制货叉下降的最大时间，若超过此延时时间下降未到位，下降动作也会停止。
## byController
safeHeight：开启安全行驶速度限制的高度，单位: m。在安全速度机制起效时，当货叉高度大于此阈值，速度会限制在safeSpeed之下。
safeSpeed：安全行驶速度。当安全速度大于0时，安全速度机制起效。当货叉高度大于 safeHeight时，最大速度小于safeSpeed。
linearMotor：如果非空，则表示用相应线性电机控制货叉抬升。
upMaxSpeedWithGoods：有货物时货叉抬升最大速度。
downMaxSpeedWithGoods：有货物时货叉下降最大速度。
maxHeightBias：最大货叉变化高度，货叉高度自然变化大于此阈值会报 52171 错误 。0表示禁用。
maxHeightBiasTime：发生叉高偏差错误的最大时间阈值，单位：分钟。
ultraSonicDiDistance：超声波 DI 检测到货物脱离后额外下降的高度。
openUltraSonicHeightCheck：是否开启货物完全脱离（ 超声波 DI 信号全部消失 ）功能。
## jack 顶升机构
## image.png

## basic
counterPointDI：对位光电 DI，只在顶升货物过程中，起作用，-1表示没有，可以为数组。（3.3.5.78+ 版本：当存在一个 DI 没有触发，就会报错）
counterPointTime：对位 DI 连续检测时间，连续触发该时间后认为成功。
cargoDI：货物检测 DI，只在顶货物导航中都起作用。-1表示没有，可以为数组。（3.3.5.78+ 版本：当存在一个 DI 没有触发，就会报错）
cargoDITime：货物检测 DI 的滤波时间。即货物 DI 连续检测的时间，在此时间内连续触发则视为成功。
loadTime：载货动作最长持续时间。
unloadTime：卸货动作最长持续时间。
## Type
byDO：表示由 DO 控制的顶升。
byController：表示由电机控制的顶升。
linearMotor：线性电机的电机名称。
hasBrake：电机是否有抱闸。如果配置为 true，那么当顶升电机移动后，会自动去使能触发抱闸功能。
byModbus：表示由 Modbus 控制的顶升。
byCustom：表示由客户自己控制的顶升。
## 驱控类
## motor 电机
## image.png

## basic
x ：电机在机器人坐标系下 x 方向的位置。
y：电机在机器人坐标系下 y 方向的位置。
yaw： 驱动器安装的朝向，默认为 0。
canID：驱动器在 CAN 回路上对应的 ID，根据驱动器上位机配置决定。有些驱动器通过外部拨码按钮设置，而其他驱动器则需要在上位机中调整。
maxRPM：电机的最大转速。一般可以在电机的名牌上找到，填写此值有助于系统正确限制电机的最大速度。
inverse：电机是否反向旋转。即逻辑上的取反，即控制电机的正转和反转，根据实际情况设置。
encoderLine：编码器线束/编码器分辨率/编码器脉冲数。编码器线数表示编码器在一个完整的旋转周期内产生的输出脉冲数或脉冲信号的周期数。这个值影响到编码器的精度。根据编码器的规格填写。
upLimitDI：上限位 DI，机械上升的极限高度，触发上限位会报警。
downLimitDI：下限位 DI，机械下降的极限高度，触发下限位会报警。
zeroDI：零位DI，零位触发的DI，用于标零回到所希望的零位处

说明：upLimitDI downLimitDI zeroDI 这些参数通常用于控制上层电机，如顶升电机或托盘旋转电机。对于行走电机而言，这些参数不需要配置。
passive : 是否为被动电机，不勾选代表不启用，行走电机不勾选。
brake：是否拥有抱闸。
currentFactor：电机电流因数，默认配置为1。
## func
## walk行走电机
wheelRadius：驱动轮半径，轮半径用于计算电机的线速度。（机器人的机械图纸上查看，也可以通过测量核对）。
reductionRatio：驱动轮减速比。减速比影响电机的输出扭矩和速度。根据实际测量填写，确保准确性。
minimumSpeed：电机的最小启动速度的上限值，例如电机需要 0.01m/s 才能启动，则下发值始若小于 0.01m/s 时会逐渐增加到电机刚好动的值作为启动速度，但不会超过该参数。
deltaCnt：该值用于特殊情况下，若电机编码器抖动较大时，启用该参数可以解决电机数据判断为非静止的状态。
deadDealerK：针对 minimumSpeed 的加速系数，系数越大，递增的速度越快，越快达到 minimumSpeed 上限值。一般情况下无需调节该参数。
## spin随动电机

场景：①随动功能；②电机可无限旋转，在目标位置安装有到位光电。
maxSpeed：最大速度。
maxAcc：最大加速度。
maxDec：最大减速度。
maxJerk：最大加加速度。
reductionRatio：一般为旋转机构转一圈时，电机轴（不考虑减速机构）所转的圈数，再通过计算可以得出当前机构模块所处的实际角度位置。
calibrationVel：标零速度，上电标零时设定的标零速度。（ 正负可以决定标零的方向 ）
Offset：零位的触发位置与转盘所需要的计算零位的角度。
blockDI：阻挡 DI，-1表示不启用。在标零过程中，该 DI 触发即可暂停标零过程，解除后继续。
## steer 转向电机
maxSpeed：舵轮旋转的最大速度。
maxAcc：最大加速度。
maxDec：最大减速度。
maxJerk：最大加加速度。
reductionRatio：舵轮减速比。
maxAngle：舵轮转向的最大角度。
minAngle：舵轮转向的最小角度。
steerOffset：舵轮角度的偏置值。
## image.png

steerResolution：舵角分辨率。
bySpeed：舵轮是否使用速度模式。
steerOffsetFile：steerOffset值所在的文件夹，标定文件使用，可忽略。
positionSpeed：舵轮旋转的位置模式的速度， 现在只能用作kinco配做转向电机的时候，请根据实际情况进行填写。
## linear 线性电机
reductionRatio：线性电机减速比。
一般为电机轴（不考虑减速机构）转一圈直线运动的距离，再通过计算可以得出当前机构模块所处的实际高度或长度。
calibrationVel：线性电机标零速度。
上电标零时设定的标零速度，约定上下运动时以上为正方向（速度为正值），左右运动以右为正方向。如顶升机构的标零 DI 一般安装在底部，故 calibrationVel 一般为负值即朝下进行标零。
maxLength：货叉上表面到地面最大距离。即线性机构最大行程位置，例如顶升机构中上到位所能达到的最大高度。
minLength：货叉上表面到地面最小距离。即线性机构最小行程位置，例如顶升机构中下到位所能达到的最小高度。
offset：零位的触发位置与机构所需要的计算零位的位置差值。
reachUpDist：上到位精度，用于衡量距离目标位置还有多远距离时停止。
reachDownDist：下到位精度，用于衡量距离目标位置还有多远距离时停止。
maxSpeed：最大速度。
maxAcc：最大加速度。
maxDec：最大减速度。
maxJerk：最大加加速度。
minUpSpeed：最小上升速度，0 表示不启用，使用上升 PID 调节。
minDownSpeed：最小下降速度，0 表示不启用最小速度，使用下降 PID 调节。
upKP：线性机构上升过程PID调节的比例参数。
upKI：线性机构上升过程PID调节的积分参数。
upKD：线性机构上升过程PID调节的微分参数。
downKP：线性机构下降过程PID调节的比例参数。
downKI：线性机构下降过程PID调节的积分参数。
downKD：线性机构下降过程PID调节的微分参数。
deltaCnt：该值用于特殊情况下，若电机编码器抖动较大时，启用该参数可以解决电机数据判断为非静止的状态。
upDelayTime：上升延时时间。-1 表示使用编码器作为反馈，0 表示使用协议 DI 做反馈，正值表示使用定时时间作为反馈。
downDelayTime：下降延时时间。-1 表示使用编码器作为反馈，0 表示使用协议 DI 做反馈，正值表示使用定时时间作为反馈。
upViscousSpeed：上升粘性速度，货叉手动标定得到的值。
upSpeedBias：上升速度偏差，货叉手动标定得到的值。
## rotation转盘电机

## 场景：
① 电机可无限旋转，在目标位置没有到位光电，需要指定运转到某个角度值；
② 电机有限旋转，需要指定运转到某个角度值。
reductionRatio：一般为电机轴（不考虑减速机构）转一圈旋转过的角度，再通过计算可以得出当前机构模块所处的实际角度位置。
calibrationVel：线性旋转机构的标零速度，上电标零时设定的标零速度。
maxAngle：线性旋转机构的最大角度。
minAngle：线性旋转机构的最小角度。
offset：线性旋转机构的零位补偿角度。
reachUpDist：上到位精度，用于衡量距离目标位置还有多远距离时停止。
reachDownDist：下到位精度，用于衡量距离目标位置还有多远距离时停止。
maxSpeed：最大速度。
maxAcc：最大加速度。
maxDec：最大减速度。
maxJerk：最大加加速度。
minUpSpeed：最小上升速度，0 表示不启用，使用上升 PID 调节。
minDownSpeed：最小下降速度，0 表示不启用最小速度，使用下降 PID 调节。
deltaCnt：该值用于特殊情况下，若电机编码器抖动较大时，启用该参数可以解决电机数据判断为非静止的状态。
## canPort：驱动器使用的端口号
## outEncoder
outEncoderID：编码器内部配置的 can 节点 id 。
outEncoderRatio：外置编码器的传动比参数，根据外置编码器的安装机械结构的传动关系进行填写，如绝对值编码器轴转一圈是机构的高度差为多少 mm 。
### outEncoderFactor：外置编码器系数
outEncoderLine：外置编码器的编码器线数，根据实际安装的品牌和型号填写外置编码器的编码器线数，如绝对值编码器轴转一圈读取到的脉冲数差值 / 4 。
outEncoderPort：安装时选择的 can 总线序号。
## resetMode 标零方式
如果不需要标零相应的电机选择none。
 resetBySpeed ：通过速度的方式标零。如果使用的是顶升旋转车体，请将需要标零的jack和spin电机选择为 resetBySpeed。
 resetbyDriver：通过驱动器的方式标零。如果使用的是单舵轮或者双舵轮车体，请将steer电机选择为 resetbyDriver ；行走电机保持none。
## motorDI 线性机构到位方式
## upReached ：上到位
## downReached ：下到位

## 示例
顶升车执行 JackLoad 动作时，会默认将顶升电机，抬升到顶升电机的最大高度maxLength。如果顶升电机的motorDI配置有upReached，那么顶升电机抬升过程中到达maxLength或者upReached触发都认为到位。
顶升车执行 JackUnload 动作时，会默认将顶升电机，下降到顶升电机的最小高度minLength。如果顶升电机的minLength为0，并且配置有zeroDI，那么顶升电机下降到 0 位时，必须要配置zeroDI ， 否则继续执行下降动作。如果顶升电机的minLength不为0，并且配置有downReached ，那么顶升电机下降过程中到达minLength或者downReached触发都认为到位。
## brand
驱动器品牌，根据实际情况进行勾选，下拉框中是我们目前支持的驱动器品牌。
## outEncoderBrand
外置编码器品牌，根据实际情况填写。
## 人机交互类
## Indicator
## image.png

## type
## buzzer 蜂鸣器
## triColorLight 三色灯
redLightDO：红色灯 DO 序号，-1 代表不启用。
redLightFreq：红色灯闪烁间隔时间，最大为 60s，单位：s。
redLightExceptEMC：红色灯输出是否排除拍下急停情况。
redLightExceptBatteryLowWarn：红色灯输出是否排除电池电量warn报警。
yellowLightDO：黄色灯 DO 序号，-1 代表不启用。
yellowLightFreq：黄色灯闪烁间隔时间，最大为 60s，单位：s。
greenLightDO：绿色灯 DO 序号，-1 代表不启用。
greenLightFreq：绿色灯闪烁间隔时间，最大为 60s，单位：s。

## 三色灯状态
红灯 → 机器人出错，严重错误数量任一大于0/低电量/急停条件
## 黄灯 → 导航状态不在运行中
## 绿灯 → 导航状态在运行中
三者互斥，不存在同时亮灯的情况。
## cruiseLight 巡航灯
## directionLight 方向灯
## led 灯带

## image.png

## image.png

## brand
### WST-SM16512PS-DMX512
scriptName：灯带脚本名称，如 dmx512_demo.py。
coloRed：指红色的参数设置，范围 (0,255)。
colorGreen：指绿色的参数设置，范围 (0,255)。
colorBlue：指蓝色的参数设置，范围 (0,255)。
colorWhite：指白色的参数设置，范围 (0,255)。
showCharging：指是否显示充电效果，勾选则为显示充电效果，不勾选则为不显示。
showBattery：指是否显示电池效果，勾选则为显示电池效果，不勾选则为不显示。
turnLeftFrontPos：是指左前转向灯组序号 (6 灯珠/组），根据实际使用情况和需求进行配置。
turnLeftFrontNum：指左前转向灯组数量 (6 灯珠/组）。
turnLeftRearPos：指左后转向灯组序号 (6 灯珠/组），根据实际使用情况和需求进行配置。
turnLeftRearNum：指左后转向灯组数量 (6 灯珠/组）。
turnRightFrontPos：指右前转向灯组序号 (6 灯珠/组），根据实际使用情况和需求进行配置。
turnLeftRearNum：指右前转向灯组数量 (6 灯珠/组）。
turnRightRearPos：指右后转向灯组序号 (6 灯珠/组），根据实际使用情况和需求进行配置。
turnRightRearNum：指右后转向灯组数量 (6 灯珠/组）。
lightTotalNum：指灯珠组数量 (6 灯珠/组），请根据实际使用情况和需求进行配置。
isBackBreath：倒退是否白色呼吸。
redChannel：红色灯带通道。（默认通道顺序RWGB：参数配置依次为0、2、3、1）
greenChannel：绿色灯带通道。（默认通道顺序RWGB：参数配置依次为0、2、3、1）
blueChannel：蓝色灯带通道。（默认通道顺序RWGB：参数配置依次为0、2、3、1）
whiteChannel：白色灯带通道。（默认通道顺序RWGB：参数配置依次为0、2、3、1）
## byScriptsControl
scriptName：灯带脚本名称，如 dmx512_demo.py。
## soundplayer 音频
模型文件 soundplayer 控制 agv 在不同状态播放相应音频。
相应的状态有： 开始执行任务、倒车、遇到障碍物、原地旋转、低电池电量、阻挡、错误来控制。

## image.png

## image.png

## basic
navigation：导航时音频的文件名。（去除.wav后缀，以下均是）
naviAheadTime：导航前的音频时长，默认为 0 。
navigationLoop：导航时音频是否循环播放。
astern：倒走时音频的文件名。
turnleft：左转时音频的文件名。
turnright：右转时音频的文件名。
moveleft：左移时运行的音乐文件名。
moveright：右移时运行的音乐文件名。
moveAngleThreshold： 左移/右移行为判断阈值，即超过这个角度才判定为左移/右移行为。
block：阻挡时音频的文件名。
lowBattery：低电量时音频的文件名。
error：报错时音频的文件名。
collision：发生碰撞时音频的文件名。
openSound：是否开启音乐播放。
useErrorCode：是否依据错误码播放错误音频。
勾选，则报对应错误码的特殊音频（前提是音频管理器中上传了以错误码命名的音频，如52101.wav）；
## image.png

不勾选，则播放默认的报错音频。
actionAutoPlaySound：是否仅在动作中播放音频。
## Manipulators 手操器
控制叉车前进、后退、舵角调整、上升、下降是通过 3 个电位器接到改造后的驱动器上面，驱动器根据信号的输入来控制对应叉车的动作。
## image.png

canPort：手操器所连接在哪一路 can 通讯端口，按照实际 can 接线来配置。
brand：根据品牌型号选择。
canHandleBrand：根据品牌型号选择。
## 应用
配置l两个Trigger来触发手自动模式切换（如 手自动开关接的是 DI0）。
## image.png
### DI0，上升沿触发，自动模式切换为手动模式

## image.png
### DI0，下降沿触发，手动模式切换为自动模式

## 特殊功能类
### container 容器(带多储位机器人用,例如料箱车)
container 是机器人存放货物的地方，它决定了机器人可以同时取多少货物，如果一个机器人有 3 个背篓，那么它的 container 数量为 3，最多可以同时取 3 件货物。
container 只针对料箱机器人的背篓 参数 (需要RBK3.3.5.9+)以上的RBK版本。
## image.png

设备名：机器人背篓名称。如果机器人有多个背篓，并且其中一个背篓名称为 999，那么在调度控制下机器人执行拼合单时，会优先放 999 背篓里面的货物。(注：container999 代表机器人的自身背篓)

### container 对应机器人的 1 层背篓
### container1 对应机器人的 2 层背篓
### container2 对应机器人的 3 层背篓
### modbusArm（手臂式复合机器人使用）
## image.png

## basic
ip：机械臂 ip。
port：modbus 通信端口。
slaveId：modbus 通信从站 id。
## actions
### 01 Read Coils(0x) 和 02 Read Discrete Inputs(1x)
## image.png

coilsNumber/discreteInputsNumber：地址位，从0开始。
errorMsg：错误信息，通过报错误反馈。
trueValueIsError：当勾选此配置，小车线圈值为1时会认为是错误状态；当取消勾选时，线圈值为0代表错误状态。错误状态时会有报错码。
### 03 Read Holding Registers(4x) 和 04 Read Input Registers(3x)
如下图所示，读取保持寄存器和读取输入寄存器都有相同的三个配置参数：
1665211469522-2a35327d-cef1-4923-9b3c-84902a88ec95.jpeg

holdingRegistersNumber/inputRegistersNumber ：地址位，从0开始。
errorMsg ：错误信息，通过报错误反馈。
value ：当读到寄存器为此值时代表错误状态，错误状态时会有报错码
## Write error
## image.png

当小车存在配置的错误码时，会向指定保持寄存器写入该错误码的值。
holdingRegistersNumber : 地址位，从0开始。
errorCode ：小车错误码；当小车出现配置错误码，会向holdingRegistersNumber地址位写入该错误码。
## Write lock
## image.png

### 小车控制权状态：0=无人获取控制权，1=有人获取控制权
holdingRegistersNumber : 地址位，从0开始。
## Write task status
## image.png

小车导航状态，可以参考 查询导航状态中的task_status字段
holdingRegistersNumber : 地址位，从0开始。
## periodRun
配置 periodRun，机器人会周期性的调用脚本的 periodRun 方法。简言之，如果要实现时刻运行机器人脚本，就可以在模型文件配置 periodRun，并在脚本实现 periodRun 的具体内容。
## image.png

scriptName：脚本名称。

注意：periodRun 方法不能阻塞，若阻塞rbk会报错重启等。
阻塞，简言之，是不能再 periodRun 中添加任何延时的函数或者机制。time 模块的功能都不要使用。
