# 雷赛LD2驱动器 张亚男

## 雷赛LD2驱动器 张亚男

## 版本

## 更新日期

## 更新说明

## 文档状态

## 维护责任人

## V1.0

### 2024.4.29

## 语雀迁移至飞书

## 使用中

## 说明

本文档针对机器人自动化改造过程进行规范，使公司产品符合行业标准，保证产品质量稳定，使技术人员在进行改造过程中有章可循。

机器人自动化改造涉及传感器众多，建议采用我司标准核心控制器线束TE23,TE35,本文档以核心控制器标准线束为蓝本进行作业指导。

注：本文档只适用于改造参考，不可作为技术协议及其他承担责任的内容。

## 一、适用范围

本技术规范适用于公司使用雷赛LD2系列驱动器canopen通讯驱动器进行自动化改造的研发、生产、调试的技术人员。
### 二、调试资源

## 驱动器手册：
## 注 :
在使用驱动器前请仔细阅读驱动器的使用手册，尤其是各种接插件定义，使用注意事项等。

LD2-CAN系列(7030,7020,7015,7010,7007,7005)V1_5 (1).pdf

## 调试软件：

### MotionStudio_v1.4.5 (1).zip

以上链接有可能因为雷赛网站的更新而变化，如有这种情况，请直接访问雷赛官网的主页。
## 雷赛官网链接： 雷赛官网
### 三、电气接线
### 驱动器的接线方法请参考 控制器和驱动器接线方法
这里以 LD2-CAN7010B 为例展示一下雷赛驱动器的各种接口的布局和定义，其他型号请查看驱动器手册。
### 3.1 雷赛驱动器命名规则及外观图

1709617790359-add1a435-8d3b-4730-bf0f-fcf5736749d5.png

## 图3.1.1
1709617855119-e3846b0e-4cc3-4bb5-b7df-8b54c61fac2d.png

## 图3.1.2

1709630949651-45597a0e-d500-4975-944f-2b15a6654086.png

## 图3.1.3

## 【注】
## 1、CAN总线产品无脉冲、模拟量接口。抱闸直接输出根据型号不同选配（参考命名规则）。
### 2、4路输入口DI3~DI6，支持NPN和PNP，推荐外部输入信号控制电源12~24V。
### 3、电缆长度尽可能短，控制CN1电缆不超过3米，反馈信号CN2电缆长度不超过10米。差分信号一定要使用双绞线，且有屏蔽层。
4、2路单端输出口DO1~DO2，最大驱动电流100mA,支持NPN和PNP兼容，推荐外部电源24VDC。如果负载是继电器等电感性负载，必须在负载两端反并联续流二极管；如果续流二极管反接，可能会损坏驱动器。
### 5、请尽量安排非熔断型（NFB）断路器使驱动器故障时能及时切断外部电源。

### 3.2 雷赛通讯总线定义
## CN6：CAN通讯接口定义
## 用于和控制器通讯
1709632010221-2380771f-bde6-4ca6-9672-1e207143bb6a.png

## 图3.2.1

## 【注】
## 1、各节点间的连线越短越好，最长建议不超过 3m
### 2、CAN 通信线建议使用屏蔽双绞线
### 3、连接驱动器的 CAN 通信电路参考地 GND
### 4、使用屏蔽线时屏蔽层两端调试接 PE，不能接 GND，否则会损坏端口
### 5、CAN 总线需要与其它干扰线缆分开布置
### 6、 主站端 和 最后一个从站端 需要接 120 欧姆的终端电阻，驱动器内置，可通过SW3启用

## 拨码开关

1709880694751-11201d98-6a96-4f31-b87f-ff00e3c1d02d.png 

1709880484694-a19cbacf-9a26-4615-a442-f49b5a0ec3e8.png

## 表3.2.1
## SW3：CAN终端电阻
SW3=off 时，CAN 总线断开终端电阻。 SW3=on 时，CAN 总线接上终端电阻。
## SW4：CAN地址高位选择
SW4=off 时，高位为 0。 SW4=on 时，高位为 1。

## CN5：RS232调试接口定义
### 用于接电脑上位机软件对驱动器进行配置及固件升级
1709632250919-21aca9b5-7659-4f36-b600-b3c8095ab782.png

## 图3.2.2

### 3.3 输入输出接口定义
1709881116882-9ea0be49-b97d-4e9f-910c-0da7e9d94975.png

1709881141253-da2000b2-4a2d-4b2c-8b91-3308eb63df0d.png

## 图 3.3.1

## I/O接口原理
1709881358616-0aad08a6-c415-4f5d-b8ae-89f12e88fca3.png

## 图3.3.2
急停 ：高电平触发，DI3接GND，COM_IN 接 +24V，则急停输入有效

## image.png

### 3.4 驱动器抱闸如何接线
## 根据驱动器手册的抱闸接法，如下图
1709881686747-b38323a1-4154-4101-b412-2846a0fceb6b.png

## 图 3.4.1

### 3.5 电机动力绕组线连接

## 接口定义
1709881821366-2420d114-e7b0-4270-8e7d-d17fac4f4df3.png

## 图 3.5.1

## 根据驱动器手册接法连接，如下图：
1709881965883-fa10e67c-0228-4306-b1a3-0bddb1da0672.png

### 3.6 编码器端子连接

## 接口定义
1709882067231-4bf76dfa-32b4-4915-b5c1-5fc666812b39.png

## 图 3.6.1

## 根据驱动器手册接法连接，如下图：
1709882128288-ea794f7a-6dcb-4a53-ae37-b4ce84c9ae77.png

## 图 3.6.2

### 3.7 能耗端子

## 接口定义
1709882286022-73952e70-18d0-45db-a6b5-13f3fdd0e307.png

## 图 3.7.3

### 3.8 旋码开关

## 接口定义
1709882356167-e7c98532-5358-438c-a257-9e25c4126fba.png

## 图 3.8.1

### 四、 驱动器参数配置 行走 （速度模式）

### 4.1 上位机配置

### 4.1.1 连接：

## LD2-CAN系列调试软件.zip
### 通过USB_232连接，选择正确的通信端口
## image.png

### 4.2 设备地址（canID）

### 以拨码开关为准，如果需要软件配置，拨码开关打到off档
## image.png

### 4.3 看门狗配置

## image.png

## 保存厂商参数

## image.png

## 下载参数

## image.png

### 4.4 关闭PDO，RPDO，TPDO都关掉

## image.png

### 4.5 静止下蠕动问题
1689762631176-6b1ce2f8-c0aa-4a03-a2b3-ed143e7f9080.png

### 无如下参数，可以在功能那选下管理员，密码5521
1692063969321-da7bfc6f-eb63-4fc0-8dcf-14411f8f74a8.png

以上所有参数，重上电后生效，重上电后再次检查参数是否修改成功

### 五、 驱动器参数配置 舵轮（位置模式）

## 更新绝对位置模式固件

LeadshineFirmwareLoader_v3.2.0_LD2_CAN_20230407.zip

## 打开上位机软件

观察上面显示接口是否为正确的接口，烧录文件会自行选择目录；的然后电机烧录

1681293857297-6ef5d561-7a9e-461b-856f-1ec9a53740cd.png

### 等待烧录成功，断电重启驱动器 （固件烧录过程中不要断电）

1681293909061-1633c9c5-2ab0-410f-97fe-47c56bd478e7.png

### 5.1 上位机配置

### 5.1.1 连接：

## LD2-CAN系列调试软件 .zip

### 通过USB_232连接，选择正确的通信端口

## image.png

### 5.2 设备地址（canID）

### 以拨码开关为准，如果需要软件配置，拨码开关打到off档
## image.png

### 5.3 看门狗配置

## 心跳时间设置为600ms
## image.png

### 5.4 回零模式配置

### 设置回零模式为17负限位回零（6098）
### 设置回零速度为20000（6099 01）

1680252232418-1f058970-2bdf-433f-90a0-9761d54bb9bd.png

## 设置位置模式加速度与速度

1681210181664-f7cb7b19-3936-4a1f-bca2-65b2f3f90996.png

### 5.5 限位与急停开关
第一步判断限位开关的线序，一般传感器的线序为：棕正，蓝负，黑信号。 此处线序需要向厂家确认。
第二步判断舵机的限位开关是 NPN 还是 PNP。下面提到不同类型传感器的两种接法：
若是 NPN 型（低电平触发） ：将所有驱动器的 COMI 并联后接入 DCDC 24V+ 输出；将所有驱动器 IN3并联后连接 SRC2000 急停输出 1+(TE35 4 号线），将另一根急停输出 1-（TE35 5 号线）连接 DCDC 24V- 输出；
若是 PNP 型（高电平触发） ：将所有驱动器的 COMI 并联后接入DCDC 24V- 输出；将所有驱动器 IN3 并联后连接 SRC2000 急停输出 1+(TE35 4 号线），将另一根急停输出 1-（TE35 5 号线）连接 DCDC 24V+ 输出。
限位开关 ，使用负限位标零限，接入 IN6 ， 并按照图中配置IN6为负限位，IN3为急停功能
1681361412931-f91e7b7a-b0a2-45f3-af4e-86f78137fc0e.png

## 保存厂商参数

## image.png

## 下载参数

## image.png

### 5.6 关闭PDO，RPDO，TPDO都关掉

## image.png

以上所有参数，重上电后生效，重上电后再次检查参数是否修改成功

### 六、驱动器功能检测方法
在整车组装完成未安装外壳前，请再检查一遍接线确保接线正确；
将车体加高，使轮子离地。开启机器人，使用网线连接机器人。使用 Roboshop 软件操作机器人让轮子转起来。 使用 CanScope 夹在 CAN 总线上检测 CAN 报文至少 1 小时，CAN 报文无错误；
让车体着地，使用 Roboshop 软件操作机器人做运动动作:向前，向后，向左，向右运动；
未拍急停按钮前，推动机器人，无法推动（电机使能），检查 Roboshop 中机器人状态处于“未急停”“驱动器未急停”，如图 6.1 左侧图所示；所示拍下急停按钮后，再次机器人，可以推动（电机去使能），检查 Roboshop 中机器人状态处于“已急停”，“驱动器已急停”。如图 6.1 右侧图所示；
1677663188481-0a751fbe-e933-459f-baf7-bff708003d7e.png 

## 图 6.1
任务链运动老化测试 24H ，查看 Robokit Log 无错误报警。
### 七、附录

### 7.1通讯线序

## 1. 232通讯线序

1680252613370-afeffe44-3507-4ddd-9e1e-9633f489b259.png

### 2. can通讯线序

1680252636558-bbcc2520-851a-4706-96d1-c06a01414aa2.png

### 7.2 驱动器常见错误码

### 根据roboshop上对应的报错码，在表格中找到对应报错

1680252781262-cf49b9c9-f685-491e-b286-9c9e93ab1e0c.png

1680252798181-1184e994-e028-4c8f-a888-1ede5f8263ee.png

1680252812690-f3105a58-8706-4c01-a1ca-76dfe2f79e41.png

1680252828932-4991f682-2a5f-4074-880a-d5c6b572eeb4.png

1680252846463-3a37c894-0fdf-4c1d-96eb-6462516c61b1.png

1680252859043-e146cf66-08c1-4c0b-8dc4-523145de2878.png

1680252874263-1078430e-24ad-479c-ae1b-7d7865e465a0.png

1680252884724-4bc84829-912f-4d2c-b2c6-f781d7841b12.png
