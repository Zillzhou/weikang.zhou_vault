# 雷赛LD5驱动器 张亚男

## 雷赛LD5驱动器 张亚男

## 版本

## 更新日期

## 更新说明

## 文档状态

## 维护责任人

## V1.0

### 2024.4.29

## 语雀迁移至飞书

## 使用中

## 说明

本文档针对机器人自动化改造过程进行规范，使公司产品符合行业标准，保证产品质量稳定，使技术人员在进行改造过程中有章可循。

机器人自动化改造涉及传感器众多，建议采用我司标准核心控制器线束TE23,TE35,本文档以核心控制器标准线束为蓝本进行作业指导。

注：本文档只适用于改造参考，不可作为技术协议及其他承担责任的内容

## 一、适用范围

本技术规范适用于公司使用雷赛LD5系列驱动器canopen通讯驱动器进行自动化改造的研发、生产、调试的技术人员。
### 二、调试资源

## 驱动器手册：
## 注 :
在使用驱动器前请仔细阅读驱动器的使用手册，尤其是各种接插件定义，使用注意事项等。

LD2-CAN系列(7030,7020,7015,7010,7007,7005)V1_5 .pdf
## 调试软件：

### L6-ACHSeries_setup.rar

以上链接有可能因为雷赛网站的更新而变化，如有这种情况，请直接访问雷赛官网的主页。
## 雷赛官网链接： 雷赛官网

### 三、电气接线
### 驱动器的接线方法请参考 控制器和驱动器接线方法
这里以 LD5-400-CAN 为例展示一下雷赛驱动器的各种接口的布局和定义，其他型号请查看驱动器手册。

### 3.1 雷赛驱动器命名规则及外观图
1710230022726-18ada4e7-6105-45a7-96e7-3bc0512bb6c3.png

## 图3.1.1

1710230045143-209301b3-82a5-452f-aae2-42acc56e3608.png

## 图3.1.2

1710230141423-27b7e0da-5727-4be2-bea3-561158be2f0b.png

## 图3.1.3
## 【注】
## 1、 脉冲和方向接口为5V信号。
### 2、用户提供控制电源，DC12～24V，电流≥100mA,如果电源极性接反，驱动器将不能正常工作。
### 3、电缆长度尽可能短，控制CN1电缆不超过3米，反馈信号CN2电缆长度不超过10米。差分信号一定要使用双绞线，且有屏蔽层。
4、输出为集电极开路形式，最大电流50mA，外部电源最大电源25V。如果负载是继电器等电感性负载，必须在负载两端反并联续流二极管；如果续流二极管反接，可能会损坏驱动器。
### 5、请尽量安排非熔断型（NFB）断路器使驱动器故障时能及时切断外部电源。

### 3.2 雷赛驱动器各端子功能

## 控制信号端口-CN1 端子
1710230267119-944283ef-ce34-477b-88b2-b1efdd2ce0b9.png

1710230284471-38d21510-e0fb-45a8-bd1e-aea2f7df54e7.png

## 图 3.2.1

## 编码器输入端口-CN2 端子
1710230329131-d4119c7c-a421-4679-b8f6-e07e5adcf86d.png

## 图 3.2.2

## 通讯端口
1710230361258-43f8a915-b6e5-408d-b7cf-04ea4088785b.png

## 图 3.2.3

## 功率端口
1710230402209-af9fbe5d-120f-4dac-8963-f725693f8103.png

## 图 3.2.4

## CAN 通讯端子
1710230448260-105ab372-be43-4703-b848-32d35e2a9c95.png

## 图 3.2.5

### 3.3 I/O 接口原理

## 开关量输入接口
1710228350753-95e04c4b-ccfa-4c50-b39b-f99a6af69eb8.png

## 图 3.3.1

## 开关量输出接口
1710228414996-ff04ef48-fecd-471d-b9b4-267b192ea92a.png

## 图 3.3.2

## 脉冲量输入接口的差分驱动方式
1710228486388-6fcbe24c-9303-46dc-96cb-d426c0637f6b.png

## 图 3.3.3

## 脉冲量输入接口的单端驱动方式
1710228528899-01c75c44-2833-411a-9922-431927d19603.png

## 图 3.3.4

## 模拟量输入接口
1710228604905-1279699b-25e3-48a0-90ea-dadd688a1331.png

## 图 3.3.5

### 四、驱动器参数配置

### 4.1 上位机配置
## 1.下载并安装 雷赛专用调试软件：

## 雷赛电机及驱动器资料.rar

### 2.建议使用 RS232 通讯方式，实现调试电脑与驱动器的通讯。建议使用 USB-232 转换器，使用雷赛专用线束，如图所示；

## image.png

### 3.使用上位机软件连接雷赛驱动器，打开 LD5，点击查找设备
## image.png

### 4.显示找到设备，点击连接，后出现的对话框点击确定

## image.png

### 5.上面的状态栏出现这种情况的时候，表明已经连接正常

## image.png

### 6.选择参数存储管理，将控制模式改成1，速度模式，进行试运行测试

### 【参照文档 LD5-400-CAN- 驱动器说明中的配置】
## image.png

## 修改完成之后，点击下发参数
## image.png

### 7.试运行测试结果如下，设置梯形参数，点击开始按钮，出现如图的曲线

## image.png

### 8.将重新将控制模式改成 8（CANopen 模式）进行实验，点击保存
## image.png

### 9.运行第二台驱动器驱动电机，同样的参数配置进行试运行，发现曲线稍微有些不一样，没有第一台电机曲线效果好

## image.png

### 10.同样按照第 6 步，将第二台驱动器修改回 canopen 之后进行保存，将驱动器重新上电将驱动器配置完成之后，就要按照 canopen 的协议，形成代码

### 11.打开 roboshop 进行配置电机，尝试使用 canopen 协议中的内容，能不能将电机动起来配置的相关的内容包括，can 口，波特率，电机的品牌。

### 4.2 通过按键设置驱动器的参数
参照文档《LD5-400-CAN- 驱动器说明书》按键步骤：

## image.png

## （1） 面板显示点击 ENT

## image.png

## image.png

## image.png

## （2）参数若不是 1，设置成 1

## image.png

（3）设置从站号设置 PA000 设置为 4（注意此处要和模型文件相匹配）

 设置波特率，将 PA-000 设置成 3（250K），表格如下

设置 nodeID 号，将 PA-001 设置成 nodeID 号

### 参数设定模式—》PA_638—》修改参数值为 0

## image.png

## image.png

## image.png

## 若不为 0，设置成 0

## image.png

## （4）EEPROM 写入模式

## image.png

## image.png

## image.png

## image.png

## （5）重启驱动器

## 1.用 USBcan 打开驱动器的设备，帧 ID 选择 0x603 和 0x604，主要原因是设备是 3 和 4

## 依次发送 can 数据【手动发送数据】

## 帧ID 0x000  80 05

帧ID 0x603  2b 17 10 00 64 00 00 00 【将64写到1017】

帧ID 0x603  23 10 10 01 73 61 76 65 【保存配置】

## 帧ID 0x000  01 00

### 同时将 can 数据发送到 4 号节点设备：

## 帧ID 0x000  80 05

帧ID 0x604  2b 17 10 00 64 00 00 00 【将64写到1017】

帧ID 0x604  23 10 10 01 73 61 76 65 【保存配置】

## 帧ID 0x000  01 00

### 4.3 静止下蠕动问题

1689762820340-41091141-f60f-4576-8b28-0256d4bb09dc.png 

### 无如下参数，可以在功能那选下管理员，密码5521
1692253967901-d17aec4b-df72-4a7b-b6a8-0a39413ddccf.png

### 五、机器人模型配置说明

### 根据电机及减速实际情况配置行走电机参数：

注：这些参数需根据驱动器及选用电机及减速机的实际进行填写；

## image.png

## 图 5.1.1

## 【注】
减速比、编码器线数、电机最大转速、驱动器品牌需要根据选用的实际填写。

### 六、驱动器功能检测方法
在整车组装完成未安装外壳前，请再检查一遍接线确保接线正确；
将车体加高，使轮子离地。开启机器人，使用网线连接机器人。使用 Roboshop 软件操作机器人让轮子转起来。 使用 CanScope 夹在 CAN 总线上检测 CAN 报文至少 1 小时，CAN 报文无错误；
让车体着地，使用 Roboshop 软件操作机器人做运动动作:向前，向后，向左，向右运动；
未拍急停按钮前，推动机器人，无法推动（电机使能），检查 Roboshop 中机器人状态处于“未急停”“驱动器未急停”，如图 6.1 左侧图所示；所示拍下急停按钮后，再次机器人，可以推动（电机去使能），检查 Roboshop 中机器人状态处于“已急停”，“驱动器已急停”。如图 6.1 右侧图所示；
1677663188481-0a751fbe-e933-459f-baf7-bff708003d7e.png 

## 图 6.1
任务链运动老化测试 24H ，查看 Robokit Log 无错误报警。
。

### 七、附录

### 7.1 致远 CAN Scope 使用方法

## 1.软件安装--安装 CAN Scope 配套软件 CANScope。（软件及使用手册请联系致远厂商售后）

2.硬件连接--参考 CAN Scope 使用手册接好电源，USB 调试线，插上 CAN Port 板,将 CAN_H 接到 SRC2000 外接线束 TE35 33 号线上，将 CAN_L 接到 SRC2000 外接线束 TE35 32 号线上 USB 调试线插在电脑上。

3.打开软件 CANScope，选择【Port 板】，取消【启用终端电阻】，选择【报文】，配置【波特率】为 250Kbps,取消【总线应答】，选择【开启】，CAN 报文实时如图 7.1.1 所示。

## image.png

## 图 7.1.1

### 4.选择【状态】【错误】，检查是否有错误报文。如图 7.1.2 所示。

## image.png

## 图 7.1.2

### 7.2 USB CAN 卡使用方法

## 1.软件安装—安装软件 USB_CAN Tool（软件及使用手册请联系 CAN 卡厂商售后）。

2.硬件连接—准备 USB CAN 卡和连接线，将连接线 CAN_H 接到 SRC2000 外接线束 TE35 33 号线上，将连接线 CAN_L 接到 SRC2000 外接线束 TE35 32 号线上。如图 7.2.1 所示：

## image.png

## 图 7.2.1

3.打开 USB CAN tool ,选择【设备操作（O）】【启动设备（S）】,确认 CAN 参数，【波特率】为 250Kbps,选择【CAN 通道号】为通道 1,点击【确认】。如图 7.2.2 所示：

## image.png

## 图 7.2.2

### 4.选择【显示（V）】，取消选择【合并相同 ID 数据(M)】，CAN 报文如图 7.2.3 所示。

## image.png

## 图 7.2.3

### 7.3 udpconsole 使用方法

udpConsole 是我司工程师用于调试 bug 开发的小工具，可以检查到固件上报的错误信息。

## 1.打开 udpconsole 工具前需用网线确保电脑与机器人的物理连接。

### 2.打开 udpconsole 进行驱动器功能测试，时刻检查 udpconsole 显示内容。

### 驱动器通讯过程中出现错误帧如图 7.3.1 所示：

## image.png

## 图 7.3.1

### 八、Roboshop 报错码解析

## image.png

## image.png

## 举例：

Roboshop 显示电机错误码为 0x6100，只取二进制的低 12 位作为报警代码，与面板显示的一致，比如读到 0x6100,只取 0x100，就是报警 Er100，即主码加辅码，10 0, 驱动器过载
