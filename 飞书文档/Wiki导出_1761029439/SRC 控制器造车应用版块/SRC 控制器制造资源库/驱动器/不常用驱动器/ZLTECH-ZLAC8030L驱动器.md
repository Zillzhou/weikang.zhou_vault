# ZLTECH-ZLAC8030L驱动器

## ZLTECH-ZLAC8030L驱动器

## 版本

## 更新日期

## 更新说明

## 文档状态

## 维护责任人

## V1.0

### 2024.4.29

## 语雀迁移飞书

## 使用中

## 一、适用范围

本文档针对机器人改造过程进行规范，使公司产品符合行业标准，保证产品质量稳定，使技术人员在进行改造过程中有章可循。

机器人自动化改造涉及传感器众多，建议采用我司标准核心控制器线束 TE23、TE35，本文档以核心控制器标准线束为蓝本进行作业指导。
### 二、调试资源
## USB-485 转换器

1652601140296-18195c39-0520-422c-9ecc-cbb949496758.png

## 驱动器相关手册：

ZLAC8030L CANopen通信例程Version 1.00.pdf

ZLAC8030L 伺服轮毂驱动器用户手册Version 1.00.pdf
## 驱动器配置软件：

## ZLTECH上位机软件及驱动.zip
### 三、改造和安装

### 3. 进行改造（底盘驱动器部分）

### 3.1.1 行走电机驱动器安装方式

## 1.驱动器需要与车体进行可靠固定，检查驱动器与对应电机的三相线（ 黄U 绿V 蓝W ）、编码器线路连接正确；
2.当机器人安装有多个驱动器(数量 ≥2)时，所有从站的 CAN_L,CAN_H 引脚直接相连即可，尽量采用串联方式接线，如图 3.1.1 所示；若驱动器仅提供一个通讯接口，无法完成驱动器的 can 线串联时，则将所有驱动器 can 线引出后把所有 can_H 压入同一德驰插筒连接器，将所有 can_L 压入同一德驰插筒连接器，接入德驰 DT06-2S 公头，最后与 TE28 中的 22、23 号线（SRC800V3 can2)相连,（ SRC800版本不同，can接口不同，需根据SRC800版本来进行接线 ）

由于部分驱动器没有提供级联接口，只能通过从总线上接引线的的方式来串联，这里引线的长度需小于 10CM.

注：在改造过程中若由于驱动器连接所需要的线束数量不足，无法实现在驱动器端进行快速串联，可采用图 3.1.2所示连接方式，但不推荐。
## image.png

## 图 3.1.1  图3.1.2

为保证 can 通讯质量，需要在距离核心控制器最远的驱动器上或总线末端安装终端电阻（阻值一般是 120ohm).（注：客户可在购买驱动器时向驱动器厂商提出购买配套终端电阻）

### 3.CAN 终端电阻是否正确打开的检测方法：

关机断电，断开驱动器和控制器的 CAN 连接线（如图 4.4.1 中 Driver4 和控制器之间的位置），使用万用表电阻档测量驱动器侧的 CAN 总线上 CAN_L、CAN_H 之间电阻，电阻值为 120Ω 则正确，如图 4.4.3 所示。电阻值明显小于120Ω（如 60Ω),则说明至少有两个驱动器打开的终端电阻。

断开图 4.4.1 中 Driver1 和 Driver2 之间的连接线，使用万用表电阻档测量 Driver1 侧的 CAN 总线上 CAN_L、CAN_H 之间电阻，电阻值为 120Ω 则正确，如图 4.4.3 所示。如果电阻值明显大于 120Ω（如几 KΩ),则说明终端电阻打开的位置不在 CAN 总线末端，需要调整。

## image.png

## 图3.4.3
### 4.急停
将所有驱动器的 J4 - INPUT1口 分别接入驱动 J3 - 5V ；将所有驱动器 J4-ICOM口 并联后连 SRC2000急停输1+ （TE354 号线），将另一根 急停输出1- （TE355 号线）连接 驱动器 J3-GND口

1662695806384-e91003da-de8e-4f82-9d4e-764b7d10f970.png

### 四、驱动器参数配置
## 工具：
## USB-485 转换器
## image.png

## 1.使用 USB-485 转换器连接电脑和驱动器
1657694378057-0e77c8f5-afde-4409-baee-0c7901620fe8.png 

1657694398221-de40ec5f-51b8-4500-a4e2-6c917f5ab363.png

### 2.由于急停功能需要更新驱动器固件，打开驱动器固件升级软件

### ZLAC-SERVO-BIN-V2.0.zip
1662701133099-a93ea0b9-5d1a-4420-862d-3583afcd9b9d.png

## 固件信息（请解压为BIN文件后使用）：

80300000-V1-0-20K-22302-NewAPP-20227029.zip
按照操作文档进行固件升级操作（ 升级失败或者不顺利找供应商协助升级 ）

ZLAC-SERVO-BIN-V2.0固件更新说明.docx

### 3.打开驱动器配置软件，正确选择端口号，点击打开串口
1657694676470-7bff8e09-b4c4-4203-96c8-8a8ffa243687.png 

1657694687438-d20672b1-d821-46a8-88c4-cbadcb809e95.png

### 4.按照使用需求修改驱动器 ID 和波特率，工作模式选择速度控制模式，更改参数后，将参数写入驱动器
1657694878986-1fb70777-7141-44ed-816d-529efed16488.png

### 5.修改参数后给 驱动器重上电 参数生效
### 6. 驱动器终端电阻必须接上 ，否则 can 无法通讯
7.设置驱动器与控制器通讯掉线保护时间；将usb can盒和中菱驱动器连接（驱动器接头1是CAN_H,3是CAN_L），按照之前在上位机设置的can波特率进行连接（如果没有修改过中菱驱动器的配置，则中菱驱动器的默认波特率为500kbps） 注意：usb can盒的can通路需要有120欧的电阻
## image.png

1657695476778-2baab514-845f-47a3-bc8c-64f0e3262ca5.png

1657695445851-6044fdc4-af9e-4e12-bd82-e00e991e67c0.png

8.将usb can盒连接好后，按照驱动器Id号填写帧ID(例：驱动器ID设置为4，则帧ID为 00 00 60 04 ），发送通讯掉线时间至2000h(通常情况设置为200ms，所以发送报文信息为 2B 00 20 00 C8 00 00 00 ， 注C8为设置的时间转换为16进制 ），此时驱动器回复60 00 20 00 00 00 00 00，则代表设置成功

1657696191555-9cee7b74-e9dc-4dbb-80fc-6a1029c8784c.png

9.将input1口急停方式修改为急停后去使能状态，按照驱动器Id号填写帧ID(例：驱动器ID设置为4，则帧ID为 00 00 60 04 ），发送报文 2B 2F 20 03 01 00 00 00 ,接收报文为 60 2F 20 03 00 00 00 00 ,表示修改成功
1662695720045-550a3711-d5a9-474f-bcf7-2d8198da2939.png

### 10.修改成功后将驱动器断电重启

### 五、机器人模型配置说明

根据电机及减速实际情况配置行走电机参数，品牌选择ZLTECH-ZLAC8030L-CANOpen

注：这些参数需根据驱动器及选用电机及减速机的实际进行填写；

1657696546524-163cc450-d1e8-41e1-90d7-02efe23fdcc7.png

1657696523173-04835b65-2ef4-48b0-b946-9e0d02d84b56.png

注：减速比、编码器线数、电机最大转速、驱动器品牌需要根据选用的实际填写。

### 六、驱动器的功能检测

## 1.在整车组装完成未安装外壳前，请再检查一遍接线确保接线正确。

2.将车体加高，使轮子离地。开启机器人，使用网线连接机器人。使用 Roboshop 软件操作机器人让轮子转起来。 使用 CanScope 夹在 CAN 总线上检测 CAN 报文至少 1 小时，CAN 报文无错误。

### 3.让车体着地，使用 Roboshop 软件操作机器人做运动动作:向前，向后，向左，向右运动。

4.未拍急停按钮前，推动机器人，无法推动（电机使能），检查 Roboshop 中机器人状态处于“未急停”“驱动器未急停”，如图 6.1 所示；所示拍下急停按钮后，再次推动机器人，可以推动（电机使能释放），检查 Roboshop 中机器人状态处于“已急停”，“驱动器已急停”，如图 6.2 所示。

5.测试驱动器与控制器掉通讯，使用Roboshop软件操作机器人向前运动，在运动过程中拔掉驱动器与控制器连接的canH canL，此时机器人停下，机器人无法推动（电机使能）。
## image.png

## 图 6.1
## image.png

## 图 6.2

### 5.任务链运动老化测试 24H，查看 Robokit Log 无错误报警。

### 七、附录

### 7.1 USB CAN 卡使用方法

## 1.软件安装—安装软件 USB_CAN Tool（软件及使用手册请联系 CAN卡 厂商售后）.

2.硬件连接—准备 USB CAN 卡和连接线，将连接线 CAN_H 接到 SRC2000 外接线束 TE35 33 号线上，将连接线 CAN_L 接到 SRC2000 外接线束 TE35 32 号线上。如图 7.1.1 所示：
## image.png

## 图 7.1.1

3.打开 USB CAN tool ,选择【设备操作（O）】【启动设备（S）】,确认 CAN 参数，【波特率】为 250Kbps,选择【CAN通道号】为通道1,点击【确认】。如图 7.1.2 所示：
## image.png

## 图 7.1.2

### 4.选择【显示（V）】，取消选择【合并相同 ID 数据(M)】，CAN 报文如图 7.1.3 所示。
## image.png

## 图 7.1.3

### 7.2 udpconsole 使用方法

udpConsole 是我司工程师用于调试 bug 开发的小工具，可以检查到固件上报的错误信息。

## 1.打开 udpconsole 工具前需用网线确保电脑与机器人的物理连接。

### 2.打开 udpconsole 进行驱动器功能测试，时刻检查 udpconsole 显示内容。

### 驱动器通讯过程中出现错误帧如图 7.2.1 所示：
## image.png

## 图 7.2.1

### 八、驱动器常见错误码

绿色 LED 为电源指示灯，当驱动器接通电源时，该 LED 常亮；当驱动器切断电源时，该 LED 熄灭。红色 LED 为故障指示灯，当驱动器出现故障时，驱动器将停机，并提示相应故障代码。用户需软件做报警清除，故障才可为清除。
1657697087135-b3f28e27-186f-4972-acca-72992970f2cf.png 

1657793698431-02cb2e68-bd66-43f5-b7d2-d57bece6e229.png

## 举例：此电机按位读取报错，例如
## 1.0x81报错，根据表格信息参考过压的错误去分析
### 2.0x8，为过载
### 3.8080，参考电压出错

### 九、 附录

### 9.1 驱动器接线图
1657697452656-b16d62e0-a75a-463a-842a-eb8bcbbee203.png

1657697470620-153894ef-33a6-45a9-ab35-ea4ea22e5bb0.png

1657697501664-ea30d36a-4959-4301-8430-a01865cd3ef9.png

### 9.2 驱动器
1662089019988-98cdc9c8-e022-439c-a574-9f295bc21fe3.png 

1662089029703-4fdc3ef2-8ae9-46ac-b0b3-275cc19d29b0.png 

1662089038619-1f4e4752-bffc-413c-b080-fb843281e7de.png
