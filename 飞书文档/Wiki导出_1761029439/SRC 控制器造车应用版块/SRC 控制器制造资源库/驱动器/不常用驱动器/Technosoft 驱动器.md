# Technosoft 驱动器

## Technosoft 驱动器

## 版本

## 更新日期

## 更新说明

## 文档状态

## 维护责任人

## V1.0

### 2024.4.29

## 语雀迁移飞书

## 使用中

## 说明

本文档针对机器人自动化改造过程进行规范，使公司产品符合行业标准，保证产品质量稳定，使技术人员在进行改造过程中有章可循。

机器人自动化改造涉及传感器众多，建议采用我司标准核心控制器线束 TE23、TE35，本文档以核心控制器标准线束为蓝本进行作业指导。

## 一、适用范围

本技术规范适用于公司进行机器人自动化改造的研发、生产、调试的技术人员。
### 二、调试资源

Technosoft 专用调试软件 ： EasyMotion_demo。
### 三、改造和接线
## 进行改造（底盘驱动器部分）
## 1.驱动器需要与车体进行可靠固定，检查驱动器与对应电机的三相线、编码器线路连接正确;

2.当机器人安装有多个驱动器(数量 ≥2 )时，所有从站的 CAN_L，CAN_H 引脚直接相连即可，采用串联方式接线，如图 4.3.1 所示；将 can_H 压入一个德驰插筒连接器，将 can_L 压入一个德驰插筒连接器，接入德驰 DT06-2S 公头。最后与 TE35 中的 32，33 号线（can1）相连；
df22bdf3-a98e-44f2-9739-c91722faa3a7.png

## 图 3.3.1

3.为保证 can 通讯质量，需要将距离核心控制器最远的驱动器上的 120Ω 终端电阻打开，如在图 3.3.1 中将 Driver1 驱动器上终端电阻通过拨盘打开；

4.SRC 2000 采用控制电机是否使能的方式来实现急停与否功能。电机是否使能可以通过控制 Technosoft 驱动器上相应 STO 口通断高低电平的方式来实现；

5.驱动器拨码的定义，如图 3.3.2，1 号拨码拨到下方选择使用 canopen 工作模式，2~8 号设置驱动器 ID，逆向排列 8~2 号为 bit0~bit6，如图 3.3.2 所示，8 号拨下代表二进制 0000001，表示 ID 为 1，同理 7 号拨下为 0000010，转换成十进制等于 2，表示 ID 为 2。
db25eddc-f125-4d3f-b9cc-8cb3eb760dbc.png

### 图 3.3.2（Technosoft 拨码开关）

6.Technosoft 驱动器的急停接线如图 4.3.3 所示， TE35 线束【4】急停输出 1- 接入 24V， 将两驱动器 J8 接头的 STO1+、STO2+ 接在一起与 TE35 线束【5】急停输出 1+ 连接起来 ，两驱动器 J8 接头的 STO1-、STO2- 接在一起与控制器的地相连 。
626507eb-de44-435d-9b39-925041680558.png

### 图 3.3.3（Technosoft J8 急停接线图）

### 7.至此 Technosoft 驱动器安装及急停处理结束，为发挥驱动器最佳性能在电机装配完减速机及车轮后，需要对驱动器进行一次调试。

### 四、驱动器配置

## 1.下载并安装 Technosoft 专用调试软件 。
 EasyMotion_demo 。

2.使用 RS232 通讯方式，实现调试电脑与驱动器的通讯。建议使用 USB-232 转换器，使用 Technosoft 驱动器专用 9pin 通讯线束，如图 4.4.2 所示：
9bbc6c98-8afb-43d1-be56-01f59db2fc03.png

## 图 4.4.1
### 3.将驱动器上电后，双击 EasyMotion_demo 软件图标，需要注册后才能正常使用，注册码如图 4.4.2 所示
fd275a61-cec3-40bd-9a2b-108b09686f6e.png

## 图 4.4.2
4.选择软件连接方式，【Communications】-【Setup】正确选择连接驱动器的 com 口，波特率选择 115200 , ID 选择 autodetected， 【work offine】勾掉，点击【OK】；
90924698-8fed-4cea-9293-3ddf3f23b35a.png

## 图 4.4.3
### 5.选择红框内的【new】，点击【OK】；
c82f0dd2-107d-48df-8f22-661b1c199d6c.png

## 图 4.4.4
### 6.此时根据实际情况选择驱动器和电机的型号，如图 4.4.5 所示：
dd4eb223-62a0-4c43-b068-33a79d560b77.png

## 图 4.4.5
### 7.点击【setup】- 【new】，如图 4.4.6 所示；
85f044fc-dcde-4de3-b6f8-f5854046e244.png

## 图 4.4.6
会看到弹出电机设置框和驱动器设置框，箭头所示的地方选择 user，motor 为空；红框内按照电机实际参数填写，此处以海豚电机为例；
f017d5bf-f965-4731-a534-adc18650050d.png

## 图 4.4.7
编码器和霍尔的值正确填写后要用软件检测一下。点击【test connections】- 【start】，用手转动电机，下方黄色区域出现编码器的读数后，点击【stop】如图 4.4.8；再点击【detect number of lines】，点击【start】，检测结束后点击【close】检测结束，（如果检测出来的数值和填写不一致，点击【OK】，替换成检测出来的数据即可）如图 4.4.9；【test connections】，【detect hall configuration】同理。

注：检测编码器或者霍尔时出现报错，建议把检测电流调大一点再检测
e57af471-2ad1-4c94-a9c6-cb5916d92721.png

## 图 4.4.8
d3c2e0fc-a961-4f20-bcf7-7e2f6baeeec9.png

## 图 4.4.9

点击【 drive setup 】，开始驱动器的相关设置，如图 4.4.10：
1：选择控制模式选择【speed】；
2：外部触发勾选【yes】和【Automatically activated after power on】;
3：波特率选择 250Kbps；
4：ID 选择【H/W】（识别硬件 ID）记得要用拨码开关设置驱动器 ID；
5：驱动电压按照实际填写，可以点【detect】，检测电压数值填写进去；
6：启动模式选择【BLDC with Hall sensors】（BLDC 表示无刷直流电机，按照实际电机填写）；
7：点击【CANopen settings】选择下发的速度单位，其中【Speed units】选择 rpm，【Time units】选择 s。
c74ba380-1921-4c15-a38d-e015b3093052.png

## 图 4.4.10

点击【true&test】，弹窗点击【accept】，选择【automatic true】，点击【start】开始整定，软件会按照【automatic true step】（红框内）的步骤自动整定。整定完成后【start】旁边会出现【automatic true done】，表示整定成功。
d3bfe906-7efc-4c53-b58c-8d847d0a301d.png

## 图 4.4.11

选择【advanced TURing - Speed Controller】，【Test】，点击【Start】整定速度环，电机会周期性的往返运动，大概一分钟左右，点击【Stop】停止整定，出现【test is finished】整定成功，点击【OK】
7d7d372e-8a2e-46dc-b92e-8838d888691e.png

## 图 4.4.12
## 下载到驱动器，驱动器重新上电后参数生效
e88cc035-5785-4507-abd7-f4298d8f2fec.png

## 图 4.4.13

### 4.5 手动调整驱动器参数

待补充...

### 五、机器人模型配置说明

### 根据电机及减速实际情况配置行走电机参数：

注：这些参数需根据驱动器及选用电机及减速机的实际进行填写；
371c1778-1621-4fb1-b00f-8b16a2ca3f6f.png

## 图 5.1

注：减速比、编码器线数、电机最大转速、驱动器品牌需要根据选用的实际填写。

### 六、驱动器的功能检测

## 1.在整车组装完成未安装外壳前，请再检查一遍接线确保接线正确。

2.将车体加高，使轮子离地。开启机器人，使用网线连接机器人。使用 Roboshop 软件操作机器人让轮子转起来。 使用 CanScope 夹在 CAN 总线上检测 CAN 报文至少 1 小时，CAN 报文无错误。

### 3.让车体着地，使用 Roboshop 软件操作机器人做运动动作:向前，向后，向左，向右运动。

4.未拍急停按钮前，推动机器人，无法推动（电机使能），检查 Roboshop 中机器人状态处于“未急停”“驱动器未急停”，如图 6.1 所示；所示拍下急停按钮后，再次推动机器人，可以推动（电机使能释放），检查 Roboshop 中机器人状态处于“已急停”，“驱动器已急停”，如图 6.2 所示。
2f6e3255-9321-4e47-8fbc-1a438ee8d619.png

## 图 6.1
29bce4ca-0400-4370-adea-228e929776b4.png

## 图 6.2

### 5.任务链运动老化测试 24H，查看 Robokit Log 无错误报警。

### 七、附录

### 7.1 致远 CAN Scope 使用方法

## 1.软件安装--安装 CAN Scope 配套软件 CANScope。（软件及使用手册请联系致远厂商售后）.

2.硬件连接--参考 CAN Scope 使用手册接好电源，USB 调试线，插上 CAN Port 板,将 CAN_H 接到 SRC2000 外接线束 TE35 33 号线上，将 CAN_L 接到 SRC2000 外接线束 TE35 32 号线上 USB 调试线插在电脑上。

3.打开软件 CANScope，选择【Port 板】，取消【启用终端电阻】，选择【报文】，配置【波特率】为 250Kbps,取消【总线应答】，选择【开启】，CAN 报文实时如图 7.1.1 所示。
d2d9719f-f403-44e4-9850-3da4ca4ae628.png

## 图 7.1.1

### 4.选择【状态】【错误】，检查是否有错误报文。如图 7.1.2 所示：
bdfdec97-e814-4103-b428-f22d249d516b.png

## 图 7.1.2

### 7.2 USB CAN 卡使用方法

## 1.软件安装—安装软件 USB_CAN Tool（软件及使用手册请联系 CAN 卡厂商售后）.

2.硬件连接—准备 USB CAN 卡和连接线，将连接线 CAN_H 接到 SRC2000 外接线束 TE35 33 号线上，将连接线 CAN_L 接到 SRC2000 外接线束 TE35 32 号线上，如图 7.2.1 所示。
e1b2464e-56d3-4fdb-9b74-189406f3fb73.png

## 图 7.2.1
3.打开 USB CAN tool ,选择【设备操作（O）】【启动设备（S）】,确认 CAN 参数，【波特率】为 250Kbps,选择【CAN 通道号】为通道 1,点击【确认】。如图 7.2.2 所示
9a9c91b6-5010-453c-975c-52c40d420f66.png

## 图 7.2.2

### 4.选择【显示（V）】，取消选择【合并相同 ID 数据(M)】，CAN 报文如图 7.2.3 所示。
773b8634-aca6-4ee8-8fa4-edecacc12b31.png

## 图 7.2.3

### 7.3 udpconsole 使用方法

udpConsole 是我司工程师用于调试 bug 开发的小工具，可以检查到固件上报的错误信息。

## 1.打开 udpconsole 工具前需用网线确保电脑与机器人的物理连接。

### 2.打开 udpconsole 进行驱动器功能测试，时刻检查 udpconsole 显示内容。

### 驱动器通讯过程中出现错误帧如图 7.3.1 所示：
60a0afc8-d9ec-4ef4-801b-9d8728fe3baf.png

## 图 7.3

### 八、驱动器常见错误码
8bdb62f5-2fb9-4e00-9ccf-afa053ffc19c.png

## 图 5.1

举例：当 Roboshop 的【Robokit 报警窗】中收到报警码：“0x8000”时，如图 5.1 所示，将报警码转化为二进制为“1000 0000 0000 0000“，通过观察，驱动器的第 15 位存在错误，对应到上表，则驱动器报错为：Drive disabled due to enable or STO input. Set when enable or STO input is on disable state. Reset when enable or STO input is on enable state

## 附录一：版本升级说明

## 序号

## 日期

## 版本

## 改动说明

## 1

## 2

## 3

## 4
