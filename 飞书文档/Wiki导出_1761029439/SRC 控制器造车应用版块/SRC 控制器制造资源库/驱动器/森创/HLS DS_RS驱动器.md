# HLS DS/RS驱动器

## HLS DS/RS驱动器

## 版本

## 更新日期

## 更新说明

## 文档状态

## 维护责任人

## V1.0

### 2024.4.29

## 语雀迁移至飞书

## 使用中

## 说明

本文档针对机器人自动化改造过程进行规范，使公司产品符合行业标准，保证产品质量稳定，使技术人员在进行改造过程中有章可循。

机器人自动化改造涉及传感器众多，建议采用我司标准核心控制器线束 TE23,TE35, 本文档以核心控制器标准线束为蓝本进行作业指导。

HLS 伺服驱动器选型建议参考公司的选型指导手册。

注：本文档只适用于改造参考，不可作为技术协议及其他承担责任的内容。

## 一、适用范围

本技术规范适用于公司使用森创驱动器进行自动化改造的研发、生产、调试的技术人员。

### 二、改造流程
### 4.3 类 Kiva 顶升部分 DI 使用规范

### 4.3.1 接线说明

## 顶升部分 DI 使用规范

## 序号

## DI

## 功能

## SRC 线号

## 1

## DI2

## 顶升下限位开关信号

## T23 6 号线

## 2

## DI5

## 顶升上限位开关信号

## T23 7 号线

## 3

## DI6

## 旋转零位信号

## T23 5 号线

注1:在顶升车上这三个 DI 不能作为其他其他用途；

注2：确保这三个传感器的均为 NPN 型，发出的信号能被 SRC核心控制器检测到。

### 4.4 进行改造（底盘驱动器部分）

### 4.4.1 行走电机驱动器安装方式

驱动器需要与车体进行可靠固定，检查驱动器与对应电机的三相线、编码器线路连接正确；
当机器人安装有多个驱动器(数量 ≥2)时，所有从站的 CAN_L,CAN_H引脚直接相连即可，尽量采用串联方式接线，如图 4.4.1所示；若驱动器仅提供一个通讯接口，无法完成驱动器的 can线串联时，则将所有驱动器 can 线引出后把所有 can_H压入同一德驰插筒连接器，将所有 can_L 压入同一德驰插筒连接器，接入德驰DT06-2S 公头，最后与 TE35 中的 32、33 号线（can1)相连.

由于部分驱动器没有提供级联接口，只能通过从总线上接引线的的方式来串联，这里引线的长度需小10CM.

注：在改造过程中若由于驱动器连接所需要的线束数量不足，无法实现在驱动器端进行快速串联，可采用图4.4.2 所示连接方式，但不推荐。

1677570132802-4931251e-fd74-43ef-a696-a9dd006cbc93.png

 图 4.4.1                                                                   图 4.4.2

为保证 can通讯质量，需要在距离核心控制器最远的驱动器上或总线末端安装终端电阻（阻值一般是 120ohm).（注：客户可在购买驱动器时向驱动器厂商提出购买配套终端电阻）

CAN 终端电阻是否正确打开的检测方法：关机断电，断开驱动器和控制器的 CAN 连接线（如图 4.4.1 中 Driver4和控制器之间的位置），使用万用表电阻档测量驱动器侧的 CAN 总线上CAN_L、CAN_H 之间电阻，电阻值为 120Ω则正确，如图 4.4.3所示。电阻值明显小于120Ω（如60Ω),则说明至少有两个驱动器打开的终端电阻。

断开图 4.4.1 中 Driver1 和 Driver2 之间的连接线，使用万用表电阻档测量Driver1 侧的 CAN 总线上 CAN_L、CAN_H 之间电阻，电阻值为 120Ω则正确，如图4.4.3 所示。如果电阻值明显大于 120Ω（如几KΩ),则说明终端电阻打开的位置不在 CAN 总线末端，需要调整。

1677570158368-ac750d15-0ce0-4dcd-91b9-ee1c406da016.png

## 图 4.4.3

### 4.5 驱动器参数配置
驱动器类型：一对一式，一拖二式 本文档以一拖二驱动器DS20270C为例
## 工具：
## USB-485转换器
img_v3_02cq_9b39481b-dc53-497f-9856-472fac06d33g.jpg

### 驱动器配置软件SyntronTS V18.0 ：

### SyntronTS  V18.0.rar.rar

使用USB-485转换器连接电脑和驱动器，打开驱动器配置软件，打开软件默认进入【设置向导】，按照引导填写即可， 先把驱动器侧面的拨码开关拨到如图样式 ，否则可能会导致无法连接驱动器上位机

1681355148240-0c4b3251-056c-420d-8857-6ab35ad1a305.png

设备选择栏中，可选择目标目标驱动器，其中标准版单轴 DS/RS伺服驱动器选择型号为 DS102xx，双轴（二合一） DS/RS伺服驱动器选择型号为 DS202xx。DS/RS10240C 暂选择DS202xx。选择对应的驱动器型号

1688546786871-c0fd3752-24c3-49df-8a91-3280b42a40cb.png

打开通讯设置，选择正确的com口，波特率默认115200bps，点击确定，然后顺序点击【连接串口】-【连接设备】，如下图所示；
1677570208268-46bd5fb6-1fc1-47fb-9f0a-353f3ca3df9a.png 

## 点击连接设备，右下角显示波形数据状态
1688546614333-b78a758a-a616-4542-8569-1fd04d22bb62.png

正转反转限幅不用填写，直接下一步；转速和额定电流按照手册填写，如查询不到默认即可

1677570232727-c5b9b6fd-e178-422e-b708-9d07e977c665.png

## 点击【参数编辑】，可进入驱动器参数设置

1677570305636-5057dfea-7490-4b1e-93a1-6c1a2df9d43a.png

【断电保存】勾上，F参数1轴和2轴分别表示一拖二驱动器的两套参数，无特殊要求两个轴的参数应保持一致
1677570322394-6dd1a1fb-0d85-45e0-a541-3f86f7cdd198.png 

单击参数编辑器工具条中的"参数全选"按钮可全部勾选参数，单击"参数不选"按钮可全部勾选参数。若选择部分参数，则全选按钮需要中转。参数表右边空白处为临时中转区，单击该区域后，再点击参数全选，即可选定所有参数。
1677570339219-5296049c-3744-4ac5-83d9-53d2c395adc2.png 

在通讯连接正常情况下，单击"写入参数"按钮，会出现写入参数的进度条，进度条完毕后，即驱动器已写入勾选了的参数值。 注意：写入参数请避免全选写入，否则部分伺服默认参数可能会被修改，导致伺服工作异常。 
 设置F0.1.002、F1.1.002为20 （配置驱动器为canopen通讯模式，如果不配置此参数，驱动器无法正常工作）。注意：如果需要设置F参数其它轴参数或P参数需要先把当前参数设置保存到数据库（软件工具栏有相关选项）。
## ①
## image.png

如果不需要改动当前页参数设置，可点击写入参数（软件工具栏有相关选项）将相关参数烧录进去。结果如下：
1677570389539-73d449c5-bb93-4a72-9f96-f3281223c691.png 

## ②
## image.png

如果不需要改动当前页参数设置，可点击写入参数（软件工具栏有相关选项）将相关参数烧录进去。结果如下：
1677570427630-23070e5f-0db6-4341-8258-60345e36b31b.png 

驱动器ID、波特率和看门狗设置；需要注意的 驱动器ID的设置格式 
## image.png

1677570468495-2620f88d-0d7d-49de-b442-d203d98ae08b.png

如果不需要改动当前页参数设置，可点击写入参数（软件工具栏有相关选项）将相关参数烧录进去。结果如下：
1677570488823-9810127d-22f3-429b-b566-707d7f463a1b.png

注：这三个参数设定的页面需要分别烧录，一次只能烧录一个页面的设置参数。

急停配置，Pn.1.000写入0，目的不启用该IO； 模型文件配置协议急停 
1677570735456-93fe49e3-3e63-4867-9e53-65f453cc9868.png 

CAN总线断线保护动作，Pn5.00C写入2，can总线与src通讯异常（断连）恢复后自动清错；
## image.png

 【断电保存】勾上，修改完成后【写入参数】，以上参数重启后生效；重启后再次读取一下对应参数，防止修改失败 
 当写入配置参数并重启驱动器读取相关配置参数于本文档设置无异，即可以考虑重置参数，重置电机默认参数的方法如下; 
## image.png

(即在p参数的设置页面将Pn6.001=111，烧录，重启驱动器即可恢复出厂设置)

### 五、 FAQ

## 1、参数写不进去

写入参数时 不能全选参数写入 ，修改哪个参数就勾选哪个参数写入，全选写入可能会导致部分参数被修改

### 2、驱动器配置成功后roboshop无报错但是无法控制轮子转动重启后重新读取配置的参数是否正确

### 3、DS20270C驱动器急停后无法推动

这款驱动器IO急停后电机仍保持使能状态， 所以模型文件需要配成协议急停 ，并且检查Pn.1.000参数配置是否为0

1677570779924-4e5aab1b-13c0-439f-a17e-2b490003a93d.png

### 六、 附录

### 6.1 通讯端子引脚分布及定义

1688439000101-1c981da5-e5ed-4674-868d-8020d7f6c17c.png

1688439020832-ffe6bacb-8991-4708-9627-c62d4d809b7a.png

## DS20270C

### 6.2 USB CAN 卡使用方法

## 1.  软件安装---安装软件 USB_CAN Tool（软件及使用手册请联系 CAN卡厂商售后）。

2.  硬件连接---准备 USB CAN 卡和连接线，将连接线 CAN_H 接到 SRC2000外接线束 TE35 33 号线上，将连接线 CAN_L 接到 SRC2000 外接线束 TE35 32号线上。如图 6.3.1 所示。

1677570810842-86a13730-b6bf-4435-b247-92790058cd67.png

## 图 6.3.1

3. 打开 USB CAN tool ,选择【设备操作（O）】【启动设备（S）】,确认 CAN参数，【波特率】为 250Kbps,选择【CAN 通道号】为通道 1,点击【确认】。如图6.3.2 所示：

1677570826944-ea83f0ea-8766-47ce-b9f8-fe82877c712f.png

## 图 6.3.2

### 4. 选择【显示（V）】，取消选择【合并相同 ID 数据(M)】，CAN 报文如图6.3.3 所示。

1677570851635-e94d61db-c5ab-486b-98d7-dc3203d33a03.png

## 图 6.3.3

### 七、驱动器常见错误码

## DS系列二合一驱动器不支持错误码查询

## 1.参数体系1

1677570876189-65e5eaea-0193-4cef-ba7d-e10bdd6484a6.png

### 电机报错，利用上位机软件查看错误码的步骤如下:
确定采用的485，那几个是通信线接口（RS485A+，B-）
确定驱动器的rj45端口，哪两根线是485通信线（RS485A+。B-）
### 打开上位机软件，确认通信成功，通信成功如下图：
1677570895799-5f8cf5bf-7170-42a1-a32a-824e50d9352a.png 

1677570912751-a446a6a0-8d19-4ae9-8518-231c023966a0.png 

可以修改下图的参数，看看可以读取电机的参数不，可以即通信成功，参数说明如下图：
1677570930331-dc9ee3f3-a494-4c33-a59e-3a07fb2bb4dc.png 

## 电机错误码如下：
1677570952092-596a2748-0c65-4028-a9c8-4b6ca5da3290.png 

1677570969359-6a4f7133-a5fa-4ebe-a85a-6ab14544a287.png

### 2.参数体系2

1677570983504-ab32782f-b0fa-44b6-a075-6b9faa2962ff.png

### 八、IO急停配置（暂时弃用）

1.HLS-DS20270C驱动器急停配置IN1如 图 4.4.4 所示，将所有驱动器的 COMIN并联后接入 DCDC 24V+ 输出；将所有驱动器 IN1 并联后连接 SRC2000急停输出 1+（TE35 4 号线），将另一根急停输出 1-（TE35 5 号线）连接DCDC24V- 输出； 图4.4.5 是DS20270C驱动器的急停接线图（下图仅供参考，请按照实际的电气原理图进行接线相关操作）HLS不支持DS系列驱动器急停后去使能，急停出发后驱动器将依旧保持使能状态

1677571000781-3660fb9a-8613-4f4c-8bb0-bc35f19c3adc.png

 图 4.4.4                                                                                                图 4.4.5

注：TE35 的 4 号和 5号线标无正负之分，为一组干触点，在实际接线中可以不用区分其正负。

急停配置，使用IN1，Pn.1.000写入3109，Pn.1.000参数说明如下图

1677571016146-028c8955-b2db-4a82-8b19-e89d7dcacce9.png
