# 鸣志 MDX+ 驱动器

## 鸣志 MDX+ 驱动器

## 版本

## 更新日期

## 更新说明

## 文档状态

## 维护责任人

## V1.0

### 2024.4.29

## 语雀迁移飞书

## 使用中

## 说明

本文档针对机器人自动化改造过程进行规范，使公司产品符合行业标准，保证产品质量稳定，使技术人员在进行改造过程中有章可循。

机器人自动化改造涉及传感器众多，建议采用我司标准核心控制器线束TE23,TE35,本文档以核心控制器标准线束为蓝本进行作业指导。

该文档适用鸣志MBDV系列伺服驱动器，具体选型建议参考公司的选型指导手册。

注：本文档只适用于改造参考，不可作为技术协议及其他承担责任的内容。

## 一、适用范围

本技术规范适用于公司使用鸣志MBDV-520AC系列驱动器进行自动化改造的研发、生产、调试的技术人员。
### 二、调试资源
## 驱动器相关手册：

MDX+ Quick Set_up Guide CN202209030(1).pdf

CANopen UserManual for Servo20211205_CN.pdf

### Luna - 软件帮助文档_3.20修改.pdf
## 驱动器配置软件：

### Luna-Setup-2.2.22.0716.zip
## 三 、改造和安装
### 3.1类Kiva顶升部分DI使用规范

### 3.3.1 接线说明

## 顶升部分 DI 使用规范

## 序号

## DI

## 功能

## SRC 线号

## 1

## DI2

## 顶升下限位开关信号

## T23   6 号线

## 2

## DI5

## 顶升上限位开关信号

## T23   7 号线

## 3

## DI6

## 旋转零位信号

## T23   5 号线

注1:在顶升车上这三个DI不能作为其他其他用途；

注2：确保这三个传感器的均为NPN型，发出的信号能被SRC核心控制器检测到。

### 3.2 进行改造（底盘驱动器部分）

### 3.4.1 行走电机驱动器安装方式

## 1.驱动器需要与车体进行可靠固定，检查驱动器与对应电机的三相线、编码器线路连接正确；

2.当机器人安装有多个驱动器(数量≥2)时，所有从站的CAN_L,CAN_H引脚直接相连即可，尽量采用串联方式接线，如图4.4.1所示；若驱动器仅提供一个通讯接口，无法完成驱动器的can 线串联时，则将所有驱动器can线引出后把所有can_H压入同一德驰插筒连接器，将所有can_L压入同一德驰插筒连接器，接入德驰DT06-2S公头，最后与TE35中的32、33号线（can1)相连.

由于部分驱动器没有提供级联接口，只能通过从总线上接引线的的方式来串联，这里引线的长度需小于10CM.

注：在改造过程中若由于驱动器连接所需要的线束数量不足，无法实现在驱动器端进行快速串联，可采用图 4.4.2 所示连接方式，但不推荐。

1677650787341-e6adbe92-f228-4dd1-b804-2fbf6c6d586e.png

## 图3.4.1  图3.4.2

为保证can通讯质量，需要在距离核心控制器最远的驱动器上或总线末端安装终端电阻（阻值一般是120ohm).（注：客户可在购买驱动器时向驱动器厂商提出购买配套终端电阻）

### 3.CAN终端电阻是否正确打开的检测方法：

关机断电，断开驱动器和控制器的CAN连接线（如图4.4.1中Driver4和控制器之间的位置），使用万用表电阻档测量驱动器侧的CAN总线上CAN_L、CAN_H之间电阻，电阻值为120Ω则正确，如图4.4.3所示。电阻值明显小于120Ω（如60Ω),则说明至少有两个驱动器打开的终端电阻。

断开图4.4.1中Driver1和Driver2之间的连接线，使用万用表电阻档测量Driver1侧的CAN总线上CAN_L、CAN_H之间电阻，电阻值为120Ω则正确，如图4.4.3所示。如果电阻值明显大于120Ω（如几KΩ),则说明终端电阻打开的位置不在CAN总线末端，需要调整。

1677650810548-f90af57b-9537-41e7-a74b-5be7ffa7a665.png

## 图3.4.3

4.鸣志MDX+驱动器IO急停接线图如图 4.4.4 所示，将所有驱动器的 XCOM并联后接入DCDC 24V+ 输出；将所有驱动器的X5并联后连接 SRC2000 急停输出 1+(TE35 4 号线），将另一根急停输出 1-（TE35 5 号线）连接 DCDC 24V- 输出 。

1677650826778-73be3428-dccd-4113-9800-40cbe77d0755.png

1677650845421-0f16b1e5-ddc2-4e0a-9d3d-183037febcf2.png

## 图3.4.4

注：TE35 的 4 号和 5 号线标无正负之分，为一组干触点，在实际接线中可以不用区分其正负。

### 四、 驱动器参数配置

### 4.1 驱动器调试

### 4.1.1 工具：

## mini-USB 数据传输线

1677650866998-5724ed62-f0d3-40bd-9ff3-fbdb9e7de1a9.png

### 4.1.2 连接上位机，上传当前参数

1677650890736-e2302ff8-fe45-4571-86d0-5bbd6e25e307.png

1677650908336-e4698217-cd94-452b-b785-2f0030dc08ad.png

### 4.1.3 基本参数：修改ID、波特率、配置看门狗触发时间和触发行为

### 如果支持拨码配置ID，拨码配置优先级高于软件设置

1677650929405-5c3c471c-b6c8-474b-9559-b34f2205cdad.png

### 4.1.4 减速停车：“AM值”对应【通用】-【伺服刹车减速度】，如无特殊需求，使用默认值即可；如果需要用到该功能，请根据现场情况合理配置该参数，

1677651026858-f4d9139e-a64f-4be8-abba-a92382ba96a7.png

### 4.1.5 动态刹车：鸣志MDX+提供“动态刹车”功能，启用动态刹车可以使电机更快速停车，以下配置为参考，可以根据现场需求设置

1677651043690-b3dd1a60-a59d-4216-a623-7d58ccacd990.png

### 4.1.6 急停功能：配置急停功能

1677651061224-e86fe696-bc12-46ac-994a-fb3add9032bd.png

4.1.7 电机转一圈脉冲数（count值）配置，默认10000，模型文件【encoderLine】配置参数是电机转一圈脉冲数除4，如下图encoderLine = 10000/4 = 2500；如果驱动器该处参数修改，模型文件配置参数需要对应修改

1677651080224-cd5e9dea-6566-41c3-8f6a-10a3a4507490.png

1677651101812-131ac414-b8f0-49c3-8ee4-6ab97545c483.png

4.1.8 保存参数： “Luna”软件版本是1.1.21.0528（包括以前版本），修改完参数需要发送“SA6“令才能保存修改的参数，输入”SA6”按回车，如果是1.1.21.0528以后版本，忽略该步骤，版本判断方法如图4.5.5.1

1677651119128-6bd96e1f-29bc-443a-bf2d-1eba59adf904.png

## 图4.5.5.1

1677651140709-394a9dec-2673-481c-98e3-463fa7b5e5ef.png

## 图4.5.5.2

1677651158978-59452f40-447b-44f8-90b7-e74be2e9df87.png

### 4.1.9 以上参数重启后生效；重启后再次读取一下对应参数，防止修改失败

### 4.2 驱动器固件烧写

### 4.2.1更新准备

## 1 调试线：

## mini-USB

1677651177477-2e1b61d6-edfd-4d69-96cd-a33b9b117334.png

## 2 使用软件：
### Luna-Setup-2.1.21.0820.zip

### 4.2.2 更新步骤：

## 1、连接软件

使用mini-USB链接驱动器和电脑，打开软件，找到固件下载

1677651200348-2761fa2d-8864-4479-bc21-06f510ec3a7e.png

### 2、开始下载固件

1677651218355-a570fc81-3cfe-4d7f-8747-adc89efa5dfd.png

### 3、完成升级

## 升级完成后给驱动器重上电

### 五、 FAQ

### 5.1 ID无法修改：

检查是否是拨码设置了ID，拨码优先级高于软件设置，如果想使用软件配置，请将拨码开关ID部分全部拨到off

### 5.2 看门狗报错无法消除
先排查通信是否正常，如果驱动器通信正常，且无法消除看门狗报错，检查看门狗配置，把触发选型勾选为【同步报文】，其余【RPDO】都取消勾选
1677651255204-10af7f6c-6024-42cb-9da5-2e36a29956ab.png

## 六 、 附录

## 6 .1 通讯端子引脚分布及定义

1677651271437-ec658e26-c2d5-47c9-8eaf-954f24941c6f.png

### 6.3 USB CAN 卡使用方法

软件安装—安装软件USB_CAN Tool（软件及使用手册请联系CAN卡厂商售后）。
硬件连接—准备USB CAN卡和连接线，将连接线CAN_H接到SRC2000 外接线束TE35 33号线上，将连接线CAN_L接到SRC2000 外接线束TE35 32号线上。如图8.3.1所示。

1677651286812-3c9cb425-37b4-4e18-968c-1f249e2bfe64.png

## 图 7.4.1

打开USB CAN tool ,选择【设备操作（O）】【启动设备（S）】,确认CAN参数，【波特率】为250Kbps,选择【CAN通道号】为通道1,点击【确认】。如图8.3.2所示：

1677651301873-7db7881b-c85e-4d6c-a58a-3039429e41d9.png

## 图 7.4.2

选择【显示（V）】，取消选择【合并相同ID数据(M)】，CAN报文如图8.3.3所示。

1677651319100-199f92a1-f0c8-4d2b-9c87-b968d5b996b2.png

## 图 7.4.3

## 七 、驱动器常见错误码

### 7.1 错误码

将错误码转换为二进制， 最右边为0位 ，当某一位被置1时，表示驱动器处于当前位定义的状态
例如：错误码为：0x8000000，转换为二进制为：1000 0000 0000 0000 0000 0000 0000，对应27位置1，查表可知，对应错误状态为 总线看门狗触发，可同时存在多种错误状态
1677651340773-a2c0dfad-438a-4785-ba65-0135f2608429.png

1677651358794-a7524535-6b55-4b6a-84c6-e4c668c2d384.png
