# 实施过程- FAQ

## 实施过程- FAQ

## 版本

## 更新日期

## 更新说明

## 文档状态

## 维护责任人

## V1.0

### 2024.4.29

## 更新发布

## 使用中

## 1. 料箱车异常处理
## 保持现场环境
当项目现场出现故障时，第一要素就是保持现场故障环境，及时记录发生故障时的时间、运单号、库位、站点等信息，将报错信息截图，脚本输出信息截图或录屏，及时提取问题发生时间前后半小时的日志文件。
可以拍急停，但是恢复故障前先不要松急停。
## 部分操作参考下图：
## image.png

## image.png

## 快速定位问题
使用 Roboshop 连接发生故障的机器人，查看脚本实时数据输出，截图或者录屏时请注意下拉条，需要录制到全部的完整的数据。
## image.png

根据机器人告警窗口的中文报错提示信息，确认故障原因，并快速恢复现场，恢复机器人运行前，请务必提取故障发生时间前后15分钟的日志文件。
## image.png

### 如果脚本报错提示不是中文，可以更新到中文提示版本，如下:
电脑联网后在云端更新脚本文件，现场正常使用的 json 参数文件不要更新，项目唯一码：72e830d4-4758-43d5-85d5-9e86e4fa71da
4f671507-795b-4f76-ad9b-8891423f28c2.png

更新完脚本文件后，选中文件，执行一遍脚本标零，然后【刷新】并【拉取】全部文件，操作如下：
## image.png

## 快速恢复现场
## 按以下操作步骤快速恢复现场：
## 拍急停
## 如果机构发生了物理干涉，则人工处理一下
## 松急停
## 核对背篓信息
## 运单重做或者人工完成运单
如果按以上操作，机器人依旧无法复位，请断电重启机器人，并查看下文实施 FAQ 文档是否参数配置有错误。
## 实施 FAQ
## 货叉升降时出现跌落、下坠现象
解决方案：将模型文件中升降电机的 quickStopMode 参数勾选上，参考如下：
img_v3_02cm_fa0fa3fd-7357-4582-8311-15bc1102632g.jpg

## 料箱车任务需要取消两次才可以恢复
原因：由于Trigger配置了松开急停后释放控制权，调度会自动抢占控制权，并打断脚本标零任务，导致标零未完成，如下图所示：
## image.png

解决方案：禁用掉如上图所示的Trigger配置， 禁用Trigger里面所有释放控制权相关的配置。

## 识别数据误差大，且 x 值大于 0.8
## 原因：误识别到后排货架的二维码
解决方案：联系产品或者研发更新RBK版本可修复该问题。

### 放货时，识别到货架对面的料箱，报错货架有货
解决方案： 按货架和料箱的实际尺寸，修改机构脚本中 max_goods_dist 参数，脚本中将根据识别到的料箱到货叉的实际距离，区分当前货架的料箱和货架对面的料箱， 参考如下：
1709706657889-f9cbbacd-d91a-4249-bd00-97a1629065e0.png

## 光照太强，二维码反光导致识别失败
## 解决方案：
二维码使用亚光透明PVC膜材质； 
关闭现场灯光，窗帘等，料箱车识别自带补光灯；
调节相机光圈降低采光。

放货时，当货架上已经有料箱，会出现撞击料箱的情况，没有报错货架已经有料箱。
解决方案： 下发的放货指令中增加 recBoxLift 参数，该参数含义为识别货架上已有料箱时的货叉高度，完整指令参考示例如下：

## {
    "operation": "Script",
## "script_args": {
        "lift": 0.37,
        "operation": "unload",
        "recAdjust": 1,
        "recBoxLift": 0.45,
## "rotate": 1.57
    },
    "script_name": "containerRobot.py"
## }

放货时，货架上没有料箱，却报错 shelf had goods!!!
## 原因1：误识别对面货架的料箱
解决方案：合理修改料箱距离货叉里程中心最远距离参数max_goods_dist，该参数默认值0.8m

## 原因2：货架上误贴了料箱码
解决方案：检查是否贴错了码，将其更换为货架码。

### 从车体背篓取货时，高度不对，箱子取不出来
解决方案：修改json文件中 low0 - low8 参数，只需修改实际使用到的层数即可，并实际测试参数值是否合适
## image.png

## 放货到背篓时，高度不对，箱子放不进去
解决方案：修改json文件中 high0 - high8 参数，只需修改实际使用到的层数即可，并实际测试参数值是否合适
## image.png

### 从货架取货时，识别后，二次下降高度不对，箱子抓不进货叉
### 解决方案：修改 rec_offz_box 参数值
## image.png

### 放货到货架时，识别后，二次抬升高度不对，箱子放不进货架
### 解决方案：修改 rec_offz_shelf 参数值
## image.png

### 货叉在识别二维码时，旋转机构超限、旋转突然卡住不动了
解决方案1：从硬件上调节旋转限位拨片的位置，使触发限位光电的角度不小于95°
## 限位拨片的位置在货叉下面，参考下图：
## image.png

解决方案2：货叉卡住是因为识别调整时触发了旋转限位，无法复位。本质原因是限位光电安装有问题，导致货叉在旋转95度左右时就提前触发了限位。 解决方法步骤如下：
## 测试出实际的旋转限位值，如下：
### 企业微信截图_17320194316521.png

## 测试后得到：
## 正向最大值，如 97.345度
## 反向最大值，如 -95.753 度

### 将其中绝对值较小者取整，得到一个值如 95 度
将脚本 json 文件的 max_rotate_angle 参数设为该值，如下：
### 企业微信截图_17320197079351.png

取放货时，识别失败，识别超时，识别时货叉不调整，识别时货叉左右摆头
原因：脚本 json 文件参数配置错误，识别文件参数配置错误
解决方案：参考如下步骤，修正参数。
## RBK 升级到最新发布版本
## 脚本升级到最新版本
## 识别文件参数参考下图：
## image.png

## image.png

## json 文件参数参考下图：
## image.png

## image.png

手动识别，查看相机拍照的清晰度和亮度。如果亮度过暗或者过亮，直接调节相机光圈，无需重新标定；如果照片清晰度不够，则需要通过相机上位机调节曝光和增益参数，且修改后需要重新标定。

### 车体偏离导航，车体丢定位，车体异常原地旋转
### 原因1：地图与激光匹配度低，导致定位丢失
## 解决1: 重新扫描地图
原因2：地面不平或者车体本身问题导致出现车体打滑，从而引发定位不准或者丢失。
解决2：增加 NFL 或者反光柱定位， 参考 反光板定位实施
### 手指机构异常，报错 finger open error
### 原因: 手指到位光电没有触发，或者手指电机损坏
## 解决：单独测试手指打开和关闭
## 操作步骤：
用机构脚本控制手指打开和关闭，观察IO配置界面手指到位DI是否正常触发，如果到位DI异常，则检查手指到位光电是否损坏；
如果脚本控制手指，手指机构没反应，则用DO控制手指机构，还没有反应则检查手指电机是否损坏；
拍急停后，手动拨动手指机构，查看手指机构是否卡住了，检查到位光电是否能正常触发。

## 取货时箱子太远，手指卡在箱子上
原因：放货时伸缩机构伸出过长，或者取货时伸出长度过短。
## 解决方案：
如果脚本任务参数（任务链参数或者库位动作参数）中包含 stretch 参数，可以调大 load 动作的 stretch 参数值， 或者降低 unload 动作的 stretch 参数值。
## image.png

如果脚本任务参数（任务链参数或者库位动作参数）中不包含 stretch 参数，伸缩长度将根据识别结果自动计算伸出长度，可以调整 json 文件中的 auto_load_stretch_dist 和 auto_unload_stretch_dist 参数值。 建议取货伸出的长度比放货伸出的长度多 1-2cm 比较合适。
## image.png

### 货架库位有限位槽的场景下，关闭自动调整货叉角度的功能
原因：有限位槽的场景下，料箱摆放位姿一般不会很歪；且识别误差过大时，限位槽会和货架斜向插取发生物料干涉。
## 解决方案：
auto_adjust_rotate 参数设为0，ok_x 参数设为 0.01；
## image.png

更新RBK到最新发布版本，电脑联网后在云端更新脚本文件，现场正常使用的 json 参数文件不要更新，项目唯一码：72e830d4-4758-43d5-85d5-9e86e4fa71da
4f671507-795b-4f76-ad9b-8891423f28c2.png

 驱动器报警后，无法通过拍急停恢复正常。
## 解决办法：
断电重启机器人，速度会比较慢；
略微修改模型文件电机参数值，然后推送模型文件，驱动器会自动重启。

识别到角度偏差{xxx1}超出上限值{xxx2}，请检查料箱是否摆正，二维码是否损坏
## 若出现以上报错，解决方法如下：
## 检查车体、料箱是否摆正、二维码是否损坏
检查模型文件相机的安装参数，识别文件参数是否配置正确；
标定数据是否准确。
