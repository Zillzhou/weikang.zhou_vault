# 充电桩

## 充电桩
## 更新记录：

## 版本

## 更新日期

## 更新说明

## 文档状态

## 维护责任人

## V1.0

### 2024.4.29

## 更新发布

## 使用中

## 文档资源文件清单：

## 文件名

## 资源文件

## 文档内编号

## 常见类型叉车模型文件

## 模型文件.zip

## 模型文件-01

## 充电桩识别文件

## fork_chargespot.zip

## 识别文件-01

## 充电点地图示例

### chargepoint_test.zip

## 地图示例-01
## 充电桩端配置
以锂平充电桩为例：锂平充电桩。
## 控制器配置SOP
## 模型文件配置
1703216256161-a37ec5fd-3008-4b6e-82bd-5dde8b76bda8.png

## 图 1.1 模型文件配置页面
a. 配置充电口在车体上的位置：根据实际车体结构设计及安装填写；
## b. 配置充电相关DO：
switchDO：充电开关 DO ，如有充电控制继电器；
switchDOTimes：尝试重启 switchDO 的次数；
switchDODuration：重启 switchDO 的周期；
openDODist：开始充电距离，机器人与充电桩距离小于该距离时开始充电；当这个值配置为 0 时，将会启用新逻辑：通过看是否有 DI 被配置成 "openCharge"，如果有，那就导航直到有一个符合要求的 DI 被触发后停下，之后再将充电 DO 打开。特别注意：如果不存在硬件 DO，而是使用虚拟 DO 进行控制，需要在模型文件中 DO 列中添加一个 DO。对于叉车适配我司充电器存在一个特殊逻辑，当该值配置小于 -0.1 时，到达目标点后，会先等待充电桩伸出到位后，再打开 switchDO，从而避免充电开始大火花的现象。
c. 配置充电相关逻辑：是否屏蔽激光（autoShieldLaser）、是否使用地图上充电点的方向覆盖识别结果的方向（recChargeUseTargetDir）、拍急停时是否关闭充电DO（disableByEMC）;
d. 启用设备并推送模型文件到控制器。
## 设置充电点
① 建立地图，将充电桩扫描进地图内，如下图：AreaShield 区域为充电桩的大致位置
1703134900085-3f87bc67-be06-44d6-8cec-40dcf8de7cb7.png

## 图 1.2 建图
② 将鼠标悬停在代表机器人的蓝色矩形上，右键点击，选择“标记特殊工作站”，将会出现充电点
ChargePoint；
1700207496319-e92c8200-ef42-421a-93ec-b88427deb928.png

## 图 1.3 标记充电点
③ 选择充电点的识别模型文件为：fork.chargerpot （如果不选择，则无法使叉车与充电桩产生通
讯）。
1703134760122-f6ba8587-36c3-4f17-94a7-d4389f4356c4.png

## 图 1.3 设置识别文件
## 识别文件配置
1703053040234-234ecd1f-7217-4999-8a6a-a9802b4e8087.png

## 图 1.4 识别文件配置
## 仙工充电桩配置（直接通信）
### 选择品牌：brand 选择 SRC-800
配置通信参数：根据充电桩实际通信参数配置 IP；
配置电气参数：根据机器人电池及充电桩型号，确定最大电流、最大电压；
选择充电方式：protocolCharging 选项，勾选则采用【协议充电】，不勾选则采用【状态充电】；
推送识别文件到控制器。
1703134146586-388271b1-9ad2-4812-a5ff-142d0d704ab4.png

### 图 1.5 识别文件配置-仙工-直接通信
## 说明：
Protocol Charging（电池协议充电曲线）：充电桩根据车体 识别文件 和 电池协议 中允许的最大充电电压及电流来进行输出，两者小的数值优先；
State Charging（充电桩内部充电曲线）：充电桩根据车体 识别文件 限制输出，在识别文件允许的最大充电电压及最大充电电流内，充电桩根据内部的充电曲线来进行输出，即充电桩模型文件中自动模式下的大小恒流。
## 仙工充电桩配置（通过core通信）
### 选择品牌：brand 选择 RDSCore_src
配置通信参数：根据充电桩实际通信参数配置 IP；
配置电气参数：根据机器人电池及充电桩型号，确定最大电流、最大电压；
推送识别文件到控制器。
1703134122848-92dcd2e3-1438-4608-9aab-5fad33de6561.png

### 图 1.6 识别文件配置-仙工-core通信
## 锂平充电桩配置
### 选择品牌：brand 选择 liping
配置通信参数：根据充电桩实际通信参数配置 IP、端口；
配置电气参数：根据机器人电池及充电桩型号，确定最大电流、最大电压；
推送识别文件到控制器。
1703134171517-180b5c24-29f4-440f-8ce4-4b9f645d40c2.png

## 图 1.7 识别文件配置-锂平
## 科林充电桩配置
## 选择品牌：brand 选择 kelin
配置通信参数：根据充电桩实际通信参数配置 IP、端口、slaveid（充电桩PLC从站id）；
配置开始与结束充电寄存器：根据充电桩PLC实际寄存器设置；
推送识别文件到控制器。
1703134095985-17af872d-e8e5-45be-8aad-bd72c20e3c84.png

## 图 1.8 识别文件配置-科林
## 山推充电桩配置
### 选择品牌：brand 选择 shantui
配置通信参数：根据充电桩实际通信参数配置 IP、端口；
配置电气参数：根据机器人电池及充电桩型号，确定最大电流、最大电压；
推送识别文件到控制器。
1703134570276-f27cdacc-8b53-4102-b70a-ee2f73487016.png

## 图 1.9 识别文件配置-山推
## 2 参数说明

## 参数名称

## 参数位置

## 单位

## 默认值

## 最小值

## 最大值

## 支持版本

## x

## 模型文件-charger-basic

## m

## 0

## -9

## 9

### 3.3.4.20~latest

## 充电口在车体坐标系下x轴方向的值

## y

## 模型文件-charger-basic

## m

## 0

## -9

## 9

### 3.3.4.20~latest

## 充电口在车体坐标系下y轴方向的值

## theta

## 模型文件-charger-basic

## °

## 0

## -360

## 360

### 3.3.4.20~latest

### 充电口在车体坐标系下 z 轴的角度偏移值

## switchDO

## 模型文件-charger-basic

## m

## -1

## -1

## 1000

## ~latest

预置条件 ：所要控制的充电 DO 必须装配有充电回路继电器。若无该继电器或不需要控制该充电 DO 时，将 switchDO 设置为 -1 即可。用于在充电时控制是否打开充电 DO 或打开对应 id 的充电 DO，不开启时该数值填写为 -1。例如：在充电时需要打开充电 DO3，则该数值应该填写为 3。
对于叉车，如果配置了switchDO，那么叉车离开充电桩前，需要同时保证switchDO 关闭，并且充电电流小于0。

## switchTimes

## 模型文件-charger-basic

## m

## 0

## 0

## 1000

## ~latest

在无法一次成功打开 switchDO 情况下，尝试开启 switchDO 的次数

## switchDODuration

## 模型文件-charger-basic

## s

## 3

## 1

## 1000

## ~latest

## 打开和关闭 switchDO 的周期

## openDODist

## 模型文件-charger-basic

## m

## 1

## -1

## 100

## ~latest

表示在自动模式下，当机器人和充电桩距离小于该参数时，会将充电 DO 打开。例如：设置该数值为 1 和 switchDO 为 7 时，在充电距离小于 1 m 的时候，会打开充电 DO7；当这个值配置为 0 时，将会启用新逻辑：通过看是否有 DI 被配置成 "openCharge"，如果有，那就导航直到有一个符合要求的 DI 被触发后停下，之后再将充电 DO 打开。特别注意：如果不存在硬件 DO，而是使用虚拟 DO 进行控制，需要在模型文件中 DO 列中添加一个 DO。对于叉车适配我司充电器存在一个特殊逻辑，当该值配置小于 -0.1 时，到达目标点后，会先等待充电桩伸出到位后，再打开 switchDO，从而避免充电开始大火花的现象

## disableByEMC

## 模型文件-charger-basic

## false

拍急停是否关闭充电 DO，勾选则为拍急停断开充电 DO，反之将充电 DO 置于打开状态

### chargeDisableMotorTime

## 模型文件-charger-basic

## s

## 1.

## 0

## 100

## ~latest

完成充电任务前，需要将walk电机或者抱闸电机去使能相应的时间后再恢复使能

## autoShieldLaser

## 模型文件-charger-basic

## true

## ~latest

### 控制在充电点自动屏蔽障碍物的区域是否生效

## powerOffDO

### 模型文件-charger-powerOffDO

## -1

## -1

## 1000

## ~latest

表示充电到点完成后进行关闭（用于关闭设备进行充电的场合）。当机器人从充电处离开前，会自动打开 poweroffDO。
