# 步科转向电机配置

## 步科转向电机配置
## 更新记录：

## 版本

## 更新日期

## 更新说明

## 文档状态

## 维护责任人

## V1.0

### 2024.4.29

## 更新发布

## 使用中

## 文档资源文件清单：

## 文件名

## 资源文件

## 文档内编号

## 常见类型叉车模型文件

## 模型文件.zip

## 模型文件-01
## 驱动器配置
转向电机驱动器配置详见：步科直流伺服驱动器。
## 模型文件配置
## 配置SOP
由于一般叉车的行走、升降电机为二合一驱动器，配置时必须完成所有电机模型文件配置才可以控制机器人移动。
## CAN 接口配置
此处配置的是机器人控制器的CAN接口使用的波特率及是否有终端电阻，如不正确配置将无法与电机驱动器、编码器、电池等设备通信。配置过程：
进入CAN；
## 修改CAN设备名称
启用设备；
选择端口；
波特率；
勾选是否有终端电阻。
CAN接口生效逻辑：控制器会使用上一次生效（上传模型文件）的CAN接口配置参数，使用过程中（包括关机后重启）禁用此设备不会影响正常使用。
1711015769237-e84c757e-1fab-4504-b58c-b7db1d1924cc.png

## 图 2.1 配置CAN

## 转向电机
进入电机motor配置；
复制并添加新电机；
修改点击设备名；
启用设备；
修改电机安装位置、CANID、速度、编码器线数、是否反装，其他修改为不启用（不勾选或-1）；
选择通信端口：一般为port1；
选择类型为steer；
选择品牌：如Kinco-FD-CANOPEN。
1711019463732-c07b8f6c-eac7-4643-bf72-109a18c84365.png

## 图 2.3a 配置转向电机
1711015838203-5d4274a2-468e-42af-9d13-a26a60955415.png 

## 图 2.3b 配置转向电机
1711015843879-b00693d0-e5f7-4b3c-a15c-9b1ec53c8a0a.png 

## 图 2.3c 配置转向电机
1711015847995-28c5edad-567e-47ad-8a20-f15f225cdea1.png

## 图 2.3d 配置转向电机
## 转向电机配置说明
## 基础配置（basic）
1703761858828-d667cb90-f4dc-41b5-abe6-c1fd4d6cd4b1.png

### 图 2.10 转向电机 basic 参数

## 参数名称

## 参数位置

## 单位

## 默认值

## 最小值

## 最大值

## 支持版本

## x

## 模型文件-motor-basic

## m

## 0

## -1000

## 1000

## ~latest

### 驱动器安装的 X 坐标，根据实际安装位置填写

## y

## 模型文件-motor-basic

## m

## 0

## -1000

## 1000

## ~latest

### 驱动器安装的 Y 坐标，根据实际安装位置填写

## yaw

## 模型文件-motor-walk

## °

## 0

## -180

## 180

## ~latest

## 驱动器安装的朝向，根据实际安装位置填写

## canID

## 模型文件-motor-basic

## \

## 1

## 1

## 255

## ~latest

### 驱动器的的 canID，根据驱动器上位机配置决定

## maxRPM

## 模型文件-motor-basic

## rpm

## 1

## 1

## 1000000

## ~latest

### 驱动器最大转速，根据驱动器上位机配置决定

## inverse

## 模型文件-motor-basic

## \

## false

## \

## \

## ~latest

## 驱动器是否反向，根据实际安装位置填写

## encoderLine

## 模型文件-motor-basic

## \

## 1

## 1

## 10000000

## ~latest

## 编码器线数，根据实际情况填写

## currentFactor

## 模型文件-motor-basic

## \

## 1

### 0.000100

## 1000000

## ~latest

## 电机电流因数，根据实际情况填写

## CAN通信配置（canPort）
1703761869396-ab8de77d-ea4e-44cc-826c-edcecd2269f0.png

### 图 2.11 转向电机 canPort 参数

## 参数名称

## 参数位置

## 单位

## 默认值

## 最小值

## 最大值

## 支持版本

## canPort

## 模型文件-motor-canPort

## \

## port1

## \

## \

## ~latest

## 驱动器使用的端口，根据实际情况填写

## 功能配置（func）
1703761893034-4f38938e-f207-4e08-bac0-f1be698d72f3.png

## 图 2.12 转向电机 func 参数
### 选择类型为 steer，需配置参数如下：

## 参数名称

## 参数位置

## 单位

## 默认值

## 最小值

## 最大值

## 支持版本

## maxSpeed

## 模型文件-motor-steer

## m/s

### 0.09

### 0.00000001

## 360

### 3.3.4.20~latest

 差速模组旋转最大速度，根据实际需求填写。

## maxAcc

## 模型文件-motor-steer

## m/s^2

### 0.001

### 0.001

## 360

### 3.3.4.20~latest

最大加速度，根据实际需求填写。

## maxDec:

## 模型文件-motor-steer

## m/s^2

### 0.001

### 0.001

## 360

### 3.3.4.20~latest

最大减速度，根据实际需求填写。

## maxJerk:

## 模型文件-motor-steer

## m/s^3

### 0.001

### 0.001

## 360

### 3.3.4.20~latest

最大加加速度 ，根据实际需求填写。

## reductionRatio

## 模型文件-motor-walk

## 0

## 0

## 10000

### 3.3.4.20~latest

## 驱动轮减速比

## maxAngle

## 模型文件-motor-steer

## °

### 0.0

## -360.0

### 360.0

### 3.3.4.20~latest

驱动器标零为左极限标零，则舵角最大角度应为 0 。
驱动器标零为中间标零，则舵角最大角度应为 x 。
驱动器标零为右极限标零，则舵角最大角度应为 y 。
## （ x ， y 均为正值）

## minAngle

## 模型文件-motor-steer

## °

### 0.0

## -360.0

### 360.0

### 3.3.4.20~latest

驱动器标零为左极限标零，则舵角最小角度应为 -x 。
驱动器标零为中间标零，则舵角最小角度应为 -y 。
驱动器标零为右极限标零，则舵角最小角度应为 0 。
## （ x ， y 均为正值）

## steerOffset

## 模型文件-motor-steer

## °

### 0.0

## -360.0

### 360.0

### 3.3.4.20~latest

驱动器标零为左极限标零，则舵角最小角度应为 x 。
驱动器标零为中间标零，则舵角最小角度应为 0 。
驱动器标零为右极限标零，则舵角最小角度应为 -y 。
## （ x ， y 均为正值）

## steerResolution

## 模型文件-motor-walk

## count

## -1

## -10

## 100000

### 3.3.4.20~latest

该值用于特殊情况下，若电机编码器抖动较大时，启用该参数可以解决电机数据判断为非静止的状态。

## bySpeed

## 模型文件-motor-steer

## \

## false

### 3.3.4.20~latest

舵轮是否使用速度模式，目前未开放，不可勾选。

## steerOffsetFile

## 模型文件-motor-steer

## \

## ——

### 3.3.4.20~latest

steerOffset值所在的文件夹，标定文件使用，可忽略。

## positionSpeed

## 模型文件-motor-steer

## °/s

### 30.0

### 0.0

### 180.0

### 3.3.4.20~latest

舵轮旋转的位置模式的速度， 现在只能用作kinco配做转向电机的时候，请根据实际情况进行填写

其中 steerOffset、minAngle、maxAngle 可以参考下图，标零朝向指驱动器自身完成标零动作后的位置（不经过仙工程序进行控制，可以咨询舵轮供应商，左极限，右极限，或零位开关的机械范围。），例如左极限标零，舵轮打到左极限后，认为该位置为原点。其他两种情况同理。 
1652171027543-3b6448b8-69c8-4e25-9fe5-875deb8b9e85.png

## 图 2.13 转向电机方向
## 品牌配置（brand）
1703762125961-4dd6e701-093d-4cf1-9291-63b8280740c0.png

### 图 2.14 转向电机 brand 参数

## 参数名称

## 参数位置

## 单位

## 默认值

## 最小值

## 最大值

## 支持版本

## brand

## 模型文件-motor-brand

## \

## \

## \

## \

## ~latest

## 驱动器品牌，根据实际情况填写

## 配置结果验证
配置完成后点击上传；
确定并推送至机器人控制器；
## image.png

## image.png

## 图 3.1 上传修改后的模型文件
返回地图与控制页面；
转向电机验证：如配置正确可在地图窗口使用左下角手动控制按钮控制叉车左转、右转；
## image.png

## 图 3.2 手动控制按钮
