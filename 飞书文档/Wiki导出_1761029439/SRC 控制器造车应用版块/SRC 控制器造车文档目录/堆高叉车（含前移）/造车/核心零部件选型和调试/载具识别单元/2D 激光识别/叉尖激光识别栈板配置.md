# 叉尖激光识别栈板配置

## 叉尖激光识别栈板配置

## 版本

## 更新日期

## 更新说明

## 文档状态

## 维护责任人

## V1.0

### 2024.4.29

## 更新发布

## 使用中

## 功能介绍
对于激光识别栈板，除了使用后激光进行识别之外，还可以使用叉尖激光进行识别。
## 使用说明
使用形状识别栈板和3d相机识别栈板共用同一个识别文件，在原先的识别文件的基础上新加部分参数。当选择forkLaser之后，系统会通过叉尖激光来进行栈板识别。同时根据rec_left_fork_laser_id和rec_right_fork_laser_id来选择特定的激光雷达数据，id由模型文件配置得到：
1677134873172-c2f7766b-5971-4681-8e8c-e86153b3d9a1.png

## 图 2.1 模型文件配置页面
## 下图为pallet的识别文件：
1677058699097-81a7ba71-9703-4835-b37e-7794d1086521.png

## 图 2.2a 识别文件参数说明
1677058679435-1eb9497c-5174-41f7-9391-3f9cf9b8ada0.png

## 图 2.2b 识别文件参数说明
注意：仙工智能提供三种栈板识别方式，分别为3D相机识别、后激光识别和叉尖激光识别，这里需要选择后激光识别的方式，并配置激光雷达IP。
在使用叉尖激光雷达的时候，一定要将车体坐标系左边的激光雷达设置为left_laser，将右边的激光雷达设置为right_laser。
且目前只支持如上图两种类型的栈板，即 pocket_spacing 大于 0，后续会开放支持pocket_spacing 为 0 的情况下识别。（已支持）
1677129711324-c5f347ac-2448-400e-b255-9915afbac805.png

## 图 2.3a 选择 forkLaser
1677134724758-70ce161a-88b1-488c-89cd-09e200a5a343.png

## 图 2.3b 选择 forkLaser
识别文件的参数需要按照栈板的尺寸进行配置。
## 注意事项
## 首先确定激光雷达是否能够扫描到栈板
如下图所示，激光雷达要能够清楚的扫描到栈板前方的三块（目前仅支持川字型栈板和田字型栈板）
1673251287430-075906f9-b3fd-4e24-b745-e536e0d27d4b.png

## 图 3.1 识别位置
1677135491074-16d11511-a29a-409a-bdcc-d7872321b6a9.png

## 图 3.2a 点云
1677141561995-a26ae44a-1fde-40e1-afdb-0f4f1961e0f8.png

## 图 3.2b 点云
注意： 一般来说激光安装角度很可能看不到栈板关键点的情况，需要通过调整激光的安装倾斜角度，确保激光能够清楚扫到栈板前方的3块，两个激光雷达扫描区域重叠也没关系，但是至少要有一个激光能够扫描到完整的pocket_spacing区域。
### 确定叉尖激光雷达的模型文件中step参数
如使用后激光进行识别，需要将该激光的step修改为0.1.
1673250908499-efdd59f6-1138-4d0f-baac-bf8106def070.png

## 图 3.3 修改 step
## 修改识别参数
修改参数：ValidLegRangeThesh，该值确定着激光雷达的识别范围，在车体坐标系下x方向的最远距离。如果车型为CDD14车型，使用后激光进行识别，该值应为负值，具体多少需要根据现场环境确定。
ValidShapeBias，该值一般为默认值0.2，代表着在车体坐标系下激光雷达识别的y范围。
1673252032937-f6895e41-9840-47b5-b5d0-021ccbf70681.png

## 图 3.4 修改识别文件参数
具体数值需要根据现场进行修改。
## 激光雷达外参
标定方法后续给出。。。。。
## 识别结果
1677135688800-77d3845b-53ec-4f23-bf2c-b18f1d355386.png

## 图 4.1a 识别结果
1677141617737-7490efb3-2077-4d60-a096-d0be41aaea11.png

## 图 4.1b 识别结果
如上图所示，激光雷达在正确扫描到栈板之后会将识别结果以图片的方式保存在segmentation文件夹下，图中白色点为激光识别区域内扫描到的物体，绿色点为候选物体，红色物体为识别到的栈板。
