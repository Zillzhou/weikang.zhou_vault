# 造车前场景导入 

## 造车前场景导入
## 造车前场景导入

## 版本

## 更新日期

## 更新说明

## 文档状态

## 维护责任人

## V1.0

### 2024.1.15

## 初稿

## 使用中

## V1.1

### 2024.2.13

## 初稿打样

## 使用中

## V1.2

### 2024.3.25

## 更换视频、补充内容

## 使用中

## V2.0

### 2024.6.06

## 场景元素分析

## 使用中

## @倪敬雪

## v2.1

### 2024.7.11

## 新增通道、载具、通过性

## 使用中

## @倪敬雪
## 概述
## 车型介绍
潜伏顶升移动机器人可潜伏至货架下方，将货架抬离地面，背负货架行走，适用于工业制造环节原材料、成品、半成品的搬运。
仙工智能提供基于 SRC 控制器为核心，选择生态链合作伙伴，帮助客户造出专属于定制场景的潜伏式移动机器人一站式服务。 轮式潜伏式移动机器人的结构主要包括底盘（包含悬挂和减震等）、驱控单元（行走、转向、顶升、旋转机构的驱动器、减速机）、导航系统和控制系统（核心控制器）。底盘由机械结构框架、驱控单元、轮子和电机组成。电机驱动轮子转动，从而实现移动。导航系统负责引导机器人沿预定路径行驶。控制系统负责接收导航系统的数据，并对电机进行控制，从而实现机器人的运动。

## 车体构成
对于潜伏式顶升的底盘（此处采用双轮差速 +旋转 +顶升 的全配置车体做车体功能介绍，如果需要选用全向的运动模型，参考造车前场景导入 ），下述就是对全配置的潜伏顶升随动移动式机器人相关部件进行概括性的介绍（注意根据表：底盘核心部件介绍表 中的功能授权，提前联系 SEER 商务进行控制器功能授权的开通，功能授权说明参考：功能授权说明 ，需要提供控制器唯一序列号和需要开通的功能信息给到 SEER 商务人员）。
## image2.png

## image3.png

## 序号

## 名称

## 是否可缺省（是代表可缺省）

## 作用说明

## 功能授权

## 1

## 上壳体

## 否

主要用于内置机械部件的外覆盖，注意在对洁净度、防尘、散热等场景因素有要求时候，需要注注意相关外壳的设计

## 2

## 上/下二维码读码器（选装）

## 是

上视读码相机：需要在料架底粘贴定位用二维码，主要用于潜伏式顶升车和料架的二次定位，能够固定车体和料架之间的相对位置；
下视读码相机：需要粘贴二维码在车辆行走的路径或者工位上，主要用于车辆的导航（比如局部环境动态变化率非常高的场景），需要使用二维码来进行导航；也可以用于工位的二次定位，需要保证车辆和地面二维码之间的相对位置（比如地面固定式料架的潜伏顶升）

## 二维码导航：
## rbk_pgv_nav
## 二维码精确二次定位：
## rbk_pgv_loc

## 3

## 托盘胶垫

## 是

主要用于车辆移载的载具和车体上表面的防滑设计，用于增加静摩擦力，根据实际情况决定是否选用；

## 4

## 前操作面板/屏幕

## 是

操作面板一般会集成开机按钮、急停按钮用于车辆开机和紧急情况的急停操作；

## 潜伏顶升车一般不安装

## 5

## 导航激光

## 否

导航激光一定是需要的，哪怕是选用了下二维码读码器采用二维码导航的方式；

### 如果使用反光柱导航需要开通rbk_reflector

## 6

## 灯带

## 是

不同的灯带状态用于显示车辆的不同运动状态；

## 7

## 安全触边

## 是

用于发生紧急碰撞时的车辆停止；

## 8

## 驱动模组

## 否

用于车辆的移动，驱动模组一般包括驱动器、减速机和直流无刷伺服电机，需要注意差速驱动方式和移栽载重之间的关系；

## rbk_diff

## 9

## 后操作面板/屏幕

## 是

操作面板一般会集成开机按钮、急停按钮用于车辆开机和紧急情况的急停操作；是否多添加一组取决于需求是否需要前后都需要实现快捷开机、急停等操作的入口；

## 10

## 自动充电口

## 否

用于车辆的自动充电，注意自动充电方式对于自动充电口的冗余设置的影响，特别是左右的冗余设计，激光识别充电的精度相对来说较高，纯自然轮廓定位的充电需要考虑环境变化率等因素；

## 11

## SRC 控制器 LAN 口延长口

## 否

用于 SRC 系列控制器 LAN 口 RJ45 网口的延长，便于调试车辆控制器；

## 12

## SRC 系列控制器

## 否

SRC 系列核心控制器，集成运动、导航、定位、识别等多传感器融合控制技术；

注意：SRC-880-T 包含所有可授权的功能；SRC-800-T 不能开通 SLAM 相关授权功能（比如说rbk_reflector）

## 13

## 顶升电机

## 否

用于车辆载具的举升模组，如果对于可变顶升高度有要求的话，一般采用线性电机（驱动器+减速机+直流无刷电机）；如果可以固定顶升高度，可以采用 DO 电机（有级调速控制器+减速机+直流无刷电机），成本相对于前者来说也会略微降低；

## 机构脚本控制顶升机构需要开通
## rbk_script

## 14

## 随动电机

## 是

用于 AMR 在移动过程中保持货架不发生移动（即保持货架和地图世界坐标系的相对位置关系），常用在窄通道取放货、窄通道移载等转弯半径不足的应用场景；

## rbk_spin

## 15

## 行走电机

## 否

行走电机主要用于车辆行走的驱动电机和行走轮，此处注意场景对于轮子材质、滚动摩擦系数等要求，是车辆是否出现打滑判断的依据；

## 16

## 5G DTU 模块

## 是

用于终端客户现场是否需要 AMR 加入到现场的 5G 网络中；

## 17

## 电池

## 否

电池的供能模块单元；

## 18

## 无线客户端/光通讯模块

## 是

无线客户端：用于使用外置无线客户端模块将 AMR 加入到现场的局域网中，相当于你的台式机加装了一张无线网卡；
光通讯模块：用于一些保密终端客户，无法使用 无线局域网 将设备进行远程控制和管理的一些场景中；

## 19

## 扬声器/功放

## 是

扬声器用于播放车辆在工作状态过程中的音效提示；

## 20

## 避障激光

## 是

用于检测一定高度的障碍物，补充2D导航激光无法识别扫描到的低矮障碍物。

## rbk_diff
## rbk_shapedetect

## 21

## 防撞触边

## 是

用于检测车体前部是否与障碍物发生碰撞。

## ——
## 表：底盘核心部件介绍表

## 常见应用场景介绍
常见的潜伏式顶升应用常见如下列视频所展示，通过下列场景中的展示，能够对比您终端客户的场景，并且进行一定程度上的引导作用。
## 场景 1：潜伏式顶升的移动式料架搬运

## 场景 2：潜伏式顶升的电梯联动

### 场景 3：潜伏式旋转顶升的异形超窄料架搬运

## 场景元素分析
该模块主要为了明确客户造车所适配的终端场景中是否包含一些特殊的场景因素，由于这些因素从而导致的选型策略变化和限制，包括载具、通道、环境（洁净度、温湿度、场景变化率）等。
## 地面环境
## 地面材质要求
确认地面材质的目的，主要为了确认地面的摩擦系数的大概范围值，以及明确所选车体的轮胎材质是否满足现场地面材质要求：
要求所运行地面摩擦系数大于 0.5，在现勘过程常可以通过塑胶鞋底与地面摩擦，如果有明显的声音较为清脆的声音可大体判断摩擦系数满足要求。
地面硬度大于 2H，标准量化测试方式参考。
采用高碳钢铲刀/莫式硬度笔。使用 铲刀/莫氏硬度笔与地面呈 45° 角用力快滑，查看地面是否有明显划痕，莫式硬度笔测量更为准确，因为莫式硬度笔是套装，里面含有不同标号硬度的笔头，如果刚好没有划痕则笔头与地面硬度相当。
1679402185743-b067df1e-12d1-4444-84fa-7c09a5f7649c.png 

1679402216368-325271ad-5ee2-4764-bf96-f7170a59580a.png 

地面载荷（即 地面单位面积的负荷需高于 AMR 水平投影面积内单位面积 2 倍的负荷）
地面不能够出现水，油污等影响摩擦系数因素的地面路段。
静电要求： 参照 IEC和 ANSI/ESD 标准，要求地面达到基本抗静电级，表面阻抗值（surface      electric resisitance）：10^9~10^12 Ω 。
## 环氧地面厚度参考
环氧地坪是比较常用的一种工业地坪，具有非常好的装饰性，不错的防滑耐磨抗冲击性，大多数的工厂车间都会选择环氧地坪来提升生产环境和地面质量。
## 环氧地坪的厚度标准
一般来说，环氧地坪的厚度在0.5-3.0mm不等，根据选择的环氧地坪施工工艺的不同，环氧地坪厚度也不相同。例如：普通的薄涂型环氧地坪厚度在0.5mm左右，环氧砂浆地坪厚度在1.0-3.0mm不等，环氧自流平地坪厚度在1.5mm-2.0mm。
## 一般环氧地坪做多厚才比较合适呢
环氧地坪的厚度主要根据对地面的需求来决定。普通的轻工业车间，如服装厂车间地面，主要是走人，可以选择做普通的薄涂型环氧地坪 （即：0.5mm）左右即可。
如果厂房经常有大型机械，或者车间产品比较重、要走叉车，则地面的承载能力要求会比较高，则不适宜做薄涂型环氧地坪，应选择涂层较厚的环氧砂浆地坪（1.0-3.0mm），随着环氧砂浆地坪厚度的增加，地坪的耐磨耐压性和使用寿命都相应的增加。
对于食品药品相对洁净度要求很高的车间可以选择1.5mm-2.0mm的环氧自流平地坪 。
## 地面摩擦系数测量方法
## 地面摩擦力介绍：

## 工具准备：

## 拉力计
1679363902999-7cccb4f5-2d53-4cf5-91e6-1c9cd526cee0.png 

## 2 个底盘驱动轮
1679363903076-f44fd33d-8f4a-4b33-90b0-e156022262f7.png 

## 扎带若干条
## 测量方法：
将 2 个驱动轮用扎带绑在一起（主要目的是阻止其在拖拽的过程中转动）。
1679363903044-ff42b89e-87d8-4ae0-b8d8-82b889227944.png 

用拉力计将 2 个驱动轮吊起来测量重力 G。
在地面取不同的点位，清除灰尘，将绑好的轮子立在地面上，使轮子外缘红色部分（聚氨酯材质）触地，用拉力计水平慢速拖拽 2 个驱动轮，测量出稳定的拉力值 F1、F2、F3… （注意每测量一个点位后，要将轮子与地面接触的部分擦干净） 。
F/G 即摩擦系数。
## 地面硬度测量
采用高碳钢铲刀/莫式硬度笔。使用 铲刀/莫氏硬度笔与地面呈 45° 角用力快滑，查看地面是否有明显划痕，莫式硬度笔测量更为准确，因为莫式硬度笔是套装，里面含有不同标号硬度的笔头，如果刚好没有划痕则笔头与地面硬度相当。
1679402185743-b067df1e-12d1-4444-84fa-7c09a5f7649c.png 

## 地面静电标准要求
## IEC 标准参考：

## ANSI/ESD 标准解析
旧版本的 ESD S20.20 标准要求，地板只需通过电阻测试。过去，地板的电阻被认为可以预测其产生电荷的能力。也就是说，如果地板的电阻测试结果在一定范围内，则可以假设地板会以足够快的速度释放静电，防止人们行走时电荷（称为行走体电压）的积累。
通过长期的实践得出，电导率（测量为低电阻）不能阻止电荷的产生。研究表明，一些防静电地板（耗散性或导电性）仍会产生足够的静电，从而损害对静电敏感的电子设备。2014 年，作为对这一新发现的对策，ANSI 更改了标准，将电阻和人体行走电压测试都包括在地板系统电阻内。
为满足 ANSI/ESD S20.20-2014 的要求，电阻测量必须为 ≤ 1 x 10E9Ω，并且，环境中允许使用的各种类型的鞋类进行测试 ，结合地板产生的静电荷不得超过100V。
事实上，S20.20 对地板引用的标准测试方法不是一种，而是三种标准测试方法，如下所列：
前两种方法测试电阻特性，以 Ω 为单位。第三个，以伏特为单位，测试人体行走电压或电荷产生——这对于确定防静电地板的性能至关重要。
电阻测试：对含有纤维的自流平环氧树脂地板的独立实验室测试证明，即使地板测量在导电范围内，地板也会在与佩戴防静电脚跟带的人的摩擦中产生 100V 以上的静电。在 100V 以上的电压下，静电可能就会破坏空间内需要进行保护的组件。这就是 ANSI/ESD S20.20 要求必须进行三个测试的原因。
地板材料：材料的电阻特性。该标准规定地板材料的接地电阻必须低于 1.0 x 10E9Ω。
地板材料和鞋类：与人结合的阻力。推荐的最大系统电阻为 1 x 10E9Ω。地板材料和鞋类结合人的电压测量。推荐的最大允许电压为 100V。
## 地面坡度
地面坡度的确认主要为了保证车体满载负重的情况下能够具备良好的通过性；坡度的计算方式如下图图示所示，坡度的计量单位为百分比计量。为了保证叉车正常的通过性以及放置物料侧翻的可能，叉车对于坡度的要求如下：
顶升不允许在有坡度的面进行原地旋转和停止操作（包括设置工作站点）。
带载的上坡能力为 5% = arctan(0.05) ≈ 2.8°，满载上坡能力为 3% = arctan(0.03) ≈ 1.7° ；
## 地面坡度计算方式参考：
## image.png

带载的上坡能力为 8 % = arctan(0.08) ≈ 4.5°，满载上坡能力为 5 % = arctan(0.05) ≈ 2.8 ；
地面坡度计算方式参考上图。
在斜坡上行驶时，装载在货叉上的重物必须面向上坡。
### 可以通过安卓和苹果应用市场下载 APP 进行测量
安卓应用平台为 APP 名称: 尺子测距仪 、苹果平台为自带的APP ,名称叫：测距仪；
## 地面坡度的计算方式图解：
1680840043825-cc42ae58-9867-490d-8739-d347620c5a4f.png

## 地面平整度
勘察地面平整度，主要为了确认车体是否具备完整的通过性，避免打滑。由于项目现场往往面积较大，首先要选取合适的检测点，包括：
机器人运行路线上，目视可见的不平整区域，或者对室内灯光产生反射扭曲的区域。
机器人工作站点。在工作站处，机器人常需要旋转，对地面平整度要求较高。
## 检测工具：
1679472895916-479afc35-7b00-40ab-82b9-0bb20d3dbbaf.png

检测方法：检测尺侧面靠紧被测面，其缝隙大小用楔形塞尺检测，其数值即平整度偏差。 靠尺与地面的最大弦高应 ≤ 5mm。

1679473335929-80ae1241-a37d-4769-91fa-1bc2d2652a41.png

不同机器人对地面的要求，会有所差异。详细参考参考各车体产品的说明文档。
地面平整度检测规范参考《建筑地面工程施工质量验收规范》GB50209--2010 表 5.1.7：
建筑地面工程施工质量验收规范 GB50209--2010.pdf
## 地面的台阶&间隙要求【顶升车】
现场的台阶和地面缝隙需要确认最大的台阶高度差以及最大缝隙值，以确保所选车体的运行参数可以进行覆盖，保证顶升车使用寿命以及通过性，叉车对于台阶和间隙的要求如下：
AMB-J 系列对于台阶和间隙的要求是分别是 ≤/5mm 和 ≤30mm;
SJV 系列对于台阶和间隙的要求是分别是 ≤/5mm 和 ≤30mm；
不允许在含有台阶的地面进行旋转和停止操作（包含设置工作站点）。
1680852578194-93e0aec0-5cce-41e0-a151-eb9f68ce5b71.png 

## 图1：台阶高度表示 图2：地面间隙表示

## 地面承重
现场勘查，是需要和客户确认地面承重事宜，确保机器人在负载后也能正常在工作区域工作。特别是叉车、复合 AMR 的重量比较重，一定要确定地面承重，以防损坏客户生产地面，或者对整个建筑架构又影响。
## 地面承重说明
地面承重能力受到地面材质的影响，也要考虑到地面材质问题，建议和客户确认当前材质下的最终承重。
## 承重单位：xxx KG/平方
载荷规范：见国标 「 建筑结构荷载规范GB50009–2012 」
💡注意：确认承重一定是 永久承重。
## 底盘 AMR 地面承重计算
AMR 使用固定的行驶路径，而且 AMR 用实心硅橡胶类轮胎取代充气轮胎，所以 AMR 行驶路面必须满足一定的承重要求。一般要求地面单位面积的负荷需高于AMR 水平投影面积 内单位面积的负荷，即 AMR 行走区域单位面积内的承载力的平均载荷，一般 每吨/平方 表示。
### 「  背负式 AMR 」 重量计算公式：
以 「  背负式 AMR 」 为例介绍，当 AMR 满载负荷运行情况如下图所示：
1681206504742-c33c2643-c60c-4079-a35e-5465864aca00.png 

1681204028754-390a297b-340b-42c3-9e80-a74d259eaef7.webp

条件：货物自重加 AMR 自重等于总载荷重量；即货物自重 1 吨，AMR 自重 0.5 吨，总重量 1.5 吨。
总承载重量 * 动力安全系数 = AMR 安全运行载荷总重量；
动力安全系数 1.3，
AMR 安全运行载荷总重量 1.5 吨 * 1.3 = 1.95 吨
AMR 载货投影面积 = 长 * 宽 ；
即 AMR 载货的投影面积 1.2 * 1.2 = 1.44m²。
AMR 安全运行载荷总重量除以 AMR 载货的投影面积；
即 AMR 在行走区域单位面积承载 1.95 / 1.44 = 1.354 吨/m²。
上述的计算方式，把动载荷与静载荷统筹考虑，是一种通用简便快捷的计算方式，方便大家实际计算应用。
## 通过性补充
（万向轮、行走轮、电梯重复定位高度和底盘驱动轮/万向轮的功率、尺寸关系）
过间隙能力会受到轮径影响，轮径越大过间隙能力越强。
## 万向轮
 万向轮的轮径和机器人的通过性有关，轮径越小，越障能力越弱，一般考虑有电梯的场景万向轮尺寸不小于 3 寸，这样可以满足越过 35mm 的缝隙和 10mm 的台阶；
万向轮在机器人运动时不能有干涉，要能自由 360°旋转，放两端对称布置尽量往外靠；
考虑机器人的承载力：根据三个点确定一个平面，三个支撑点（万向轮）的总承载能力一定要大于车体和货物的总重。
Hq36bphApojqMbxz2lFcThkPnCb.png

## 车体悬挂
为了防止车体运行过程中打滑，驱动轮一定要保证时刻着地，所以小车必须要有合适的悬挂装置，如下图的弹簧减震结构（该悬挂模型最大载荷为 200KG）：
PL9tbECRPoDPwqxKFnGcmE7rnMd.png

 弹簧的规格：长度 120mm 外径 18mm 线径 1.8mm；
两组弹簧悬挂提供的支撑力 ≈ 车体空载情况下的 60%；
车体自身重量 ＞ 载荷重量的 40%。
## 旋转
## 为了达到良好的旋转性能：
主动轮与自转中心应该足够的远；
质量分布应尽量集中于自转中心；
质心应该尽量和自转中心重合。
## 脚部防护
### 4.1  将底盘与地面间隙设计到 35mm 以下（安全鞋伸不进去）；
### 4.2  设计足够的车轮与底盘轮廓水平距离，使脚部碰不到车轮。
Q9HWbOS89oB5AAxYrSlcH4YZn0E.png

## 物理环境
## 场景空间环境
空间环境的不同可能会降低车辆使用寿命和运行稳定性，如不遇到未知的场景，可直接询问客户。
以下场景中使用容易导致车体电池短路、腐蚀等一系列问题。
## 空间粉尘
## 金属粉尘/粉末
## 腐蚀性气体
## 盐分
## 温湿度
温湿度的条件限制主要来源于 SRC 以及车体对于温湿度的要求 ；这里需要注意的是对于电池和 SRC控制器有重叠的参数，按照严苛条件进行要求。SRC 和 车体电池 对于温湿度的要求参考选型产品对应的 用户指南（产品说明书） 。
## 阳光问题
激光平面上是否有可见光直射（会影响车体的导航和定位），有些环境在特定时间内阳光才能照射进 AMR 运行的环境内，因此在现场勘查时有玻璃的场景需要确认下。
1681295076407-0462e346-c881-4233-9cc5-9669d90d7bca.png

## 运行场景工艺限高
主要确认运行场景中终端客户的场景限高要求是否可以保证顶升之后带载情况下在运行场景中正常通行；
### 例如（不仅限制于门，也有可能是电梯或者特定设备）：
1681294292285-ba9c8ae1-b505-4801-b3f9-cc3e9565173c.png

生产过程可移动的设备是否影响 AMR 带载后的运行。例如行吊运行区域是否会影响，
例如（不仅限于行吊，也有可能是设备使用过程中突出机构等。）：
1681293829932-61584ad3-beb7-4ac8-8eed-46018406996a.png

生产设备使用前后机械结构姿态不一，影响 AMR 使用环境。
## 例如：
1681294780233-53b37576-8e18-4989-b942-4e77232c412b.png

## 运行场景突出物
激光高度不能扫描到左侧的控制柜，可是车体总高高于控制柜下端空间，因此会产生碰撞。
## 见以下示意图：
1681293583544-e62e6962-4520-4f05-a58b-d3bb845d5d89.png

## 环境要求
客户特定生产环境可能对设备有特殊的要求，如无法评估，可以咨询客户。
## 现场对于设备的防护要求：
## 防水
## 防酸
## 防爆等级
## 载具
## 载具类别和特点

## 序号

## 载具样式图

## 载具说明

## 1

## image.png

## 多层料架
## 激光和载具腿之间的最大单边间距：
## 310mm>料架最底层高度>260mm
## 支持随动功能

## 2

1710407833860-29e85027-dfa4-41cb-b2f4-a49a26c2ab23.png

## 单层栈板
## 310mm>料架最底层高度>260mm

## 3

1710408157156-fca6de91-bdd0-400d-ba4c-bbe20e8d2f42.png

## 支撑架+常规栈板形式
## 310mm>支撑架平面高度>260mm
## 不采用随动功能

## 4

## image.png

## 可移动料笼料架
## 310mm>料架最底层高度>260mm
## 支持随动功能
## 载具场景
## 密集料架库应用场景：
## image.png

该场景为全向机器人移栽过程中 左右/前后 侧存在大量需要进行取放的料架；
由于车辆周围布满了动态移动的料架，所以地图变化率很高，此时可采用反光柱导航/二维码导航方式；
此类应用不建议使用料架腿形状识别功能，因为可能会把相邻的料架腿识别成当前预置的料架模型

## 通道要求
在部署顶升 AMR 的项目中，需要勘察 AMR 行走路线上， 实际可用的通道宽度 。特别是在两列料架之间，
实际可用的通道宽度 = 理论设计宽度 - 可能存在的料架限位装置宽度
## - 可能存在的反光定位装置宽度
## - 预防工人将料架摆歪所占用通道的余量
- 料架上货物超出所占用的宽度。
### 考虑车体选型、料架尺寸。在单通道情况下，一般要求：
对非旋转顶升机器人，实际可用的通道宽度 > 车体带货架时的旋转直径。
下图尺寸 B 是考虑了车体带 随动 功能，被顶升的货架 无需调整姿态 即可对接目标库位。
下图尺寸 A 是考虑了 不含随动 的功能，被顶升的货架需跟随车体一起要在通道内调整姿态，调整好姿态才能进入目标库位。
1681179916975-7442e8e4-5eab-4c87-9a8f-167140447fab.png 

1683180366336-35ca9b5f-3b6c-4dc7-8712-df44dc3f3855.png

对有料架识别要求的场景（这里使用激光识别反光贴的情况），为了保证激光能够看到高反点云（这样才能识别到），通常需要保证 识别距离大于货架宽度的一半 。其他条件如下图所述。
1654589367156-a2a22e7d-3780-4bd4-8dc6-eadad9a40e6a.png

## 定位环境
## 高动态场景
现场环境动态变化，人员、物品、车体等混合作业。 
## 场景问题分析
对于人工组装流水线组成的场景，特别的是小家电行业、部分3C行业、轻型电动车行业和白色家电行业，受限于工艺的要求，都存在人工组装流水线，此种流水线存在一个特点：搭建一条固定速度的流水线，人工在产线的两侧进行组装工作，在工人的身后则是组装需要的各种原材料，工人不需要进行移动只需要进行转身取料，面向流水线进行组装。产线之间则为物流转运通道，也是AGV和AMR的主要通道；
在这种布局之下就导致了，AMR面对的场景多为“变化的货架、料车和工人的腿部”，虽然在间隙中可以使用部分产线作为依据进行导航但是受上述物体的阻挡AMR能看到的可参考物较少，导致了AMR在进入产线内部后无法准确定位；
## 应对办法
在SR现勘和客户交流的过程中反复强调现场变换率较大，可能会导致定位丢失，现场交付有难度，同时在技术协议中明确说明此风险，避免后期无法对应；同时现场实施过程中也需要交付工程师灵活应对，建议采用以下方式：
## 采用传统方式
增加AMR视线范围内的参照物，比如利用料车限位、现场的安全护栏等方式与客户进行协商增加此类参照物；
## 高级功能
1，在路边设置反光板的形式增加定位的精准度，也可以与料车限位和护栏相结合提高定位的准确性；
2，设置高级区域，但是此功能也受一定限制，现场测试下来对于小范围的参照物变化可以应对但是对于大场景和高精度对接场景不适用此方法，此方法与二维码、反光板等精确定位进行互相补充，列如：在通道内使用动态定位，AMR转向需要与机台和料车对接时采用高精度的对接方式对误差进行消除；
## 环境的材质
因为激光本身的特性，机器人无法对以下场景进行比较好的导航及定位，如：
场景 1 ：表面呈镜面反射的物体，如：镜子、不锈钢亮面等。
1680540111027-71fc792e-3cb1-4c37-a08f-c60fc7af9a35.png 

1680540120256-ab9c2fad-062c-4a11-afac-c02cdd74ac97.png

场景 2 ：会透光的透明或半透明的物体，如：玻璃、部分毛玻璃等。

1680540149066-1a70943b-fe23-43e1-9577-ce917d82051d.png 

场景 3 ：吸收所有光线的黑色的物体，如黑色塑料托盘、黑色料架等。
1680540162041-5713e036-3a4e-400c-9319-4f599d7ba0ff.png 

## 解决方案推荐如下：

## 序号

## 解决方案

## 适用场景

## 适用车型

## 1

表面贴不透光不透明非黑色的膜作为参考物，参考物中心高度与导航激光高度平齐，上下各300mm，即总高度至少600mm。如果阳光会直射到AMR，则加大贴膜面积。（考虑到机器人与参照物之间，可能的最大距离）

## 1 、 2

## 顶升车、叉车

## 2

运行场景内添加固定装饰物作为参考物，如带立柱的金属挡板（激光高度上下 300mm 设挡板）、高大的告示牌、粗壮的水泥墩子等。

## 1 、 2

## 顶升车、叉车

## 3

### 运行场景内加反光柱辅助定位。参照章节3.8
。注意：导航激光要支持反光柱导航，优先选择倍加福R2000。 倍加福和富锐激光，可以在 10m 范围内看清直径 90mm 的反光柱。其他品牌激光都不行。

## 1 、 2

## 顶升车、叉车

## 4

AMR使用多线激光.

## 1 、 2

## 叉车

## 5

顶升车使用二维码导航方式，即在车底部加二维码识别模块，参考车体上/下视觉相机用二维码（导航/二次定位用）通识说明

## 1 、 2 、 3

## 顶升车

## 6

搬运物体、托盘涂装成非黑色。

## 3

## 叉车

## 7

料架或料车涂装成非黑色，也可以在料架或料车腿上贴反光板。

## 3

## 顶升车
## 环境的轮廓
### 以下环境轮廓会对机器人的建图及定位导航造成影响：
场景 1 ：非常空旷的环境，如跨度大的车间或仓库。
1680540451509-d79f8320-bce6-4598-bd2e-2df6af80b108.png 

场景 2 ：非常杂乱的环境，如展开的窗帘，不整齐的废弃物等。
1680540472323-4907abe9-67fa-4f3a-8b28-b8ea98eaa9cc.png

场景 3 ：没有特征的长廊环境，或有较多区域极其相似的环境，如两个建筑间的连廊等。
1680540479850-f94608c5-2560-4bd5-bed4-fbec78148e5e.png 

场景4：极易变化的环境，如移动料架、料车、中转设备、密集库等。
1680540497186-c2edb643-62fb-4ca4-b697-1dc60681f024.png 

景5：室外环境，如跨车间露天道路搬运等。
1680540546956-96c796b5-cbdb-43c8-b6ba-d9982f97afdc.png 

## 解决方案推荐如下：

## 序号

## 解决方案

## 适用场景

## 1

使用有效距离更大的导航激光。

## 1 、 3

## 2

运行场景内添加固定装饰物作为参考物，如带立柱的金属挡板（激光高度上下 300mm 设挡板）、高大的告示牌、粗壮的水泥墩子等。

## 1 、 2 、 3

## 3

### 运行场景内加反光柱辅助定位。参照章节3.8
。注意：导航激光要支持反光柱导航，优先选择倍加福R2000。 倍加福和富锐激光，可以在 10m 范围内看清直径 90mm 的反光柱。其他品牌激光都不行。

## 1 、 2 、 3 、 4

## 4

AMR使用多线激光.

## 1 、 4 、 5

## 5

顶升车使用二维码导航方式，即在车底部加二维码识别模块，参考车体上/下视觉相机用二维码（导航/二次定位用）通识说明

## 4

## 6

采用GPS RTK定位方案 。

## 5
## 布局规划
## 停靠点位布署问题

## 参考项目

## 荷兰飞利浦
## 充电点及停靠点问题分析
使用RoboShop布署现场点位时，使用CP（charge point）代表充电点，使用PP（park point）代表停靠点。
常规情况下，CP点不能作为PP点使用。
在多车场景下，客户现场的场地拥挤，没有多余的空间用于停靠车辆，将PP点布署在CP点旁很近的地方。
1682518465323-93d3d904-5b12-456a-819a-ef980b6ef7a8.png 

1682518846104-5f084a25-9198-4439-94d0-9246483628df.png 

这种情况下两台车执行充电任务时会有冲突：AMR1正停靠于充电点旁的PP1点，AMR2在PP2停靠过程中电量低于阈值，需要执行充电。此时两个PP点均被AMR占用，且PP1点的AMR1挡住了AMR2前往充电桩线路，此时两辆车成为互锁状态。
1682519688249-fdc3f0a4-1593-4fde-ae63-14c29325dc5b.png 

1682519644466-634cbc2e-2015-4eba-9589-f0b460f84f9d.png

1682519703653-2da611cd-bce5-45c2-b594-715894375f38.png

如视频中所示，设置了CP优先等级，AMR1先行驶至LM7点，为AMR2让出充电位置；
AMR2行驶入CP点进行充电；
AMR1再驶入PP2点进行停靠，完成两车位置互换。
## 注意事项
若环形路线出现PP点上的小车阻挡其他车辆，若非必要情况，可删除PP点，使小车完成任务后停在当前位置；
若后方有车辆时，即使前方小车停止，多车调度系统也会控制前车进行道路避让；
本次项目为特例，多车场景中PP点与CP点尽量不要放在同一个地方。
## 料架使用注意事项
## 料架规格要求如下所示：
1682230036298-12b7672b-284d-47da-8ba3-e5a152deaa09.png 

1682231141854-320df33f-8e74-4a83-91cf-1e2fbcfdb2f6.png 

## 顶升料架示意图1  顶升料架示意图2
1682314839042-767d6c8d-8b80-4d1e-ab4c-7610fa259378.jpeg 

## 顶升料架实物示例

## 顶升车顶升料架使用建议

## 代号

## 名称

## 推荐值

## 说明 & 注意事项

## A

## 顶升盘和料架安全间隙

## 15 ~ 20 mm

## B

## 料架腿宽度

## ≥ 50 mm

【注意】 1. 料架腿的 各个方向不允许出现镜面反射 2. 料架外观不能是黑色

## C

## 料架腿内侧距离车体外侧单边距离

## 70 ~ 100 mm

【注意】 1. 至少留 70 mm 2. 建议：100 mm

## D

## 激光发射面

## 见车体用户手册

【注意】 车体激光发射面≥±5cm的对应料架高度要可以平整粘贴反光贴 （ 反光别识别场景专用 ）

## E

## 料车轮

【注意】 万向轮不可对车体进出料架产生干涉（ 料架带有万向轮场景专用 ）

## F

## 旋转顶升车与料架间隙

## ＞ 70 mm

【注意】 车体在料架下旋转时，任意时刻、任意角度与料架距离：＞70mm（ 旋转顶升车型专用 ）

## G

## 顶升盘

## ≥2/3顶升盘面积

### 【注意】 顶升盘和料架底面接触面积：≥2/3顶升盘面积

【注意】 顶升盘上尽量加防滑垫（防滑垫厚度 ≥ 3mm），以防料架在运动过程 中发生偏移
## 其它注意事项：
料架在空载&带载情况下，需要满足车体的载荷中心要求（见：3. 顶升AMR有效载荷规格）
## 货物在料架上的布局是否会超出料架
## 料架的一致性
## 料架规格场景要求示例

1681120869956-2bd0ea2c-b2fd-4a27-9876-fb552ba66d3c.png 

1681121022491-e7393aad-cf7f-43b6-bb61-28924719d139.png

反光板识别需要料架腿有空间粘贴反光贴 料架再空/带载状态下不能满足车辆载荷中心距要求
1681121103567-da3d465d-a553-47a6-b600-5d30d4801d07.png 

1681121150615-bff63bb1-1c57-4666-a24c-05bf76f9184c.png

料架腿不能是镜面反光材质 货架腿距离机器人外侧的单边距离过小
## 顶升AMR有效载荷规格
1681120208191-ed5ea977-17b1-4860-b5e1-5a7316f5b11d.png 

1681120247423-1ec5f47f-faa7-4bb1-aaca-0eaf65b13044.png

### AMB-150J AMB-300J 有效载荷如下图所示：
1681120301729-89f55aef-284b-42cd-9541-3fc874f16f20.png 

1681120451993-bc7a216a-91e2-4ec1-9416-fdf920ed15c7.png

SJV-SW500 SJV-W600DS有效载荷如下图所示：
1681120501156-c06164da-e0d5-4d22-a564-f0b95212425e.png 

1681120747115-cbeb1803-3c7d-4429-a317-1a76e88b6ab1.png

### SJV-W1000 SJV-SW1500
 SJV-W1000 有效载荷规格  SJV- SW1500 有效载荷规格
## 料架现勘
### 顶升 AMR 的二维码 PGV 相机使用注意事项
### 对于如下两种定位和识别混用的场景需要格外注意：
1.上/下 PGV 同时使用在一个 AP 工作点库位时候 : 由于这个时候导航的方式是二维码导航，所以车辆通过二维码导航到 AP 库位之后，如果此时料架不能做到和地面定位二维码的相对位置固定（即料架没有限位装置），此时可能会导致当 AMR 通过地面二维码导航到 AP 库位之后找不到二维码，所以对于上下 PGV 同时使用的应用场景需要地面有限位装置保证 AMR 移动到 AP 点之后能够通过相机 FOV (视场)能够看到料架二维码；
2.下视 PGV 和料架识别（反光条/轮廓识别）: 如果 AP 点使用二维码导航此时是不能使用料架识别的，因为在使用料架识别时候，这个时候如果料架放歪了之后，AMR 是会报 “机器人找不到二维码”的报错，所以对于二维码导航和料架识别的应用场景，AP 点就不能粘贴二维码，二维码只能贴到该 AP 点库位的前置点，前置点和 AP 点的导航方式也不能选二维码导航，而应该是 SLAM 自然导航的方式；
1684648742835-99a86c75-85ff-4cad-b50b-5cf27ebe8224.png

## 上下 PGV 定位相机同时使用
## 通道宽度
在部署顶升 AMR 的项目中，需要勘察 AMR 行走路线上， 实际可用的通道宽度 。特别是在两列料架之间，
实际可用的通道宽度 = 理论设计宽度 - 可能存在的料架限位装置宽度
## - 可能存在的反光定位装置宽度
## - 预防工人将料架摆歪所占用通道的余量
- 料架上货物超出所占用的宽度。
### 考虑车体选型、料架尺寸。在单通道情况下，一般要求：
对非旋转顶升机器人，实际可用的通道宽度 > 车体带货架时的旋转直径。
下图尺寸 B 是考虑了车体带 随动 功能，被顶升的货架 无需调整姿态 即可对接目标库位。
下图尺寸 A 是考虑了 不含随动 的功能，被顶升的货架需跟随车体一起要在通道内调整姿态，调整好姿态才能进入目标库位。
1681179916975-7442e8e4-5eab-4c87-9a8f-167140447fab.png 

1683180366336-35ca9b5f-3b6c-4dc7-8712-df44dc3f3855.png

对有料架识别要求的场景（这里使用激光识别反光贴的情况），为了保证激光能够看到高反点云（这样才能识别到），通常需要保证 识别距离大于货架宽度的一半 。其他条件如下图所述。
1654589367156-a2a22e7d-3780-4bd4-8dc6-eadad9a40e6a.png

## 反光板说明
## 反光板定位原理
当激光雷达工作时，会对周围的环境发射脉冲激光束，重叠的激光束经过布置好的反光板，被反射回扫描器。当激光束照射在反光板上时，激光的反射信号强度会比较高，当激光照射在其他普通物体时，激光的反射信号强度相对更低，因此利用接收到的激光信号强度数据可以区分反光板和普通物体。
通常可以使用反光柱或者反光板来进行定位，由于两者之间的形状不一致，实际使用过程中需要根据设置反射强度阈值 ReflectorRSSI 来判定是否属于高反点。

## 参数名称

## 参数位置

## 单位

## 默认值

## 最小值

## 最大值

## 支持版本

## ReflectorRSSI

## 参数配置

## \

## 150

## 1

## 255

### 3.3.4.20~latest

此参数为反射强度阈值，当激光点的 RSSI 值大于该阈值时会认为此激光是高反点。

同时由于激光的反射强度跟激光束在反光板的入射角度相关，因此反光板点的反射强度也是不一致的，接近垂直入射时候的反射强度最高，然后随着角度变化逐渐强度变小。因此根据设置的阈值可以将满足条件的一系列激光点提取出来，然后需要根据激光点之间的距离进行聚类，从而提取出各个不同的反光板，因此需要设置一个聚类距离 ClusteringWidth ，同时聚类中反光强度最高的激光点的强度值需要大于 ReflectorRSSI+deltaRSSI 。

## 参数名称

## 参数位置

## 单位

## 默认值

## 最小值

## 最大值

## 支持版本

## ClusteringWidth

## 参数配置

## \

### 0.2

### 0.1

## 10

### 3.3.4.20~latest

此参数为聚类距离，激光点之间距离大于该阈值表明不属于同一聚类

## 参数名称

## 参数位置

## 单位

## 默认值

## 最小值

## 最大值

## 支持版本

## deltaRSSI

## 参数配置

## \

## 30

## 0

## 100

### 3.3.4.20~latest

## 反射强度阈值增量

为了避免偶尔出现反射强度高的干扰，设置了聚类的最小激光点数量 Number

## 参数名称

## 参数位置

## 单位

## 默认值

## 最小值

## 最大值

## 支持版本

## Number

## 参数配置

## \

## 5

## 1

## 1000

### 3.3.4.20~latest

## 此参数为聚类最少激光点数量阈值

如下图所示，形成有效聚类后的激光点会识别成反光板，如果设置好聚类的物体类型 Type 以及宽度 Width ，可以看到黑色的反光点为聚类后识别出的有效点。

## 参数名称

## 参数位置

## 单位

## 默认值

## 最小值

## 最大值

## 支持版本

## Type

## 参数配置

## \

## 0

## 0

## 1

### 3.3.4.20~latest

 聚类的物体类型，Type为0表示反光柱，1表示反光板，默认为0

## 参数名称

## 参数位置

## 单位

## 默认值

## 最小值

## 最大值

## 支持版本

## Width

## 参数配置

## \

### 0.08

### 0.0

## 1

### 3.3.4.20~latest

聚类的物体宽度，默认为0.08，如果是反光柱则为直径，如果是反光板则是宽度

1650606366947-ea0c608f-1436-4829-9cf9-213e9f372688.png

识别出有效反光板后，需要将机器人识别出的反光板与地图匹配，计算出机器人在地图中的位置。当只能看到两个有效反光板时，计算机器人的位置会有歧义性，因此默认机器人利用反光板定位时，需要看到大于三个反光板，此时可以使用 SetError 参数来决定此时的报警状态：

## 参数名称

## 参数位置

## 单位

## 默认值

## 最小值

## 最大值

## 支持版本

## SetError

## 参数配置

## \

## true

## \

## \

### 3.3.4.20~latest

当 SetError 为 false 时，机器人在反光板定位区域内，且检测到的反光板数量少于三个，则触发 Warning54019 ；当 SetError 为 true 时，机器人在反光板定位区域内，且检测到的反光板数量少于三个，则触发 Error52019 。

## Error52109
## 提示：
## 触发方式：
## 1、SetError为true时，机器人在反光板区域内且检测到的反光板数量少于3个
## 消除方式：
## 1、机器人不在反光板区域内；
### 2、机器人在反光板区域内且同时看到反光板的数量大于或等于3个。
## Warning54109
## 提示：
## 触发方式：
## 1、SetError为false时，机器人在反光板区域内且检测到的反光板数量少于3个
## 消除方式：
## 1、机器人不在反光板区域内；
### 2、机器人在反光板区域内且同时看到反光板的数量大于或等于3个。

## 反光条（柱）选择
使用反光条（柱）进行定位主要是为了在环境变化剧烈的工况下，机器人仍然可以保证高精度的定位。因此本文介绍如何选择合适的反光条（柱），以及合理的布置位置。
首先反光条的材质推荐使用 钻石级 （ 型号及购买链接： 3M DG3 4090 或 3M 983D ）
## 注意：
不要使用在交通应用里使用的反光板，例如 3990 。因为这些反光板的检测距离有限，而且入射光与反射光的夹角偏大。
1650594109709-19a41bc7-3c75-4b23-8173-eee4a54ee9a1.png

反光板选择 DG983-10 的夹角则更小。
1650594109719-726160d8-049e-4f60-b38e-2ecc20e3f31f.png

由于为了保证足够的定位精度，需要足够反光条尺寸和长度，如下图所示，反光条的长度应在 50cm 以上，反光条的宽度在 5-10cm，反光柱的直径应大于 8cm，才可以保证激光接收到足够多的反射数据。
## 注意：
目前只支持圆柱形反光条，建议 8cm 直径。
1650594109893-482a0172-bca4-4276-ae40-cd6372909359.png

由于反光条具有方向性，对反光条安装时不同的方向会导致可以使用的工作角度范围差异，安装的原则是保证图中的菱形单元格垂直于地面方向，这样才可以保证工作角度范围在 ±50°，如果是另外一个方向安装，则工作角度范围减小到 ±30°。
1650594110730-f0e301cc-9b2f-4b7b-90f3-7d36a7956218.png

在制作反光柱的时候，最好不要将反光条贴在聚丙烯（pp）塑料管，而应该使用聚氯乙烯塑料管。
1650594110372-7b7930bf-411b-4fd0-9a58-b964a5fd1cd6.png

## 实施原则
## 反光条的布局和数量
使用反光条（柱）在现成布设时，首先选择在需要使用反光板定位的区域内保证各个位置和视角都能识别到 3 个及以上的反光板，因此需要根据反光条的工作角度范围合理的设置，如下图所示反光条的工作范围。
1650594110548-cfbc91ce-cb0f-4693-a9fe-2d02ce84ebc3.png

黄色虚线范围内是反光条可以被识别到的范围，为了保证精度，另外识别距离在 10m 以内。
1650594110896-668bb987-28af-4cca-8ae4-d58efcb3a9d8.png

注：另外为了反光柱之间没有干扰，反光柱与反光柱之间距离通常在  1.5m  以上。
通常而言，反光柱的工作范围要大于反光条，由于在各个方向都可以进行观测，一般一个反光柱可以替代3个反光条，使用反光柱相对于反光条可以节省很大一部分安装成本。
## 反光条安装注意事项
由于现场环境收到限制，在某些时候反光条安装距离较近，在激光的视野下反光板会产生接近重叠的现象。
1650594110926-6df243c6-d711-4d2d-82fe-b6e1901cb865.png

这种时候就会将这两个反光板都忽略，不用其观测位置进行定位的计算。这个时候应该保证当前的激光器仍然可以使用 3 个及以上的反光板。
在反光条安装时，应该尽量保证附近没有高反射率的物体（包括其他反光条，或者玻璃镜）， 反光条与高反射率的物体之间应保证在 100cm 以上的距离 ，如果反射条的宽度或者直径更大的话，则相应的距离应更大，同时放置反光柱的时候，通常放置离后面背景物体距离小于  10cm 。
1650594111195-00bba448-f664-4664-be29-afcac9769bad.png

有时候在如下的室内环境下，有很多的高反射率的物体，因此如何选择反光条显得十分重要。
1650594111456-c5e0d9b8-b18b-4d4b-a899-ee86d0476ffc.png

在有玻璃或窗户的情况下，由于会形成二次反射，因此在窗户旁边应该尽量选择使用反光条，而不是反光柱。
1650594111506-bcdc5056-50d8-440d-a0e5-58955e5416ea.png

在理想的情况下，应该如下图一样，在墙面或者低反射率区域，尽量使用反光柱，保证较大的检测范围，而在玻璃窗户等高反射区域使用反光条，从而避免二次反射造成的干扰。
1650594111602-c6cefde7-3c3d-4384-b052-45e496849d9b.png

## 反光柱安装高度
在现场布置反光柱和反光条时， 应尽量保证反光条中心高度和激光水平面高度一致 ，并上下留有一定余量，保证运动的时候激光仍旧可以照射到反光板上。通常需要保证反光柱的高度在 50cm 以上，保证在较远处，仍旧可以正常运行。
1650594111827-f200b064-aadc-407f-85f8-99ecdc77445c.png

在给地面 AGV 使用时，由于 AGV 通常激光安装离地面高度较低， 同时需要注意激光安装角度问题 ，并且由于地面不够平整会导致激光水平面发生变化， 因此通常需要 AGV 行驶地面满足FF50(ACI 117 standard)，即 3m 靠尺误差在 ±3mm，这是一个比较容易达到的平整程度。
## 反光柱分布对定位影响

在机器人运行过程中，反光柱的分布以及数量对定位的精度和稳定性有很大的影响，理想状态下需要看到尽可能多的均匀分布的反光柱，如下图所示：
1650594109693-a4d5954a-1d49-4d1d-848d-0b7568d43e20.png

在上图所示情况下，机器人可以获得良好的定位。理论上只要任一时刻机器人可以检测到三个以上的反光柱就可以进行定位，但是以下情况中，机器人都可能定位不稳定，达不到理想的精度。

1683265216848-a927b191-7f8e-48a0-a2a8-9ec353dcd733.png

如上图所示， 虽然在同一个时刻机器人看到了三个反光柱，但是三个反光柱在空间上位于同一条直线上，这种情况下定位情况属于不良好 ，需要考虑反光柱的合理布置。同一时刻机器人看到的反光柱大于3个以上，且两两反光柱的夹角近似于均匀分布，差距不是特别大的时候有利于反光柱定位，如下图所示：
1683265558533-c0a3a6b9-3271-4093-a28d-05a87f12573a.png

## 定制小工具
## 反光柱辅助工具
## 选型参考
此定位支架有不同尺寸的，可按照反光柱尺寸选择适合的支架。
注意：支架不配置螺母，需要单独商家沟通。
支架螺杆大小和长度，按照实际场景和货架上的孔大小进行选型。
1683169789893-16096129-0b23-411a-866f-d2d9e041fb8b.png 

1683169873796-cc4c8299-edad-4a21-85f6-7689242af14a.png

## 安装方式参考

1683170924971-c62bb32d-80dd-4fea-92be-22df1d8e243d.png 

1683172205510-97460951-a570-4406-a3ea-e40e5314c1a3.png 

1684207732824-bbe026e1-eeb3-4235-8573-93c377fac87f.png

## 贴码工装

## 参考项目

## 济南费斯托B3车间乌龟车转运项目
为确保机器人能够通过料笼识别相机准确识别乌龟车位置，需要明确二维码安装等要求。
## 二维码打印
二维码打印内容 april.tag.Tag36h11, id = 0 ，虚线框以内，规格 30mm*30mm 。
## 打印材质要求：
a ）表面： PVC 膜；
b ）中间层： PVC ；
c ）背胶： 3M 胶；
## * 或同等效果的合成纸不干胶
1682735965642-63a25bc5-955d-4d51-a565-b415c6b9ba9f.png

## 工具及材料准备

## 序号

## 名称

## 图示

## 数量 / 单位

## 备注

## 1

## 贴码工装
## LH（自带吸附磁铁）

1682736088143-d85fc148-a096-40b7-a839-03df574acf72.png

## 1 个

## /

## 2

## 贴码工装RH （自带吸附磁铁）

1682736093107-50a8d379-2117-4796-9a75-fc1eb806829f.png

## 1 个

## /

## 3

## 二维码

1682736163463-640c7a8b-25a1-4830-937d-a43738f30b43.png

## 按需

## /

## 4

## 清洁剂及清洁布

1682736178654-e8ac1597-8b6f-454d-a615-08206285581b.png

### 按需，乌龟车横梁粘贴面应使用除油脂清洁剂进行清洁

## 等同效果的清洁剂即可
## 安装要求
步骤 1 对乌龟车横梁张贴面进行清洁并保持干燥。
1682736231183-8212e4f2-ce78-41b8-ad21-0da34103da77.png

步骤 2 将对应的贴码工装贴靠到乌龟车左角或右角。
1682736238830-f11575eb-562a-463d-8aad-c2da0e24bc7e.png

步骤 3 撕掉二维码背面防粘纸，将二维码白边对齐工装直角拐角，平整粘贴到横梁上，确保不翘边，不起泡。
1682736247328-4ed3bfdd-f6d0-4629-8631-171d36e64c8b.png

步骤 4 移除贴片工装，若粘贴过程中污染了二维码表面，应及时进行清洁！！！
1682736259960-bb5090f0-2129-414a-af7d-c8545eb5f59a.png

## 载具对中限位工具

## 参考项目

济宁山推驾驶室车间、上海费斯托、济宁山推总装车间、潍柴成套车间等
1682776061266-8e8ff9d9-1372-4545-ba11-6274124701a3.png

## 料架/栈板对中限位
### 结构样式1：参考料号0107000672
1682759397262-0d00b5f8-2abe-4599-9133-a6b566f0a0b2.png 

1682759415150-350f9a55-29b8-495f-b89f-87c10d397607.png

1682759504191-60604584-3244-4915-abf4-efb31716cf17.png 

1682759530703-72149b65-cbdc-4d56-ab4e-6c4868e31956.png

1682759667488-9a1306c4-7b77-4a69-9dc0-3c2c734afdea.png 

1682759702781-840a6cf6-a36d-44f9-b61f-1696e5444b5a.png 

1682759782757-bc8d2dda-e847-486b-b78b-58396588fee6.png

### 结构样式2:一体注塑成型件（适应EHS要求严苛的场景）
## TBD
## 料车对中限位
## 结构样式1： 参考料号
*此结构为6061铝块机加工而成，采用3M背胶固定于地面，成本过高，且容易脱落，建议仅参照定位结构，后续尽量避免使用此类结构。
1682774307697-fb3c342e-825f-4762-b42d-8cab9210a36b.png

1682775173647-b17c3a4d-a075-45b8-acb2-8aff55f9bb1f.png

### 结构样式2:一体注塑成型件（低成本方案，地脚螺栓固定）
## TBD
## 链板线、辊筒线等输送线体接驳口对中限位
## 链板线下线导正机构
1682773434830-9d71e4d6-0a9f-46ca-8ed1-e276cf021ca7.png

1682773553268-656eb76a-105a-45e4-b7d1-5e7840228268.png

## 辊筒线下线导正机构
1682774024454-0574b449-ef17-45d4-a950-e28ea72ef50b.png

## 设备对接
## 专机设备对接
怎么定义专机设备，就是客户生产设备或者生产过程中必要的辅助自动化设备就可以定义为专机设备。例如：打包机、SMT设备、半导体生产设备等
## 交通设施

## 有效状态

## 是

## 参考项目

济宁山推驾驶室室外牵引车项目，徐州卡特彼勒PT车间室外转运项目等
1682777410236-5a3baa37-cb43-4feb-980b-eb855a1aefd4.png

### *此PPT截图仅作为案例导引，交通灯交互逻辑视现场场景而定
## 室外交通灯系统
## 5G通讯室外交通灯
### *参考料号0303504026 交通灯系统
1682777525399-3a99f41a-3081-4c19-9d45-107e13b46fee.png

## Wifi通讯室外交通灯
1682778281231-cb1e27b6-686d-4e76-a016-6677ae9c605b.png

## 室内交通灯系统
## 业务规划
## 大型项目 RDS 注意事项

## 有效状态

## 是

## 参考项目

## 珠海飞利浦工厂顶升车项目
如果在部署项目后，客户处于持续生产状态，更新 RDS 及 RDS Core，可能会导致现场停产。建议在现场部署一台 测试服务器 ，所有的软件更新，在测试服务器内运行无误后，再找时间窗口切换至 生产服务器 。
1687261695316-fe6cdfa6-9d56-4926-ba49-b45579b7c4c9.png

在 RDS 与上层系统（MES，WMS，APS，SCADA）对接时，要提前确认并保证，上层系统下发 单号的唯一性。
## 顶升车的业务规划指导
## 业务分析
主要是针对现场的工艺流程、或者工序的理解和分析。
充分理解现场的业务需求之后，才能更好的进行后续的其他分析工作。
一条业务可以被分解为 若干条不一定有关联的运输任务或者非运输任务 。
对于一些简单的项目，一条业务可能只对应一条运输任务。
## 需要关注的问题
## 1) 理解终端客户的工艺流程
理解业务，明确需要做什么，梳理关键步骤。
物料。
什么物料：电池、布匹、晶元等。
不需要关注物料属性对业务的影响时，只需要关注载具。
## 载具要求。（多选）
托盘。
料架。
物料（载具）在空间上的变化。
例如：仓库 > 产线 > 缓存区 > 仓库。
### 物料的属性变化。（可能会影响运输工具的变化）
例如：原料 > 半成品1 > 半成品2 > ... > 成品 / 次品 。
业务分解。
分解的粒度。
分解的粒度并非越细越好，分的太细可能会导致大量空跑的现象。
分解的标准。
根据关键步骤分解流程。
根据限制条件分解流程。
有节拍要求，且多车分段执行，比一辆车从头跑到尾更快。
工艺流程导致物料在流转过程中，需要多种车型来搬运。
流程协作。
### （谁会在哪个阶段，以什么样的方式参与流程，参与的结果如何）
流程的参与者：产线滚筒、上位机、AMR、操作员等。
需要协作的阶段。
原料运输阶段。
半成品运输阶段。
成品运输阶段。
物料转运阶段。
其他。
参与的方式。
信号交互：放行信号，原料就位信号。
其他。
协作的结果。
开始下一个流程。
产线滚筒开始工作。
其他。
限制条件。
时间要求，例如节拍。
空间要求，例如甬道或者密集库。
## 全流程的业务描述
推荐用表格进行描述，可以配合图（流程图）、文进行必要的辅助说明。

## 阶段

## 描述

## 备注

## 0

## 流程开始

## （如有必要，请描述）

## 1

## 第一个阶段的描述

开始条件。
## 参与者 & 参与方式
机器人：搬运、 信号对接等。
产线滚筒：转运、信号对接等。
其他。
搬运的对象：物料、托盘等。
执行的要求。
时间开销。
路径要求。
其他。
阶段成果。
## ……（如有其他，请补充）

## ……

## ……

## ……

## n

## 最后一个阶段的描述

开始条件。
## 参与者 & 参与方式
机器人：搬运、 信号对接等。
产线滚筒：转运、信号对接等。
其他。
搬运的对象：物料、托盘等。
执行的要求。
时间开销。
路径要求。
其他。
阶段成果。
## ……（如有其他，请补充）

## n+1

## 流程结束

## （如有必要，请描述）

## 示例业务的流程说明
地牛将仓库的满料架搬运至产线，并通过 PDA 及时告知对应产线的操作员；
操作员会不定时将料架里面的物料清空之后，地牛在将产线的空托盘送回仓库。
## 全流程的业务描述

## 阶段

## 描述

## 备注

## 0

## 流程开始

无。

## 1

地牛将仓库指定库位上的满料架，搬运到指定的产线库位上，并及时通过 PDA 告知对应产线的操作员。

开始条件。
无。
## 参与者 & 参与方式
地牛：搬运。
操作员：信号交互。
PDA：信号交互。
## 搬运的对象
满料架。
执行的要求。
无。
阶段成果。
仓库的相关库位被清空。
物料被搬运至产线。
产线的操作员能及时知道满料架已经到产线了。

## 2

操作员处理满料架中的物料，直到次料架的所有物料都被清空了。

开始条件。
操作员接收到 PDA 的提示。
## 参与者 & 参与方式
操作员：信号交互，清空满料架（清空物料）。
PDA：信号交互。
## 处理的对象：
物料、料架。
执行的要求。
无。
阶段成果。
对应的满料架变成空料架。

## n

地牛将产线库位上的空料架搬运至仓库的空库位上。

开始条件。
无。
## 参与者 & 参与方式
机器人：搬运。
操作员：信号交互。
## 搬运的对象
空托盘。
执行的要求。
无。
阶段成果。
指定的产线库位上的空料架被搬走。
仓库的一个空库位上，多了一个空料架。

## n+1

## 流程结束

无。

## AMR 分析需要关注的问题
### （描述方式首选表格、另外可附图、文进行补充说明）
## AMR 分类（顶升车、叉车、地牛等)
## 项目需要几种 AMR ？
## 每种 AMR 的命名规则？
## 每种 AMR 的数量？
## AMR 分组
## 是否需要将 AMR 分组？
## 是否需要专组专用？
## 每组 AMR 的命名规则？
## 每组 AMR 的数量？
## 是否需要进行动态分组？
## 是否需要跨组支援？
## AMR 载具（托盘、料箱、工装）
每种/每组 AMR 能负载哪些载具。
AMR 操作载具时，是否需要加装工装。
## 不同的载具，分别对应现场的哪些业务？
## 示例

## 名称

## 类型

## 组别

## 数量

## 载具

## 任务

## 任务命名

## 备注

## Fork-XX

## 叉车

## -

## 5

## 托盘
## 料架

## 原料仓库到原料缓存区
## （料架，原料）

## MWtoMB

在成品仓库，人工将成品从料架上搬运至托盘；人工回收空料架。

## 成品缓存区到成品仓库
## （料架，成品）

## PBtoPW

## 成品仓库到发货缓存区
## （托盘，成品）

## PWtoSB

## AMB-N-XX

## 顶升车

## North

## 3

## 料架

## 原料缓存区到北边产线
## （料架，原料）

## MBtoNPS

## 北边产线到成品缓存区
## （料架，成品）

## NPStoPB

## AMB-S-XX

## 顶升车

## South

## 1

## 料架

## 原料缓存区到南边产线
## （料架，原料）

## MBtoSPS

## 南边产线到成品缓存区
## （料架，成品）

## SPStoPB

## 库位分析
为表述简单，下面一段文字将托盘、料架、栈板统称为“托盘”。实际文档中请注意具体载具，不要混淆。
## 需要关注的问题
### （描述方式首选表格、另外可附图、文进行补充说明）
## 库位（存放托盘的位置）
类型。
按库位的使用方式区分。
单一库位，任意 AMR 只在此库位上执行取货，或者放货。
复用库位，任意 AMR 即会在此库位上取货，又会在此库位上放货。
按库位的分布方式区分。
普通库位，或称为库位巷道，机器人可以较为自由的到达的库位。
库位队列，或称为列库、密集库，机器人只能到达每列库位的一端、或两端。
立库，一个库位上有多层，都可以自由取放任意层的托盘。
按托盘的摆放方式区分。
常规库位，一个库位最多可以放置一个托盘。
堆高库位（ 不是立库 ），一个库位可以堆高多个托盘。
名称 & 命名规则。

## 关键词
## （中文）

## 关键词
## （英文）

## 命名规则

## 示例

## 产线

## PS

## PS-XXX

产线 1 号库位：PS-01 。

## 仓库

## WS

## WS-XXX

仓库 1 号库位：WS-01 。

## 前置库位

## PRE

## PRE-XXX

产线 1 号库位的前置库位：PRE-PS-01 。

## 缓存

## BUF

## BUF-XXX

缓存区 1 号库位：BUF-01 。

## 暂存

## TEMP

## TEMP-XXX

暂存区 1 号库位：TEMP-01 。

## 原料

## MAT

## MAT-XXX

原料存放区 1 号库位：MAT-01 。

## 其他

## (视情况而定)

## (视情况而定)

如果无法通过对应的英文单词或缩写，来命名库位，也可以通过库位中文名称的首字母缩写来命名，例如： 半成品 1 号库位 可以被命名为 BCP-01 ，如果这个库 是属于产线的 ，则应该命名为 PS-BCP-01 。
## 库位编号的要求 ：
为了 便于库位排序 ，库位编号建议按照同类型库位数量的位数命名。例如：
## ① A 产线有 8 个库位时：
格式为 PS-A-X，第一个库位的名称为 PS-A-1。
## ② A 产线有 10 个库位时：
格式为 PS-A-XX，第一个库位的名称为 PS-A-01。
## ③ A 产线有 100 个库位时：
格式为 PS-A-XXX，第一个库位的名称为 PS-A-001。
数量。
库位上的货物信息（载具类型、物料类型）。
## 库区（若干库位的集合）
分类（产线、仓库、缓存区、暂存区等）。
名称 & 命名规则。
参考【 库位分析  >  库位 > 名称 & 命名规范 】（请手动跳转T_T）。
数量。
区域中存放的货物信息（载具类型、物料类型）。
## 库位管理方式
不管理（哪些库位不需要管理）。
要管理（哪些库位需要管理）。
逻辑管理，RDS 根据业务逻辑标记库位状态，必要时（例如任务异常结束）需要人工干预。
人工管理，人工操作完库位（人机混用的库位）上的托盘之后，通过 PDA 等设备，更新 RDS 的库位状态。
传感器管理，光电传感器采集到库位状态之后，通过网络协议（推荐 ModbusTcp，或者 OPC-UA ），告知 RDS 库位状态。
本质上是 Core 在直接处理光电信息，RDS 通过 Core 的接口获取库位信息 。
RoboView，通过 RoboView 采集库位信息，同时 RDS 和 RoboView 交互，获取库位信息。
本质上 是 Core 在直接获取 RoboView 的结果，RDS 再通过 Core 的接口获取库位信息 。
客户自己管理（AMR 取/放托盘，需要通知客户系统）。
## 物料管理
## 简单的物料管理
物料信息结构单一，只需要管理物料名称，或者物料类别。
只存在 整/零 存取物料的情况，每次操作一整个托盘的物料。
复杂的物料管理（转 MWMS）。
同时维护多维度的物料信息（名称、类型、数量）。
物料信息统计。
物料盘点。
## 示例

## 库区名称

## 类别

## 数量

## 管理方式

## 载具

## 说明及命名规则

## 原材料仓库存放区
## （A区）

## 密集库位

## 22（行） * 3（列） = 66

## 人机混用，每个库位有光电传感器

## 托盘

每行提供一种原料，每种原料最多3托。
MAT-WS-XX-YY，XX是行（01-22），YY是列（01-03）

## 原材料仓库外缓冲区
## （B区）

## 常规缓存库位

## 3

## AGV专用

## 托盘

原材料从仓库运输到产线，缓存此区域。
### MAT-WS-BF-XX，XX取值01-03

## 成品摆放区
## （C区，也可能不这么分区）

## 高架库位

## 3层，每层10个，共30库位

## 人机混用，人操作后使用PDA修正库位

## 托盘

PS-MAT-XX。XX取值01-30，顶层自左至右为01-10，中间层自左至右为11-20

## 线边上料

## 辊筒对接

## 10

## 无需管理

## 料篮

采用DMS传感器进行对接。
## PS-UP-XX，XX取值01-10

## 补充文字示例：
## 注意：
对于 A 区库位，Core 连接相应的 PLC 来获取光电传感器的数据，通信协议是ModbusTcp 。
对于 A 区库位，其光电传感器将数据传输给客户 WCS ，Core 通过向 WCS 发送Web 请求来获取数据。
## 设备分析
## 需要关注的问题
分类。
门控。
梯控。
PAD（ Android 平板）。
PDA（ Android 的手持器/手持端）。
上位系统（MES、WMS、WCS等）。
用途。
下单，创建新任务。
放行，让机器人继续执行任务。
更新库位状态。
查看系统信息（任务信息、机器人信息、库位信息）。
设备交互的方式。
HTTP.
## ModbusTcp
## OPC-UA
## 示例

## 序号

## 设备

## 数量

## 用途

## 备注

## 1

## 门控

## 2

## 控制自动门

采用标准的门控协议。
一个门控独立控制一个自动门。

## 2

## 梯控

## 2

## 控制电梯

一个采用标准的 ModbusTcp 梯控协议。
一个采用金博的梯控。

## 3

## PDA

## 3

下单。
更新库位状态。
查看任务信息。
查看库位信息。
查看机器人状态。

产线端 3 个。
A 产线的 PDA 包含所有功能。
B 产线的 PDA 包含 3、4、5 号功能。
C 产线的 PDA 包含 1、3、4、5 号功能。
仓库端 1 个。
仓库端的 PDA 包含 2、3、4、5 号功能。

## 4

## 光电传感器

## 20

## 检测库位状态

Core 采用 ModbusTcp 协议，通过 PLC 采集光电信息，需要做信号防抖处理。
### 10 个用于检测 A 区域的库位状态，另外 10 个用于检测 B 区域的库位状态；分别通过两个独立的 PLC 采集信号。

## 5

## PLC

## 2

## 采集光电信息

支持 ModbusTcp 协议。
分别用于采集 A 区域和 B 区域的光电信息。

## 任务分析
基于业务分析，在理解现场业务流程之后，将业务细分为若干条任务，并根据实际情况，对任务进行详细的分析，必须明确任务流程的关键步骤。
## 需要关注的问题
### （描述方式首选表格、另外可附图、文进行补充说明）
## 任务分类
## 运输任务
需要 AMR 参与的任务，例如：物料搬运。
## 非运输任务
不需要 AMR 参与的任务，例如：通过PDA更新库位状态。
任务的发起方式。
客户的上位机（MES、WMS、WCS等），通过调用指定的接口发起任务。
通过 RDS 的 手持端 发起任务。
参数的选择方式。
手动输入。
扫码（选项较多，或者参数的值不是固定值）。
下拉框选择（选项较少时）。
满足一定条件之后，系统自动发起任务。如检测 PLC 信号。
任务参数。
视情况而定。
例如：要让任意机器人把托盘从 A 库位搬运至 B 库位，则可以将起点库位 A ，和终点库位 B 作为任务参数。
任务的执行逻辑。
简单逻辑。
优先级，优先级高度的任务优先被执行。
就近原则，选择里任务起点最近的机器人执行任务。
创建时间，优先执行创建时间最早的任务。
## ……
复杂逻辑。
按照现场的工艺流程执行任务。
多种简单逻辑，按照一定权值的组合。
## ……
任务开始执行的条件。
## 例如：
起点库位被处于被占用状态之后。
起点和终点都被锁定之后。
任务的关键步骤。
## 是否存在信号对接？
内容（ I/O信号（开门信号 、 开门到位信号） 、 任务状态 等）。
时机（ 任务开始时 、 取走起点托盘时 、 任务结束时 等）。
方式（ HTTP 、 ModbusTcp 、 OPC-UA 、 DMS 等）。
可靠性（失败之后 一直尝试直到成功 、失败之后 最多尝试 N 次 等）。
## 例如：
RDS 的 输出信号 ：AMR 从起点取走托盘之后，需要告知上位机 AMR 当前的任务 ID 和 起点库位 ID ，并且再上报成功之后，才能继续去终点放货；如果连续 5 次上报失败，则不再上报，并继续去终点放货。
RDS 的 输入信号 ：AMR 从起点取走货物之后，原地等待上位机的 放行信号 ，必须得在 RDS 收到放行信号之后，AMR 才只能继续去终点放货。
## 是否需要记录指定的数据？
内容（时间戳、耗时、）。
时机（ 任务开始时 、 取走起点托盘时 、 任务结束时 等）。
方式（记录到数据库中、指定文件中等）。
例如：RDS 接收到放行信号时，记录当时的时间戳。
## 全流程的任务描述
带 * 的阶段或者步骤对应的内容，必须描述清楚；其他的若无要求，可以不写。
推荐用表格进行描述，可以配合图（流程图）、文进行必要的辅助说明

## 序号

## 阶段

## 步骤

## 说明 / 示例
## (多选项，请根据实际要求填写。)
## （序号不代表先后。）

## 备注

## 1

## * 概述

## -

### 对此任务的关键信息进行描述，包括但不限于：
任务的概述。
例如：物料从仓库到产线。
任务的发起方式。
例如：通过 PDA 发起任务。
任务参数。
例如：起点名称和终点名称。
参数的输入方式。
例如：扫码。
## ……（如有其他，请补充）
## （ 关系到接口的设计 ）

## 2

## 处理请求

* 生成任务的前置条件检查。

## 描述系统生产任务的必要条件，例如：
## 任务参数是否合法？
## 是否需要防止重复下单？
是否成功抢占任务资源之后，才能创建任务？（ 需要考虑如果抢占失败导致创建任务失败，如何释放已抢占的资源 ）
## ……（如有其他，请补充）
## （ 满足所有条件之后，才能生成任务 ）

## 3

生成任务。

## （无需任何描述）

## 4

生成任务的后处理。

### 描述系统生成任务之后，需要执行的操作，例如：
将生成的任务的 ID 回传给上位机。
## ……（如有其他，请补充）

## 5

## 处理任务

## * 任务开始的前置条件

## 描述执行任务的必要条件，例如：
## 当前任务的前置任务是否已经结束？
## ……（如有其他，请补充）

## 6

任务开始。

## （无需任何描述）

## 7

## 任务开始后处理

### 描述开始执行任务之后，需要执行的操作，例如：
告知上位机，任务已经开始执行。
## ……（如有其他，请补充）

## 8

## * 第一项工作的前置条件

## 描述执行第一项工作的必要条件，例如：
锁定库位成功。
接收到上位机的放行信号。
## ……（如有其他，请补充）
（ 实际开发的过程中，部分条件可能已经在 第5步 执行了。 ）

## 9

## * 进行第一项工作

## 要尽量详细描述工作内容。 例如：
叉车去起点，先进行识别，然后通过 ForkLoad 操作，取走货物，取货前的货叉高度为 a ，取货后的或者高度为 b 。
### （ 不描述清楚，会影响开发工作的进行 ）

## 10

## 第一项工作的后处理

### 描述完成第一项工作之后，需要执行的操作，例如：
告知上位机，第一项工作已经结束。
## ……（如有其他，请补充）

## 11

## ……
## (参考第一项工作)

## ……
## (参考第一项工作)

## 12

## * 最后一项工作的前置条件

## 描述执行最后一项工作的必要条件，例如：
锁定库位成功。
接收到上位机的放行信号。
## ……（如有其他，请补充）
（ 实际开发的过程中，部分条件可能已经在 第5步 执行了。 ）

## 13

## * 进行最后一项工作

要尽量详细描述工作内容。
### （ 不描述清楚，会影响开发工作的进行 ）

## 14

## 最后一项工作的后处理

### 描述完成最后一项工作之后，需要执行的操作，例如：
告知上位机，第一项工作已经结束。
## ……（如有其他，请补充）

## 15

任务结束。

## （无需任何描述）

## 16

## 任务结束后处理

告知上位机，任务已经结束。
## ……（如有其他，请补充）

## 示例
## 任务要求
现场所有库位都是平面库位，所有库位的状态通过逻辑管理。
要求叉车将仓库指定库位的托盘，搬运到指定的产线工位上。
取托盘之前 需要识别 。
取货时货叉的高度为 a，取货后货叉的高度为 b。
取走仓库的托盘后，立即通过HTTP请求告知上位机托盘被取走了。
放货之前 不需要识别 。
放货后货叉的高度为 c。
任务结束之后，也需要通过HTTP请求告知上位机，此任务已经结束了。
现场有 6 条产线，每条产线都有一台可以发起任务的 PDA。
现场的 2 台叉车需要满足所有产线的搬运任务。
不能重复创建任务，即系统中只能有一条从 A 到 B 的任务。
## 全流程任务说明

## 序号

## 阶段

## 步骤

## 说明 / 示例

## 备注

## 1

## * 概述

## -

### 将仓库的托盘，搬运至产线。（ 满足要求 2 ）
### 通过产线端的 PDA 发起任务。（ 满足要求 3 ）
## 需要传递的参数有（ 满足要求 2 ）：
起点名称（扫码输入）。
终点名称（扫码输入）。

接口定制；文档+用例。

## 2

## 处理请求

* 生成任务的前置条件检查。

请求中存在起点名称 A 和终点名称 B 。（ 满足要求 2 ）
起点名称和终点名称必须是系统中存在的库位名称。（ 满足要求 2 ）
系统中不存在还未结束的，并且是从 A 到 B 的搬运任务。（ 满足要求 5 ）
### 起点 A 必须是被占用状态。（ 满足要求 1 ）
### 终点 B 必须是未被占用的状态。（ 满足要求 1 ）
立即锁定起点和终点。（ 满足要求 2 和 3 ，锁定库位失败，导致创建任务失败时，需要合理的释放资源，并给上位机返回明确的失败原因，例如“锁定终点库位【B】失败” ）
（此任务只描述了整场业务的一部分，从库位的占用状态的变化来看，并未达到逻辑闭环，逻辑不自洽，存在隐患。因此， 任务分析之前，必须进行业务分析 。）

多车多任务，存在资源（库位）竞争，任务创建之前必须立即抢占资源（锁定库位）。否则可能会出问题。
创建任务失败时，必须给上位机返回明确的失败原因。在接口文档中进行说明。

## 3

生成任务。

无。

## 4

生成任务的后处理。

无。

## 5

## 处理任务

## * 任务开始的前置条件

锁定起点库位。
锁定终点库位。
无。

步骤 2 已经锁定起点和终点了。

## 6

任务开始。

无。

## 7

## 任务开始后处理

无。

## 8

## * 第一项工作的前置条件

锁定起点库位。
无。

步骤 2 已经锁定起点了。

## 9

## * 进行第一项工作

### 叉车取货之前，先进行识别。（ 满足要求 2 ）
执行取货操作，取货时货叉高度为 a ，取货后的货叉高度为 b 。（ 满足要求 2 ）

操作： ForkLoad。
属性： recognize=true，start_height=a，end_height=b。

## 10

## 第一项工作的后处理

通过 HTTP 协议告知上位机，库位【A】上的托盘被取走了。（ 满足要求 2 ）
### 解除起点库位的占用状态。（ 逻辑闭环 ）
## 解锁起点库位。（ 逻辑闭环 ）
（如果现场是立库，从高层的库位取货之后，货叉的高度较高，为了降低叉车的重型，提高叉车载货后的稳定性，需要将货叉的高度调整到安全的行驶高度。）

接口定制；文档+用例。

## 11

## * 最后一项工作的前置条件

锁定终点库位。
无。

步骤 2 已经锁定终点了。

## 12

## * 进行最后一项工作

叉车去终点放货，放货后的高度为 c。

操作： ForkLoad。
属性： recognize=false，end_height=c。

## 13

## 最后一项工作的后处理

将终点库位设置为占用状态。
解锁终点库位。

需求 2 要求是 在任务结束之后 再告知上位机任务结束，而不是在终点放下货物之后。

## 14

任务结束。

## 无

## 15

## 任务结束后处理

告知上位机，任务已经结束。

接口定制；文档+用例。
## 接口分析&设计
接口分析和设计时，都是从 RDS 的角度去考虑的。
## 需要关注的问题
接口的作用。
数据流向。
请求方。
响应方。
协议类型。
TCP。
HTTP。
ModbusTcp。
OPC-UA。
其他。
## 参数及其类型。（常见的基本数据类型）
响应。
## 示例
## HTTP 协议（常用）
## 接口描述
描述此接口的作用。
例如：此接口描述了如何获取机器人信息。
## 请求方式
## GET
## POST
## PUT
## DELETE
## URL
描述此接口的访问路基，以及路径参数和查询参数。
例如： http://host:port/api/vehilces/{name} 。
## 请求
描述此接口的请求正文，一般为 JSON 格式的数据。
例如： {"fromSite":"A","toSite":"B"}
## 响应
描述此接口的响应码和响应正文，一般为 JSON 格式的数据。
例如：请求成功时，响应码为 200；响应正文为： {"code":"0","msg":"success"} 。
## 用例
简单描述此接口的用法。
参考 SRD 的 Web API 协议中的接口描述。： Swagger UI 。
## ModbusTcp 协议（常用）
## 协议描述
描述此接口的作用。
例如：此协议描述了 RDS 和产线滚筒的对接信号。
## 协议内容

## 描述

## 地址类型

## 地址编号

## 数据流向

## 备注

## AMR 就位

## 4x

## 1

写：RDS。
读：产线滚筒。

0：AMR 未就位。
1：AMR 已就位。

## AMR 开始上料
## (物料到 AMR 上)

## 4x

## 2

写：RDS。
读：产线滚筒。

0：AMR 未开始上料。
1：AMR 上料中。
2：AMR 上料结束。

## AMR 开始下料
## (物料离开 AMR )

## 4x

## 3

写：RDS。
读：产线滚筒。

0：AMR 未下料。
1：AMR 下料中。
2：AMR 下料结束。

## ……

## ……

## ……

## ……

## ……
参考 SRD 的标准梯控协议 ModbusTcp 版。
## TCP 协议
### TCP协议由报文和数据区两部分组成，协议格式的示例如下：

## 名称

## 长度
## (byte)

## 默认值
## （Hex）

## 备注

## 报头

## 报文起始标志

## 2

## 5a50

## 流水号

## 2

## 0

确保唯一性。

## 数据区长度

## 4

## 0

## 数据区

## 数据

## n

## -

传递的内容。
参考 RBK 的 Net Protocol 协议。
## 无线网络
## 无线网络勘察
企业网络架构拓扑图说明。典型的企业局域网络架构如下图，
1681194196960-89c03477-a078-4f5b-9120-3f145783fa0a.png

## 主要包含如下设备：
工业路由器：实现了 路由信息更新、路由表维护、路由计算、路由确定、内往外互联、网络管理等功能。
核心交换机：主要负责大型局域网内部的数据交换，对于物理硬件的要求极高。所以对于区域内的汇聚交换机、数据交互内容较多的服务器，都部署在核心交换机上，从而保证数据的保真性。
应用服务器：对于企业内部的一些数字化应用和管理系统，例如 MES、ERP、WMS 以及我们熟知的AGV 调度系统，都部署在应用服务器上。
汇聚交换机：为了给核心交换机减负，汇聚交换机在网络中充当了分布式模块的作用。一般情况下，汇聚交换机集成 AC 无线接入控制服务器，管理 AP 配置、无线用户访问的认证、带宽控制和安全措施保障等。
AP：无线接入点（Access Point），为各种设备（AMR/产线端设备等）提供无线接入局域网的服务。
当现场有多个局域网络都需要和我们的系统服务器进行通信时，要注意服务器的有线网卡配置（目前 T140 有 2 个有线网卡）。 超出时建议加工业级服务器内置网卡 。
海外使用无线客户端时，优先考虑 MOXA，注意 EU 版本和 US 版本的区别，北美只能用 US 版本，其他地区可用 EU 版本。
## WIFI 标准说明
目前 AMR 内置无线网卡适配的 WIFI 标准是 IEEE 802.11a/b/g/n/ac，具体技术标准执行如下表 ：

## 技术标准

### 802.11

### 802.11a

### 802.11b

### 802.11g

### 802.11n

### 802.11ac

## 工作频率范围

### 2.4GHZ

### 5.150-5.350GHZ
### 5.475-5.725GHZ
### 5.725-5.850GHZ

### 2.4-2.4835GHZ

### 2.4-2.4835GHZ

### 2.4-2.4835GHZ
### 5.150-5.850GHZ

### 2.4GHZ/5GHZ

## 最大传输速率

## 2Mps

## 54Mps

## 11Mps

## 54Mps

## 540Mps

## 400M 2.4GHZ
## 9000M 5GHZ
对于 IEEE 802.11a/b/g/n/ac 的 WIIFI 协议族和我司控制器入网要求说明如下（* 表示 DFS 动态频率选择 信道，请参考国家法规） ：
### 我司控制器的无线网卡支持频率和信道对应关系：
### 2.412 to 2.472 GHz （ 13 channels），具体信道号为 1，2，3，4，5，6，7，8，9，10，11，12，13。
### 5.180 to 5.240 GHz （ 4 channels），具体信道号为 36，40，44，48。
### 5.260 to 5.320 GHz （ 4 channels）*，具体信道号为 52，56，60，64。
5.500 to 5.700 GHz （ 11 channels）*，具体信道号为 100，104，108，112，116，120，124，128，132，136，140。
目前我们控制器网卡可以支持 IEEE802.11ax（既 WIFI6）。
一般情况下目前试用的规范都是 802.11ac（即 WIFI5）。
我司控制器集成的无线网卡不支持网关桥接和 NAT 映射模式。
AMR 需要固定 IP 地址。
## 网络稳定性勘察项
通过上述对于网络架构拓扑的认识，SR 在现场勘察时，需向客户确认 AMR 设备和现场 AP 之间的网络稳定性（不考虑我方实施部署网络设备的情况，我方网络供应商会保证 AMR 的网络运行环境），故核心的勘察目标是 AP：
勘察 AP 在 AMR 行进路线中是否有布局，确保 AMR 在整个运行过程中都具备无线信号的覆盖。
确认客户 AP 的部署标准是什么（即上述 WIFI 标准），保证我司控制器中的网卡可以支持相应的 WIFI 执行标准。
确认终端部署的 AP 信道属于国标/欧标/美标/其他标准，主要是确认各个标准之间是否有重合的信道。具体对照表参考公开链接 各地区 2.4GHz 及 5GHz Wi-Fi 信道一览表 。
使用 Roboshop 网络测试工具（ 网络分析方法）或 福禄克测试仪（ TODO） ，测试现场网络质量。平均延迟需要保持在 100ms 以内，信号强度 -60dBm 以上，带宽在 100Mbit/s 以上。目标要保证 AMR 和调度服务器之间连接稳定 。
如果客户现场尚未搭建无线网络，优先考虑搭 5GHz 网络；
对于防火墙有端口加密过滤要求的网络，需要提前明确告知客户我方系统所有端口号，且要求端口是双向数据传输，不允许单端数据截流；我司系统端口要求参考:常用端口

## 现场实际应用分析

## 序号

## 场景

## 场景图示

## 场景说明

## 场景对零部件选型注意事项

## 1

## 密集料架库应用场景

## 密集料架库应用场景1：
## image4.png

## 1.该场景为 AMR 转运过程中 左右/前后 侧存在大量需要进行取放的载具；
### 2.由于车辆周围部满了动态移动的料架，所以地图变化率很高，此时可采用反光柱导航/二维码导航方式；
### 3.此类应用不建议使用料架腿形状识别功能，因为可能会把相邻的料架腿识别成当前预置的料架模型；

## 导航单元的选择影响

## 1.如果该场景使用反光柱导航的方式，不能使用 sick 激光作为反光柱识别的激光（因为sick 对高反光物体的识别特别敏感，会导致误识别）；
### 2.如果使用反光条识别的自动充电方式，也不能使用 sick 激光作为反光柱识别的激光；
### 3.对于使用激光来进行反光条料架的载具识别中，同样也不能使用 sick 激光作为反光柱识别的激光；
### 4.如果避障激光也用于上述所述的识别/导航的场景不建议使用 sick 品牌；
### 5.如果采用下视读码相机的二维码导航方案，在过道左右侧可以保证不丢失定位，可以替代反光柱导航方式；
### 6.如果需要移动机器人在潜入料架底保证料架和机器人之间比较精确的相对位置关系（± 5mm 内）需要加装上视读码相机，并在料架上粘贴定位用二维码；

## 对载具设计和调整的影响

1.如果采用了上视二维码读码相机的二次定位方式，如果也需要多料架达到车和料架相对位置精度在在 ±5mm 的要求，则对于料架的加工和二维码的粘贴误差可能丝级别的，一般是做不到，所以多料架的重复 定位精度［１］ 取决硬件本身；
### 2.如果采用下视二维码导航方式，则取放工位处载具有如下情况需要进行相应调整：
### 2.1 此时需要采用上视读码相机应用，考虑到节拍，不应该在料架处工位地面粘贴二维码做二次定位，所以可以采用激光识别料架的方式进入料架底；
2.2 如果终点处地面粘贴二维码，保证车体和地面二位码的相对位置，此时不采用上视读码相机又需要进行精确定位的，需要使用地面固定式装置来保证料架和地面二维码的相对位置关系，从而保证车和料架之间的相对位置关系；
2.3 如果终点处地面粘贴二维码，因为 前置点［２］ 到取放料架位置，两个二维码之间是 开环运动［３］ ，所以车有概率会偏执两个二维码中心连线的这条直线，所以需要保证车体和料架之间的
单边间距 ［４］ ；
3.如果采用激光识别料架腿（形状识别/反光条识别），需要保证料架腿材质不反光，且非黑色材质（因为激光雷达 的 TOF 物理原理），且保证车体和料架腿单边间距在 70mm 左右，料架间距保持在 30 mm 以上；

## 2

## 地面固定式料架+载具应用场景

## 地面固定式料架+载具应用场景1
## image5.png

### 固定式支架形状包含两种，一种是有斜支撑架如下图所示：
## image6.png

## 另一种是无斜支撑架如左图所示

## 导航单元的选择影响

## 1.斜支撑架场景下，斜支撑架最顶端距离应大于车体宽度，同时固定式支架本身安装宽度如果小于车体长度，则不支持随动功能。
### 2.此场景一般采用激光形状识别和上视二维码二次调整，如果采用反光条料架的识别中，不能使用 sick 激光作为反光柱识别的激光
### 3.如果避障激光也用于上述所述的识别/导航的场景不建议使用 sick 品牌；
4.如果需要移动机器人在潜入料架底保证料架和机器人之间比较精确的相对位置关系（± 5mm 内）机上视二维码二次调整，需要加装上视读码相机，并在料架上粘贴定位用二维码；

## 对载具设计和调整的影响

## 1.固定支架的外间距应大于料架宽度，内间距小于料架宽度，同时内间距大于车体顶升盘宽度。
2.如果采用激光识别料架腿（形状识别/放光条识别），需要保证料架腿材质不反光，且非黑色材质（因为激光雷达 的 TOF 物理原理），且保证车体和料架腿单边间距在 70mm 左右，料架间距保持在 30 mm 以上。
### 3.货架、料架设计说明请参照顶升车货架识别-反光贴识别中货架设计说明
## image7.png

## 3

## 上下视双pgv场景

## 无

## 1、采用SRC2000、src880\src3000造车
### 2、上下视均配备读码相机并用于定位调整

## 对pgv设备选型的影响

除了倍加福，其他品牌的两个PGV ，不能接在同一个总线上，否则会出现数据解析错误。原因是因为 倍加福PGV 有地址位可以接在同一根总线上，其他品牌不支持。

## 4

## 二维码导航+栈板识别场景

## 无

场景中同时需要下视 PGV 和料架识别(反光条/轮廓识别):

## 对功能配置的影响

 1、如果 AP 点用二维码导航此时是不能使用料架识别的，因为在使用料架识别时候，这个时候如果料架放歪了之后，AMR 是会报 “机器人找不到二维码”的报错，所以对于维码导航和料架识别的应用场景，AP 点就不能粘贴二维码，二维码只能贴到该 AP 点库位的前置点。
### 2、前置点和AP 点的导航方式也不能选二维码导航，而应该是 SLAM 自然导航的方式.
## 应用场景案例
常见的潜伏式顶升应用常见如下列视频所展示，通过下列场景中的展示，能够对比您终端客户的场景，并且进行一定程度上的引导作用。
以下为视频卡片。

大金空调-家电制造-场景-AMB-300J-20220422.mp4
## 场景 1：潜伏式顶升的移动式料架搬运

金峰-行业-顶升车跨电梯-顶升机器人-AMB-20220421.mp4
## 场景 2：潜伏式顶升的电梯联动

浙江绿源-电动车制造-AMB-800K-20230223.mp4
### 场景 3：潜伏式旋转顶升的异形超窄料架搬运
## 附录：
## 1.名词解释
定位精度［１］ ：需要区分重复定位精度，绝对精度，对接精度的区别，以上“精度”讨论范围都是对于一台单车来说，例如重复定位精度一般指的是车辆的里程中心（即车辆的旋转半径）重复到达世界坐标系地图下同一个点的重复误差；绝对精度一般指的是硬件参数计算出来的误差（例如一个轮子半径为１００ｍｍ　的轮子，编电机编码器抖动精度是１０ｃｎｔ脉冲，编码器精度是５００００Ｐ／Ｒ　那一般说这个轮子的行走误差是２×３.１４×１００ｍｍ×１０／５００００＝０.０４２６　ｍｍ，这里还有没有计入考虑的其他变量）
前置点［２］：前置点一般处于AP点前，在此处完成识别相机、识别激光的识别动作，用于后续的路径导航和作业，一般距离AP点 1.5 m左右间距处。
开环运行［３］：不将运动后的结果反馈回来影响当前运动过程 。
单边间距 ［４］： 单边间距指的是潜伏式顶升 AMR 在移动过程中,车辆一侧距离一侧料架腿内侧间距
## image8.png

## 图：名词解释-单边间距
