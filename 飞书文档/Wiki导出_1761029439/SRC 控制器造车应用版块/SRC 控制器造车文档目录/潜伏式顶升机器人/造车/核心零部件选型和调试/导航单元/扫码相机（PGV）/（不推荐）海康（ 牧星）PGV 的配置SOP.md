# （不推荐）海康（ 牧星）PGV 的配置SOP

### （不推荐）海康（ 牧星）PGV 的配置SOP

## 版本

## 更新日期

## 更新说明

## 文档状态

## 维护责任人

## V1.0

### 2024.3.15

## 初版

## 使用中

因海康性能问题，暂时停用，在系统可售之前请勿使用此造车方案。具体进度可咨询相关产品经理。
## 选型说明
本应用示例采用海康读码相机，适用型号SC2005AM，视野距离100mm（± 20mm），建议安装高度在100mm±5mm以内(该值即模型文件中的Z值)
## 内参配置
固件烧录及线束定义等详细内容可参照海康读码相机-SC2005AM
## 海康上位机使用
## 读码相机调试上位机

SmartMVS_STD_1.0.0_180713(1).rar

### IDMVS_STD_2.2.0_200820.rar
## 支持rbk版本：
## rbk 3.4.5.26及以上
## 底层固件 2.1.66及以上
## 上位机参数配置
## 读码参数配置
### DM12的Data Matrix版本号是2
### DM14的Data Matrix版本号是3
## 通信方式选串口
### 如果遇到切换为串口通信画面无输出，修改如下参数
## 右键设备，点击属性树
1691392394778-cf796488-6398-479d-9d3d-40feed7184e8.png

## 勾选该参数即可
1691392462640-cc914ffa-bbe7-4b75-9ea4-e86d6fb3232a.png

## 设备通信连接
### 使用网线连接电脑和 读码相机 ，打开配置软件
1677571246363-cab2e0f6-64fd-4fbd-a9ea-56e82c16c409.png

## 序号

## 名称

## 功能简述

## 1

## 菜单栏

可对客户端基础功能进行设置， 还可对设备进行 IP 配置和固件升级等

## 2

## 控制工具条

可同时对多台设备批量开始/停止采集，设置客户端的画面布局， 统计设备的读码信息、查看设备的日志信息等

## 3

## 相机配置

可对设备进行相关操作，包括连接/断开设备、参数设置、 IP 地址设置等

## 4

预览窗口 可实时预览设备当前采集的图像和算法读取的效果，同时还可进行录像、抓图、 绘制十字辅助线等

## 5

## 历史记录与图像缓存

## 1. 实时显示客户端当前读取到的条码信息 2. 缓存设备图像
## 配置读码相机的IP地址
配置 IP 地址仅用于连接 上位机 进行参数配置，不影响 485通信 
### 打开 IP配置工具 ，配置 读码相机 的网段和电脑一致
1677571278941-be778e5b-7f73-4405-bdbf-6a774ab9fb96.png

1677571296846-050d9f6b-cbe5-408a-81a1-c938d832f62a.png

### 配置完成后 重上电设备 ，之后即可在列表中连接设备

## 光源设置

打开镜头预览，可以看到视野内的扫码情况，调整光强和曝光值，防止光线过强二维码反光导致扫码失败
1691392216389-04b01808-fd4d-4db2-b085-322dd671ccb1.png

根据读码预览窗口的光源情况，和码制反馈调整光源，直至读码器可以清楚的读到二维码
1677571332011-ba623aec-bfa4-4813-935b-fe257c4c375b.png

1677571351165-37cd11d6-eace-40ed-8fec-db6db16e020c.png

## 串口配置
## 通信方式：串口
## 波特率：115200
## 校验位：无校验
1691392343648-ab0e2c90-7c4f-44fb-8902-36fbd73c05b5.png

## 配置DM码
## PGV二维码说明
### DM12的Data Matrix版本号是2
### DM14的Data Matrix版本号是3
1691392266106-7f61f941-9d2e-419b-bdef-bc7c8a19c800.png

## 监控画面输出
### 如果遇到切换为串口通信画面无输出，修改如下参数
## 右键设备，点击属性树
1691392394778-cf796488-6398-479d-9d3d-40feed7184e8.png

## 勾选该参数即可
1691392462640-cc914ffa-bbe7-4b75-9ea4-e86d6fb3232a.png

## 保存参数
## 修改完成后，保存参数
1677571391064-4120d611-2d6b-4881-b52c-215c9e8e4435.png

## 设备重上电
设备重上电后参数生效，重上电后再次检查参数是否生效，防止参数修改失败
## 模型文件配置
## 模型文件界面介绍
## 模型文件选择 SC 系列
## image.png

## Key

## Description

## Value

## Unit

## onOpenTime

## id

## x

## 在x轴位置

### 右手坐标系下的 x 位置，如小车模型中坐标

## m

## y

## 在y轴位置

### 右手坐标系下的 y 位置，如小车模型中坐标

## m

## z

## 在z轴位置

### 右手坐标系下的 z 位置，如小车模型中坐标

## m

## yaw

## 安装角度

## 右手坐标系下朝向角，如小车模型中坐标

## °

## upside

## xUnit

## x单位

PGV 返回 X 数值单位，换算为 m 需要乘的系数；可通过查看 PGV 使用说明书方式获得

## m

## xRange

## X 方向范围

PGV 能看到的 X 方向的范围，单位为 m，请根据实际情况进行填写

## °

## xUnit

## y单位

PGV 返回 Y 数值单位，换算为 m 需要乘的系数；可通过查看 PGV 使用说明书方式获得

## yRange

## Y 方向范围

PGV 能看到的 Y 方向的范围，单位为 m，请根据实际情况进行填写

## blinkDO

## DO设置

## angleUnit

## 角度单位

### PGV 返回角度信息的单位，换算为"°"时的单位

## brand

## 品牌名称

## 已适配可选用品牌

## func

## 功能选择

### adjust“调整”localization“定位”
### adjustLocalization“调整加定位”

## type

## 通讯线选择

## devName

## 接线引脚

## 模型参数配置

### 1）连接机器——【模型文件】——【PGV】——参数配置
1711013425904-b164a494-3bed-4bf3-bf83-fba0a681beae.png 

## 2）基础信息：
读码相机 的 yaw (r) 角，需要通过将二维码与车子平行，从 读码相机 中读取 angle 角，然后 读码相机 配置中的 yaw 即为 - angle .读取二维码角度值，yaw值填90°
1711014927148-1fecc0af-54ff-4c6d-85d8-ce5166a937b4.png

单位 xUnit 、 yUnit 为 读码相机 配置的原始数据和定位数据的单位比例值，按照实际配置填写；本文档配置坐标单位为0.1mm，所以填写0.0001m。
1711013796037-414ee64e-184e-4f9b-8411-f84ea0454391.png

## 3）功能
## 图片.png

## 功能分为：调整、定位、调整和定位
一般上视配置为【adjust】,下视配置为【Localization】、【adjustlLocalization】，二维码导航也包含上视二维码调整需求，因而上图示上视可参考配置为【adjust】。
## 串口配置
海康 读码相机 不支持配置设备地址，所以一个 485 总线只能接一个设备，按照实际接线配置模型配置485编号。串口名称：
注意事项： SRC-880控制器造车采用485串口通讯，在模型文件配置时请注意：
SRC800和SRC880在模型文件中串口名称不一致，SRC800 在配置时，其“devname” 均为“/dev/ttyUart ”（数字以接口定义中实际使用的485口接线为准） ；SRC880控制器配置时“devname” 变更为“/dev/ttyS ”
1711088173017-085ea216-0292-42d1-ba91-442282904e66.png

## SRC-880造车串口配置示例：
1710904938476-8880e3f9-ae15-420c-8197-860deca0a6b6.jpeg

### 配置完成后可在【运行状态】-【读码相机】一栏看到读码信息
## PGV状态信息：
1711013694703-21653dbf-893d-45dd-bc4f-72cc7dc26fe6.png

## 标定
## 读码相机 标定方法详见此文档：
## 《PGV 标定》
## 《PGV-里程计标定》
## 功能验证

1）确保相机硬件正常，且接线完整。
2）确保模型文件配置正确。
1710839146547-968c019f-f0c6-4eef-bc84-cd9b91f3e9ec.png

3）将车体开到或者推到二维码上方。
1711015359736-9d65af6f-3497-4cda-8454-3f0c7c463811.jpeg 

4）在首页右侧功能列表点击【开始识别】。
1711015280267-fea9c11a-56eb-4074-8813-1b37204d6d65.png

能输出识别结果。
1711015307971-aae92fc5-e9ad-4aa0-bce4-a4136c54dec6.png

## 图片.png
