#  TP-LINK 网络设备配置 SOP 

## TP-LINK 网络设备配置 SOP

## 版本

## 更新日期

## 更新说明

## 文档状态

## 维护责任人

## V1.0

### 2024.3.21

## 初版

## 使用中

## 上位机参数配置
## 工作模式为 Client 模式
首先将 TP-LINK 客户端恢复出厂设置(按下 RESET 键10秒，待指示灯全亮即可)。

1686879754238-3899367d-4c1c-4cc2-88ca-f27eb8c06ae0.png

打开以太网的 Internet 协议属性，选中‘自动获得 IP 地址’与‘自动获得 DNS 服务器地址’，然后点击确定。

1684898764193-5f134eaf-d13e-4ed1-b202-29d4d976fff8.png

使用网线一端连接TP-LINK客户端，一端连接电脑。

使用浏览器(推荐谷歌浏览器)，在网址栏中输入 tplogin.cn  登录TP-LINK配置界面，并设置用户名，密码，推荐用户名：admin, 密码：tplink ； 强烈建议使用推荐的用户名与密码，这样其他工程师再次配置此客户端时，能迅速进入后台；

1684898948765-9f9a6b9f-6b18-4ae3-8187-1898a05286eb.png

设置完成后进入到如下页面，工作模式选择 Client 模式并点击【下一步】。

1684898965479-22fe59eb-8885-4b7c-ae8c-824ecdc20551.png

在无线设置页面，点击【扫描】，可扫描5G频段的无线网络，选中网络并连接，输入密码点击【下一步】就ok了。

1684898986136-df07936d-f0ae-4e77-926c-ca324574cc70.png

1684899006083-668f4240-1942-459c-b456-b40158414f00.png

在完成界面点击【确定】即可分配IP地址。

1684899029275-b85b0e98-ba6a-494f-ab23-397b0a0be666.png

分配成功后显示如下信息，下次登陆时在浏览器的地址栏中输入该IP就可直接登录首页。

1684899047001-5f04a4b9-8dd0-44fe-ba4d-8cf20d4798d8.png

1684899063662-b8e5fe9f-fbde-4ee8-b464-673c0f035b82.png

### 工作模式为Client-router模式
登录TP-LINK配置界面将模式切换为 Client-router

1684899080234-dcbc2f7f-d968-4fa0-838c-732d7203231d.png

【无线设置】的方法与 Clinet 模式的 6-8 一致；

连接成功后，在【首页】点击【网络】界面，可以看到网络为设备分配的Ip地址；注意此时可以使用网络自动为设备分配的IP地址，也可以根据现场需求配置固定IP，如下两图所示；

1684899094377-979e437a-d523-4977-b599-b7a2ff0c52ff.png

1684899109909-bbdb2020-1de9-4b90-8966-1db8d61b2483.png

在NAT模式下拉框选择N-1 NAT，协议选择为tcp通信协议，端口转发下拉框选择开启，点击'新增'，增加WAN端口号，LAN端口的IP地址以及LAN端口号，勾选启用并点击确认，配置的具体端口详见下表。

1684899129458-6faa8ae3-7df0-47d8-a549-6347e3df5624.png

端口转发ip 必须是192.168.192.5，下图上ip仅为示意。
1684899139669-c3bda6ef-6152-44b4-8932-c525ad31d414.png

### 使用 Client-Router 模式需要配置的端口转发

## 设备名称

## LAN 端口

## WAN 端口

## 说明

## 机器人

## 22

## 8022

## SSH 远程登录协议

## 3389

## 3389

## Windows 远程桌面

## 80

## 8080

### http，用于网页浏览（打开机器人的网页配置界面）

## 443

## 8443

基于 TLS/SSL 的网页浏览端口，能提供加密和通过安全端口传输的另一种 HTTP（打开机器人网页配置界面）

## 502

## 502

## MODBUS TCP 默认端口

## 19204

## 19204

## 机器人状态 API

## 19205

## 19205

## 机器人控制 API

## 19206

## 19206

## 机器人导航 API

## 19207

## 19207

## 机器人配置 API

## 19208

## 19208

## 高级配置

## 19210

## 19210

## 其他 API

## 19301

## 19301

## 机器人推送 API

## 6379

## 6379

## redis

## 15400

## 15400

## 调度 TCP 协议端口

## 8090

## 8090

## debug

## 8091

## 8091

## debug

## modbus设备

## 502

## 502

## modbus设备端口

## UR 机械臂

## 502

## 503

## MODBUS TCP 默认端口

## 29999

## 29999

## 远程控制

## 30001

## 30001

## 接收/发送

## 30002

## 30002

## 30003

## 30003

## 30004

## 30004

## 相机

## 3000

## 3000

## 通讯端口

## 充电桩

## 4001

## 4001

## 充电桩端口

## 5001

## 5001

## 错误通知端口

## 注意：
在配置机器人上使用的TL-1300D时至少要将上表中机器人相关的所有端口配置在设备中，modbus设备、UR机械臂、相机、充电根据具体需要进行添加；

使用TL-1300D连接上机器人控制器的单独网口（非核心控制器上交换机网口）；使用网线连接核心控制与调试电脑，打开roboshop-添加 192.168.192.5 -【高级配置】做如下配置。注意选择'禁用无线网卡'( 一定要选择禁用无线网卡，否则会引起网卡冲突 )，导致实现不了端口

1684899161964-05cc24a4-c9d2-48a2-8279-664970d0e791.png

1684899175151-04352362-aedf-420c-a2ef-085c20b0c6c4.png

禁用无线网卡后，将电脑与机器人控制器的通过无线进行连接，在【首页】点击【添加机器人】输入192.168.6.111。返回首页就可看到，之前的IP地址变成了6.111(即实现端口转发)。

1684899188624-cb7f3a52-bc68-4dc4-ae41-3fb919500ae8.png

## TP-LINK配置
（1）打开电脑浏览器，输入tplogin.cn，初次登录后根据提示设置用户名：admin, 密码：tplink。

1684898948765-9f9a6b9f-6b18-4ae3-8187-1898a05286eb.png
（2）如果在【快速设置界面】，点击【退出设置】，选择【系统】，在配置管理处点击【浏览】选择“配置文件”，点击【导入】，等待自动加载。
配置文件：下载附件中的压缩包，解压后的文件即为【配置文件】。
1710068199958-4beee293-057d-4fa6-a15e-ea82b5a9a2a9.png

（3）选择【无线】→【扫描】→ 选择合适的网络 → 输入密码 → 【确定】
1710068490806-3dac5e63-f32d-43a8-9529-1660c4ba48e2.png

## 漫游功能激活

## Wifi 漫游功能

## rbk_roaming

当用户现场有多个 AP 时，通过自研的 Wifi 漫游算法实现移动机器人在多个 AP 间快速稳定的漫游切换，保证调度系统连接的稳定性

### SRC-2000(S) 的硬件版本需 ≥ 1.2.11

### 3.2.8.0~latest，需配合 robod 2.7.4+
### 现场的 AP 部署需要满足一定的要求方能达到最优的漫游效果
## Warning 55510
提示： rbk_roaming is not activated.
## 触发条件：
当用到 Wifi 主动漫游功能，而 rbk_roaming 未激活时
## 解决方式：
激活后，机器人会清除这个错误 ，并可以重新进行投入工作。
## 漫游版本区分
### Robokit 3.3.5.58 之前的版本
## 由 Robokit 控制自带网卡漫游
1656485665037-fe8c856c-855a-40f1-8735-804dafb9a61d.png

Robokit 3.3.5.58 之后的版本 ，Robod 3.5.10+，Roboshop 2.4.1.14，由 Robod 控制自带网卡漫游 自带网卡漫游配置
漫游设置 （Roboshop 2.4.1.10 + Robod 3.5.10+）

## \

## Roboshop

## Robod

## 配套版本

### 2.4.1.10 +

### 3.5.10+
1657689275334-c242c5dd-ba51-4f97-a5d2-7fc9909f287a.png

## 打开高级配置
网卡漫游：必须使用自带的无线网卡才效果，必须激活 Robokit 的漫游功能
## 返回高级配置主页
## 漫游参数设置
开始扫描 AP 阈值 (dBm): 表示当前的 AP 信号强度低于 -65 时开始扫描可用的 AP
大于扫描 AP 阈值(dBm):表示当扫描 AP 大于当前的 AP 强度 7dBm 时才进行切换
### 例如: 扫描到 -58 = -65 + 7 开始切换
自动切换最优 AP 阈值(dBm): 表示当前 AP 强度低于 -78 时自动切换大于-78 的 AP
扫描 AP 间隔时间(ms)：扫描一次后等待 5000毫秒(5s) 再进行第二次扫描 （扫描 AP 仅在当前 AP 信号强度低于 -65 dBm 情况下）
仅漫游 5G AP ： 表示机器人漫游时只会切换 5G AP (没有满足条件的 5G AP 会断网也不会切换 2.4G)
## 禁用 IPv6: 禁止使用 IPv6
## 禁用 AP 漫游
## 提交：修改的参数只有点击提交才生效
## 网络即ip配置
## 网线接入
步骤1：使用网线将电脑与机器人SRC调试口进行连接，另一头插在笔记本电脑以太网口。
步骤2： 将电脑的以太网 IP 设置为 192.168.192.xxx( 注：必须为192网段 )，子网掩码 255.255.255.0，网关可省略。
步骤3：打开 Roboshop Pro 在【首页】点击【刷新】按钮或手动【输入 IP】地址为【192.168.192.5】进行机器人添加,如下图所示。
1657527675321-b518273f-00f7-419a-b024-a2cf0894d394.png

步骤4：在【首页】的机器人列表中找到 IP 地址为【192.168.192.5】的机器人点击【开始连接】按钮进行连接。
1655703009387-6fad768c-ef91-4286-9f8b-f90d8d38ee77.png

步骤5：等待机器人标签页中显示机器人的“置信度”、“网络延时”、“地图”、“名称”、“备注（若有）”等信息时，表明连接成功。
1655703032125-896cea57-86b7-453b-8d5b-a3002af93dad.png

## 禁用src网卡
（1）打开 Roboshop ，添加机器人 192.168.192.5，打开高级配置界面；
（2） 取消 勾选【使用DHCP】，设置 IP：192.168.1.100，子网掩码：255.255.255.0，网关：192.168.1.254，禁用主控自带的无线网卡。
1710069731221-b0824886-90f8-4d48-b13e-0db3541376b3.png

## 查看分配IP
（1）网线连接电脑和设备，修改电脑以太网Internet协议属性，地址改为192.168.1.X 网段；
（2）浏览器输入192.168.1.254 → 输入用户名和密码进入；
（3）选择网络 → 查看分配的 IP 地址用于连接主控。
1710069998048-103e1992-509f-45b4-b673-abdedac9480b.png

## 使用无线网卡接入
无线网卡连接设置需要机器人处于网线接入机器人的状态下配置。
步骤1：点击机器人标签页中的【高级配置】按钮，进入高级配置页面。
1653028230982-b98e5c3b-5828-4f7c-986e-06f57dc6701b.png

步骤2：在【无线网卡配置】栏，点击【刷新】按钮，获取该区域覆盖的Wi-Fi，选择合适的Wi-Fi，输入密码，并点击【连接】按钮。
1653028438978-2d66322f-89cb-4fc7-8ba4-c7c6aa1b0b01.png

步骤3： 连接成功后，点击【无线IP】，界面显示已连接网络名称与当前机器人所分配的IP。
1654852833488-01d68735-2739-4f07-b4a8-a97b467aa866.png

步骤4：回到【首页】，断开网线连接，选择与上述步骤无线IP相同的机器人，并点击【开始连接】。
1653029223640-3d1e1456-b791-4912-a523-52bb2caacd1c.png

步骤5：等待机器人标签页中显示机器人的“置信度”、“网络延时”、“地图”、“名称”、“备注（若有）”等信息时，表明连接成功。
1653029330829-472d370a-b6b9-4451-906a-e154e768ea48.png

## 特殊网络要求的配置方法
步骤1：在【无线网卡配置】栏下，点击【高级配置】按钮。
1653029671247-7b019696-bb35-4056-b072-d584c0d4fb51.png

步骤2：输入相关数据，开始连接，并获取IP。
1653029736476-7952e1ab-4cf1-427a-8bc6-71cd225adbc1.png

## 使用 Wi-Fi 客户端接入
机器人默认使用【无线网卡】进行网络连接，若使用网络客户端（例如AWK moxa 1137C）连接网络，请确保客户端接入网络后，将网络客户端输出的网线接入核心控制器规定网络，如下图，若使用 SRC2000 核心控制器，则需要将网线接入下方 4 号网口。
## image.png

## 设置DHCP模式
当 TP-LINK完成与现场网络的连接后，如果路由器启用了 DHCP，那么机器人会被分配一个 IP 地址，这时需要确认机器人被分配的 IP 地址用于无线连接。步骤如下：
步骤1：通过有线 IP 地址 192.168.192.5 连接机器人（此时需要更换网口）；
## 步骤2：点击高级配置按钮，如下图
1653031612814-88628e3f-715e-406d-893f-186594f159aa.png

步骤3：在弹出的【高级配置】界面中的【无线网卡配置】标签页可以查看机器人被分配的无线网络 IP，如下图。
1653031650888-a1a75453-5824-4183-a3c5-fdb9038a634b.png

步骤4：记住此 IP 后即可断开网线连接，确保 PC 已经接入与机器人相同的无线局域网后，在 Roboshop 首页，点击【输入 IP】按钮，输入机器人的无线 IP 进行连接 。
## 设置静态 IP模式
当TP-LINK完成与现场网络的连接后，如果路由器仅支持静态IP接入，那么机器人需要IT部门告知可用的 IP 地址，这时需要确认机器人被分配的 IP 地址用于无线连接。步骤如下：
步骤1：通过有线 IP 地址 192.168.192.5 连接机器人（此时需要更换网口）
## 步骤2：点击高级配置按钮，如下图
步骤3：去掉【使用DHCP】的勾选，设置静态 IP、子网掩码、网关信息，填写完成后点击【写入】按钮，等待提示【配置以太网 IP 成功】，然后点击下方的【禁用无线网卡】将机器人的内置无线网卡禁用，避免出现异常冲突。
1653032227219-9a22b04e-6d5c-461e-a132-80b1ebcd98a2.png

步骤4：关闭【高级配置】界面，断开网线连接，确保 PC 已经接入与机器人相同的无线局域网后，在 Roboshop 首页，点击【输入 IP】按钮，输入上一步所设置的静态 IP 地址，待添加成功后，即可使用该 IP 地址连接机器人。
## 配置FAQ

### TPlink连接AP时候显示无法分配IP
--首先用手机热点测试是否可以正常获取IP，如果可以请联系AP供应商进行设置，为AP端问题；
### 企业微信截图_17291472608749.png
