# 外置编码器的选型

## 外置编码器的选型

## 版本

## 更新日期

## 更新说明

## 文档状态

## 维护责任人

## V1.0

### 2024.3.15

## 初版

## 使用中

## 编码器概述与参数
## 编码器概述
编码器（ encoder ）是将信号（如比特流）或数据进行编制、转换为可用以通讯、传输和存储的信号形式的设备。编码器把角位移或直线位移转换成电信号，前者称为码盘，后者称为码尺。按照读出方式编码器可以分为接触式和非接触式两种；按照工作原理编码器可分为增量式和绝对式两类。增量式编码器是将位移转换成周期性的电信号，再把这个电信号转变成计数脉冲，用脉冲的个数表示位移的大小。绝对式编码器的每一个位置对应一个确定的数字码，因此它的示值只与测量的起始和终止位置有关，而与测量的中间过程无关。 
1651828092020-60604649-23ca-4324-971e-034a57bfb563.png

## 光编和磁编的优缺点
## 下表所示：

## 分类

## 优点

## 缺点

## 光编码器

## 信号稳定，精度高，价格贵

## 怕振动，怕灰尘，污垢

## 磁编码器

## 性价比高，大部分电机选磁编

## 噪声略大，易受高温或磁场影响
## 编码器参数概述
分辨率（ P/R：pulse per rotation ）= 编码器线数 * 4 倍频，即电机轴每圈输出的脉冲数。
例如,某旋转编码器的分辨率为100PPR,表示每旋转一圈,该编码器可输出100个脉冲信号;同理,某旋转编码器的分辨率为256PPR,则表示每旋转一圈的脉冲数为256个. 在模型文件中的encoderLine需要填写256/4=64
编码器线数的概念来自于光编，见右图码盘上的刻线。
4 倍频 ： 码盘下有一个光源，码盘上有 A、B 两个光敏装置，码盘每转一格，在 A、B 上会各产生一个明暗的方波，每个方波 1 个上升沿 1 个下降沿，共输出 4 个脉冲。
位的概念来自绝对值编码器，圆形码盘上沿径向有多个同心码盘，有几圈码盘就是几位的编码。一般位 12 位到 14 位。
1652081689770-1ef02534-2dcc-4bd5-909f-aed5cdef5e0f.png

## 编码器用途
编码器的参数常用于里程计的计算，可得出电机旋转的实际圈数，例如行走电机经过减速机构加上轮径，即可计算出实际轮子走过的距离。

## 参数名称

## 参数位置

## 单位

## 默认值

## 最小值

## 最大值

## 支持版本

## encoderLine

## 模型文件-motor

## \

## 1024

## 1

## 1000000

### 3.3.4.20~latest

此参数为模型参数，一般为电机轴（不含减速机构）转一圈时，从驱动器中读到的脉冲数之差 / 4。

## 编码器的类型及特点
从功能上区分，目前仙工智能主要使用的编码器可以分为增量式编码器与绝对值编码器，绝对值编码器则可以分为单圈编码器与多圈编码器
## 增量式编码器
增量式编码器一般用于行走驱动器内置编码器。编码器输出的是脉冲，需要驱动器有处理脉冲信号的能力。优点是实时性非常高，角度非常精准，内部简单可靠。
## 绝对值编码器
绝对值编码器随时可以直接读取，即使当设备重启或掉电故障再次接通时，这样设备无需回到参考原点，可节约系统恢复的大量时间。绝对值编码器实现原理有机械齿轮多圈（类似机械手表），不需要电池，还有通过电子计数器（类似电子手表），需要电池，电池 3 年左右需要更换。
## 单圈编码器
单圈绝对值编码器，当旋转超过一圈，同一角度位置的输出码值即会对应重现，因为单圈绝对值编码器无法记录旋转的圈数信息，只能记录一圈的值，超过一圈范围后会从零或者最大值开始计数，这样的编码器适用于舵角角度获取。
## 多圈编码器
多圈编码器相对单圈编码器而言，即量程是多圈的编码器，一般应用于拉线盒。多圈编码器也有溢出的问题（如 Sick 的 AHS36A 旋转 700 多圈就会溢出）。
## 选型说明
## 选型分析

## 编码器优缺点汇总

## 功能

## 增量式

## 绝对值单圈

## 绝对值多圈

## 输出信息

## 周期性脉冲信号

## 机械、电子计数信息

## 断电记忆

## ×

## √

## 简单结构

## √

## ×

## 成本

## 低

## 高

## 抗干扰性

## 弱

## 强

## 应用场景

## 行走驱动器内置

## 舵角测量

## 拉线盒
## 案例说明
## 行走驱动
行走电机需要与减速机进行配合，提升扭矩，实际使用过程中 reductionRatio 必须和实际一致。
当 reductionRatio 配置为不合理的值时，会触发模型配置的报错，具体如下：
## Error52155
提示： Walk reductionRatio should not be zero.
## 触发条件：
当 reductionRatio 小于 0.00001 时，会触发模型配置相关的报错。

## 参数名称

## 参数位置

## 单位

## 默认值

## 最小值

## 最大值

## 支持版本

## reductionRatio

## 模型文件-motor-walk

## \

### 20.0

### 0.00000001

### 10000.0

### 3.3.4.20~latest

模型参数，一般可从减速机参数直接得到，通过计算可以得出行走电机实际行走的里程距离。

在roboshop中行走电机一般命名为left/right。行走电机一般使用绝对值编码器
## 绝对值编码器一般配置如下：
## image.png

## 参数解释如下：

## 参数名称

## 参数位置

## 单位

## 默认值

## 最小值

## 最大值

## 支持版本

## encoderLine

## 模型文件-motor

## \

## 1024

## 1

## 1000000

### 3.3.4.20~latest

此参数为模型参数，一般为电机轴（不含减速机构）转一圈时，从驱动器中读到的脉冲数之差 / 4。

## 托盘旋转机构
电机通过齿轮组合将电机轴的旋转转化为机构的旋转运动。
在roboshop中旋转电机一般命名为spin。spin电机可能使用增量式或绝对值编码器。
## 无限旋转

## 参数名称

## 参数位置

## 单位

## 默认值

## 最小值

## 最大值

## 支持版本

## reductionRatio

## 模型文件-motor-spin

## /

## 1.0

### 0.00000001

### 10000.0

### 3.3.4.20~latest

模型参数，一般为旋转机构转一圈时，电机轴（不考虑减速机构）所转的圈数，再通过计算可以得出当前机构模块所处的实际角度位置。

当 reductionRatio 配置为不合理的值时，会触发模型配置的报错，具体如下：
## Error52155
提示：Spin reductionRatio should not be zero.
## 触发条件：
当 reductionRatio 小于 0.00001 时，会触发模型配置相关的报错。
## 解决方式：
修改该参数为实际值，推送模型文件即可消除该错误。
## 有限旋转
旋转的范围为有限范围时称有限旋转即旋转机构存在限位，常限制于正负 180° 内（以 0 点为起点）。

## 参数名称

## 参数位置

## 单位

## 默认值

## 最小值

## 最大值

## 支持版本

## reductionRatio

## 模型文件-motor-rotation

## deg/round

## 1.0

### 0.00000001

### 10000.0

### 3.3.4.20~latest

模型参数，一般为电机轴（不考虑减速机构）转一圈旋转过的角度，再通过计算可以得出当前机构模块所处的实际角度位置。

当 reductionRatio 配置为不合理的值时，会触发模型配置的报错，具体如下：
## Error52155
提示：rotation reductionRatio should not be zero
## 触发条件：
当 reductionRatio 小于 0.00001 时，会触发模型配置相关的报错。
## 顶升机构
电机通过丝杆的传动将电机轴的旋转转化为机构的直线运动。

## 参数名称

## 参数位置

## 单位

## 默认值

## 最小值

## 最大值

## 支持版本

## reductionRatio

## 模型文件-motor-linear

## mm/round

## 1.0

### 0.00000001

### 10000.0

### 3.3.4.20~latest

模型参数，一般为电机轴（不考虑减速机构）转一圈直线运动的距离，再通过计算可以得出当前机构模块所处的实际高度或长度。

当 reductionRatio 配置为不合理的值时，会触发模型配置的报错，具体如下：
## Error52155
提示： Linear reductionRatio should big than 0.
## 触发条件：
当 reductionRatio 小于 0.00001 时，会触发模型配置相关的报错。
## 解决方式：
修改该参数为实际值，推送模型文件即可消除该错误。
在roboshop中顶升电机一般命名为lift。顶升电机一般使用绝对值电机
## 转向机构
转向电机通过大齿轮及小齿轮的传动将电机轴的旋转转化为行走轮的角度变化。

## 参数名称

## 参数位置

## 单位

## 默认值

## 最小值

## 最大值

## 支持版本

## reductionRatio

## 模型文件-motor-steer

## \

## 1.0

### 0.00000001

### 10000.0

### 3.3.4.20~latest

模型参数，一般为大齿轮齿数 / 小齿轮齿数，通过计算可以得出当前行走电机实际所处的角度位置。

## 无标题.png

当 reductionRatio 配置为不合理的值时，会触发模型配置的报错，具体如下：
## Error52155
提示： Steer reductionRatio should not be zero.
## 触发条件：
当 reductionRatio 小于 0.00001 时，会触发模型配置相关的报错。
