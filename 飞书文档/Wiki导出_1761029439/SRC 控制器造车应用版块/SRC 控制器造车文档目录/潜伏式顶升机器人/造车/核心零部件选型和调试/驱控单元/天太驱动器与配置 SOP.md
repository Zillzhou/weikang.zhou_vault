# 天太驱动器与配置 SOP 

## 天太驱动器与配置 SOP

## 版本

## 更新日期

## 更新说明

## 文档状态

## 维护责任人

## V1.0

### 2024.7.1

## 初版

## 使用中

## 配置前的准备工作

## 序号

## 准备事项

## 备注

## 1

## 已安装驱动器调试软件的笔记本电脑
## 上位机软件下载链接：
## 409版本固件

## GD32DS220409.zip
## TT上位机软件

## TTMotor0330.zip
## 上位机软件使用手册：

## 驱动器说明书1.3.2v.pdf

## CANOPEN对象字典1.2v.pdf

## 2

## 工具：mini-USB 数据传输线

## 3

## 已正确接线和上电的驱动器

## 电机安装模型
潜伏顶升车运动模型为双轮差速包含左右2个行走电机，一个旋转电机和一个顶升电机。该车型所拥有的2个驱动轮必须共轴，且车体坐标系的原点落在两轮中心连线的中点上，车体坐标系的x轴与轮轴垂直，如下图所示：
1652597627254-fb6a67ce-1648-48ae-9bbb-a02525e9f3fd.png

## 当前车型配置示例
此示例选择选用天太伺服驱动器作为行走电机，其详细使用文档参照 ：

## 驱动器说明书1.3.2v.pdf

## CANOPEN对象字典1.2v.pdf

## 驱动器本身参数配置
参照以下内容配置。

## 模型文件配置
天太直流伺服驱动器在潜伏顶升车上，可用于旋转。因此需要根据需要配置模型文件。
模型文件总览：通过模型文件——MOTOR——选中motor，即可在右侧属性窗口配置电机及驱动器相关参数。
## image.png

## image.png

## image.png

## 基础配置
## 图片.png

## 参数名称

## 单位

## 默认值

## 最小值

## 最大值

## 支持版本

## x

## m

## /

## /

## /

轮回转中心在右手坐标系下的 x 位置，如小车模型中坐标，根据实际距离填写

## y

## m

## /

## /

## /

轮回转中心在右手坐标系下的 y 位置，如小车模型中坐标，根据实际距离填写

## yaw

## °

## /

## /

## /

## 轮安装的朝向，根据实际安装位置填写

## canID

## /

## /

## /

## /

行走轮对应电机驱动器的 canID，根据驱动器上位机配置决定

## inverse

## /

## /

## /

## /

电机是否反向旋转，根据实际需求配置，本示例中right电机因其安装方向，故而勾选。

## encoderLine

## /

## /

## /

## /

## 电机编码器线数，根据电机实际参数填写

## currentFactor

## /

## /

## /

## /

## 电机电流因数，根据实际情况填写

## upLimitDI

## /

## -1

## /

## /

上限位DI，-1代表不启用，如果启用根据上限位传感器DI填写，行走电机配置为-1

## downLimitDI

## /

## -1

## /

## /

下限位DI，-1代表不启用，如果启用根据下限位传感器DI填写，行走电机配置为-1

## zeroDI

## /

## -1

## /

## /

零位DI，-1代表不启用，如果启用根据零位传感器DI填写，行走电机配置为-1

## passive

## /

## /

## /

## /

### 是否为被动电机，不勾选代表不启用，行走电机不勾选

## brake

## /

## /

## /

## /

## 其中encoderLine
## 增量式编码器填：2500
## 绝对值编码器填：16384
1710836571995-92593a15-b096-4848-802f-6ca0daab79c0.png

## 电机电流系数配置
## currentFactor
### 电机电流系数配置方法， currentFactor配 1
## image (3).png

## 型号和端口配置
## CAN通信配置（canPort）
本车型详细参数配置如下。
## image.png

## 1：功能：行走walk
## image.png

## 参数名称

## 单位

## 默认值

## 最小值

## 最大值

## 支持版本

## wheelRadius

## m

## /

## /

## /

### 驱动轮实际轮半径，请根据实际情况进行填写

## reductionRatio

## /

## /

## /

## /

## 驱动轮减速比，请根据实际情况进行填写

## minimumSpeed

## m/s

### 0.05

## /

## /

电机的最小启动速度的上限值，例如电机需要0.01m/s才能启动，则下发值始若小于0.01m/s时会逐渐增加到电机刚好动的值作为启动速度，但不会超过该参数。

## deltaCnt

## count

## -1

针对minimumSpeed的加速系数，系数越大，递增的速度越快，越快达到minimumSpeed上限值。一般情况下无需调节该参数。

## deadDealerK

## /

## /

## /

## /

该值用于特殊情况下，若电机编码器抖动较大时，启用该参数可以解决电机数据判断为非静止的状态。

### reductionRatio:减速比 需要测算
减速比一般是由载荷的特性和运动速度决定的。一般计算公式为：减速比=输出轴转速/输入轴转速，其中输出轴转速根据具体要求设定，输入轴转速则根据电机的额定转速来选择。通常会根据需求和具体情况调整减速比。
1710902020649-e215dee5-3348-485b-972d-5c00dfbf7346.png

## 2：外置编码器配置（若有）
## 图片.png

## 参数名称

## 单位

## 默认值

## 最小值

## 最大值

## 支持版本

## outEncoderID

## /

## /

## /

## /

## 释义: 外置拉线编码器的can ID
## 说明: 请根据实际情况进行选择

## utEncoderRatio

## 释义: 外置拉线编码器减速比
说明: 使用外置拉线编码器的时候，核算出来的减速比，请根据实际情况进行选择 

## outEncoderLine

## 释义: 外置拉线编码器线数
说明: 使用外置拉线编码器的时候，核算出来的编码器线数，请根据实际情况进行选择 

## outEncoderPort

## port1释义: CAN的通信端口1
## port2释义: CAN的通信端口2
## 说明: 请根据实际情况进行选择

### 3：电机型号TianTai-LVSI-CANOpen
## image.png

## 参数名称

## 单位

## 默认值

## 最小值

## 最大值

## 支持版本

## brand

## /

## /

## /

## /

指所配置的驱动器的型号，请根据实际情况进行勾选，其中我们支持的驱动器品牌请查看链接：motor 

## 功能验证
注意：电机控制验证前之前必须先完成激光配置、电机配置动作。
在整车组装完成未安装外壳前，请再检查一遍接线确保接线正确；
让车体着地，使用 Roboshop 软件操作机器人做运动动作:向前，向后移动固定距离，如果不正常，请检查第四章节 驱动器配置 ；
未拍急停按钮前，推动机器人，无法推动（电机使能），检查 Roboshop 中机器人状态处于“未急停”“驱动器未急停”，如图 1所示；所示拍下急停按钮后，再次机器人，可以推动（电机去使能），检查 Roboshop 中机器人状态处于“已急停”，“驱动器已急停”。
1711003524057-e7201e4f-46f0-4139-9c18-951b040e8712.png 

## 图1 未急停
1711003581375-845014e8-26e0-4181-b98a-90266213baab.png 

## 图2 急停状态
## 验证操作视频：

## video(40).mp4
