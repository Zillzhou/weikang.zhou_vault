# 正向操作 SOP

## 正向操作 SOP

## 版本

## 更新日期

## 更新说明

## 文档状态

## 维护责任人

## V1.0

### 2024.4.29

## 更新发布

## 使用中

## SOP 场景以及场景需求说明
由于是讲述车体的使用操作 SOP， 所以一定会涉及到什么样场景下的 SOP 实现，我们可以通过 如下表格的关键信息对此场景下的 SOP 实现做一定的说明，具体现场的实施可以参考该篇文档进行实施和部署

## 场景要素序号

## 场景要素

## 场景说明

## 备注说明（可以含图示）

## 1

## 场景车辆说明

## 1.车辆地盘运行模型为 AMB300 双轮差速+ UR 集成复合机器人（UR 上集成相机+夹爪）；
### 2.UR 需要集成视觉+夹爪 的功能，底盘做业务逻辑处理并通过 UR 提供 Modbus tcp（UR 做从站）协议实现业务动作逻辑 ；
### 3.复合机器人中间层 有物料放置的中转位置* 2 个；

1708661207902-d6bdce14-33fb-42f6-b25b-4356e763dceb.png

## 2

## 场地布局说明

1.库区和库位说明：场景中有两个设备工位，一个是满物料设备工位 A，有 2 个需要取货的满物料料盘 A1/A2；一个是满物料放置工位 B，有两个需要放满物料料盘的工位 B1/B2
### 2.载具：提篮

1708661128167-ce65be15-a897-4108-8d86-d53ab69d11d5.png

## 3

## 业务场景功能实现说明

## 1.工位 A 是机台生产完成的半成品物料，放在提篮中，需要将 A 机台的两个满物料放置到 B 机台的两个半成品满物料放置区中进行再生产；
### 2.需要实现功能安全互锁。既手臂动时底盘不能运动，底盘运行时手臂不能移动的功能；
3.需要实现手臂随着底盘激光雷达检测的障碍物距离，实现手臂的线性速度控制，比如安全距离设置为 5m，底盘激光雷达检测的障碍物距离大于 5m 时候，此时手臂运行速度百分之 100%；当底盘激光雷达检测距离为 2.5m 时，此时手臂运行速度百分比为 50%；当底盘激光雷达检测底盘内有障碍物时，此时手臂运行速度为 0 ；

## 开机
### 按下开机面板上的开机键，直到开机灯点亮后释放按钮

## 开机.mp4

## 配置机器人连接到无线网络
## 有线连接机器人
步骤 1：使用网线将电脑与机器人 SRC 调试口进行连接。
步骤 2： 将电脑的以太网 IP 设置为 192.168.192.xxx（注：必须为 192 网段），子网掩码 255.255.255.0，网关可省略。
步骤 3：打开 Roboshop Pro 在【首页】点击【刷新】按钮或手动【输入 IP】地址为【192.168.192.5】进行机器人添加，如下图所示。
1657527675321-b518273f-00f7-419a-b024-a2cf0894d394.png

步骤 4：在【首页】的机器人列表中找到 IP 地址为【192.168.192.5】的机器人点击【开始连接】按钮进行连接。

1655703009387-6fad768c-ef91-4286-9f8b-f90d8d38ee77.png

步骤 5：等待机器人标签页中显示机器人的“置信度”、“网络延时”、“地图”、“名称”、“备注（若有）”等信息时，表明连接成功。
1655703032125-896cea57-86b7-453b-8d5b-a3002af93dad.png

## 机器人连接到无线局域网
步骤 1：点击机器人标签页中的【高级配置】按钮，进入高级配置页面。
1653028230982-b98e5c3b-5828-4f7c-986e-06f57dc6701b.png

步骤 2：在【无线网卡配置】栏，点击【刷新】按钮，获取该区域覆盖的 Wi-Fi，选择合适的 Wi-Fi，输入密码，并点击【连接】按钮。
1653028438978-2d66322f-89cb-4fc7-8ba4-c7c6aa1b0b01.png

步骤 3： 连接成功后，点击【无线 IP】，界面显示已连接网络名称与当前机器人所分配的 IP。
1654852833488-01d68735-2739-4f07-b4a8-a97b467aa866.png

步骤 4：回到【首页】，断开网线连接，选择与上述步骤无线 IP 相同的机器人，并点击【开始连接】
1653029223640-3d1e1456-b791-4912-a523-52bb2caacd1c.png

步骤 5：等待机器人标签页中显示机器人的“置信度”、“网络延时”、“地图”、“名称”、“备注（若有）”等信息时，表明连接成功。
1653029330829-472d370a-b6b9-4451-906a-e154e768ea48.png

## 构建场景
## 2D 建图
## 连接机器人后点击 2D 在线建图
## image.png

在弹出的界面中（一般情况下不需要修改参数），点击【确定】按钮。
1709258929130-09c80a02-af15-4da9-9204-ec500326d4df.png

1709259361587-1ea86061-fc09-4c57-9320-fd27ca43d229.png

1709259424104-98dd523f-b5c2-462a-8259-0f02dfca2fb0.png 

在完成扫图后点击右上角的【完成扫图】，在所弹出的界面中选择期望路径和输入期望名称进行地图保存
## image.png

保存成功后会弹出对话框询问是否打开，选择【打开】，然后选【推送地图】然后即可打开刚才所构建的地图且将该地图进行同步，可以直接 进行使用。此时地图构建部分已经完成。
## 建立站点
## 点击【启用编辑】
1709259609110-d2a54be8-7049-465f-937b-922e7ca4d862.png

添加路径 LM 点，工作 AP 点，充电 CP 点以及休息 PP 点，然后用高级 3 阶贝塞尔曲线直连
## image.png

## 完成后点击退出编辑，推送地图
## 自动充电和停靠点设置
## 自动充电识别文件设置
步骤①：在 roboshop 中点击识别编辑；
### 步骤②：在左边列表中选择 charge 下面的 amb
步骤③：填入充电桩的尺寸距离，类似选反光板 by-reflector
1710239939342-9920f6e8-22d4-4bb7-b6c2-52a4b161b794.png

## 地图 CP 点设置
## 步骤①：点击地图中的 CP 点
步骤②：右侧在识别模型文件中选择刚才配置的 amb.charge
### 步骤③：需要勾选前置点（开始识别充电的点）
1710239990622-9d51d994-659d-4601-8e10-e66ef26d5a76.png

## 停靠点设置
## 步骤①：在地图中建立站点
### 步骤②：选中站点，在类型下面选择 parkpoint
1710240068430-701f836a-472b-4f4d-b1a7-809dba92ca1e.png

## 建立库位
## 框选地图中的所有站点
## image.png

## 点击库位设置
## image.png

选择需要添加库位的站点名称，
1709261073884-f89d5f86-9b98-463a-ba3a-8ece9569682f.png

## 点击命名
## image.png

### 点击创建库位，然后在地图中所有 AP 点旁边会出现库位图标
## image.png

## 添加库位 binTask 动作
## 选中库位
### 点击动作轨迹【编辑】，可进行动作的添加、编辑、删除操作
## 点击添加
## 选中条目，点击编辑
在键中填写表示动作名称，可自命名，常用动作为 Load、Unload 等；【值】表示具体的动作指令参数，该参数一般参考具体的脚本使用说明
1711078358280-ba51085b-4c58-4a95-860d-01f2e21c3d2d.png

1711078519568-aa888343-4267-4162-bed0-1872180be0dc.png

## 业务逻辑实现
## 概述和准备
需要再次明确，该控制方案仙工的底盘控制器 和 手臂控制器 之间通过手臂控制器提供的 Modbus tcp（手臂做从站）协议，实现的通讯交互，手臂控制器需要根据业务需要集成手眼协作部件（相机、夹爪）；如下是在准备调试之前需要确认的相关事项检查列表。
通过 roboshop 检查 SRC 控制器是否已经开通 rbk_script 功能，具体检查步骤如下图所示（备注：图片中的 IP 地址不具备指导意义，请以实际 IP 地址作为链接 IP）
1708677865687-0f4b7d41-872f-4938-a604-39b789bf5ab2.png 

图：检查 AMR 车体控制器 rbk_script 功能是否开通
步骤①：通过 roboshop 有线/无线 链接链接到控制器，点击上图中的高级配置图标；
步骤②：进入控制器高级配置界面；
步骤③：检查图片中 标注 ③中 的控制器 rbk_script 是否开通，如果没有开通，进行如下的第 ④ 步骤；
步骤④：拿到该机器人 id 联系我司商务对接人进行功能开通；
明确 控制器版本是否包含实现 所有业务需求的依赖库程序，具体检查步骤如下图所示：
1708680059457-fd4aa8f7-3a9d-43a9-88be-695f4892190d.png 

## 图：进入机器人管理界面
1708680241671-966a2fdc-23d6-47c9-8407-d1204354883d.png 

## 检查依赖包是否包含
步骤①：双击进入机器人管理界面；
步骤②：点击进入机构脚本菜单栏；
步骤③：检查 syspy 是否包含 modbusTcpProto.py 依赖包（不用在意文件图标是 
1708680447353-7c79fccb-2f3e-4cde-9c16-970b48c9cb02.png 

## 还是
1708680466208-a5ef6cfc-5738-41c9-b8bd-e3461ca1b2cf.png 

，该图标是代表文件是否在安装 roboshop 的电脑和 AMR 车辆控制器之间是否同步，前者代表同步，后者代表不同步 ）；
## 实现复合机器人的移载业务需求实现
首先我们将复合机器人的控制方案进行拆分，抽象出“让复合机器人在 站点 1 从设备 1 的位置 1 取货（load）放到复合机器人的缓存位 1” 然后 “让复合机器人运动到站点 2 从复合机器人的缓存位 1 放货（unload） 放到设备 2 的位置 1 ”，所以在以上标红色的关键词， 站点、设备、位置、车上缓存位 都可以抽象成对接过程的变量，由协作机器人的控制器提供 modbus tcp 的地址资源。 为了方便您理解整个业务交互的过程，可通过如下示意图进行表示。
## image.png

## 图：业务逻辑交互示意图
如果需要实现如上业务逻辑需要按照下述操作方式进行实现。本操作文档以 UR（CR 系列） 协作机器人示教器的 GUI 界面为例，讲述整个业务逻辑实现的过程。
## 协作机器人网络配置
在进行如下组图配置前，需要确认，UR 机器人的控制柜和 AMR 底盘控制器之间是否通过有限拓扑互相链接或彼此都接入到交换机资源中。
1708770760410-e0cbfc0d-eb11-41ad-8707-6cc76c96245e.png 

1708770832970-5c714d4b-7a88-4c43-af7c-97979f8f1ab7.png 

1708771030654-531d8ad7-cff0-4473-a05f-8c821ab7758e.png 

1708780446139-22b1ee87-7b4f-49a3-aee5-8576265e080e.png 

## 组图：协作机器人网络配置
步骤①：通过 UR 协作机器人的示教器讲机器人开机，并进入 UR 示教器主界面，点击步骤①中的设置机器人
步骤②：进入 UR 设置界面后，点击网络；
## 步骤③：选择静态地址
步骤④：讲将 IP 地址配置成 192.168.192.1xx （建议 ip 为 150 或以上，本文以 192.168.192.100 为例作为 UR 控制器的 ip 地址）；子网掩码配置成 255.255.255.0；默认网关配置成 192.168.192.1；首选 DNS 和备用 DNS 配置成 0.0.0.0；
步骤⑤⑥：在 roboshop 的主界面上，找到该 AMR 并按照步骤⑤进入高级配置中，按照⑥点击高级配置中的终端命令，并在输入栏中输入 UR 控制器的 ip 地址 192.168.192.100 ，如果能出现像图片中的回包，证明 AMR 控制器和协作机器人控制器之间的网络联通正常；
roboshop 编辑 AMR 和 协作机器人之间的业务通讯交互逻辑
首先根据 5.1 中的准备工作进入  正向操作 SOP roboshop 机构脚本界面，并将该文件下载，并保存到您电脑的某个文件夹；

## modbus_arm.py

同样的方式并将如下压缩文件进行下载，下载完成之后并解压（ 注意解压不能改变文件名称 ）：

## modbus_tk.zip
根据下述步骤将文件导入到 AMR 控制器中。
1708862536959-3d333011-7676-47d4-8282-c5a9bc866c9e.png 

1708867506845-4cd4e1a3-9a8f-4181-986c-0785ecca354a.png 

1711020164581-dd7fdd2a-fbd6-4bb6-984a-3df62fd6cb9c.png

## image.png

## 组图：导入 modbus_arm.py
步骤①：进入机构脚本界面后，在空白区域右键鼠标在出现的选择栏中，选择导入文件；
步骤②：选择下载到本地电脑的 modbus_arm.py 文件，导入，导入之后并将鼠标光标移动到该文件出，右键，选择推送该文件，将程序同步到 AMR 控制器中；
步骤③：选在解压到本地的 modbus_tk 文件夹，并导入（注意 modbus_tk 必须和 modbus_arm.py 在同一个文件夹目录），导入效果如组图 ③所示；
步骤④：在脚本中更新手臂的 IP 地址。
modbus_arm.py 程序逻辑和协作机器人的动作协同说明
在机构脚本界面，使用鼠标双击 moudbus_arm.py 机构脚本，会在程序的内容找到如下的机构脚本标识，标识开始位置以“####BEGIN DEFAULT ARGS#### ” 开始，以为“####END DEFAULT ARGS####” 结束，如下图所示
1708934931964-dce86990-ea6a-43cf-8236-825adc56f94a.png 

## 图：机构脚本动作标识图
这里我们将标识的内容和业务逻辑交互图进行演变，演变结果如下图所示，所以可以在下图上看到，架构脚本的 operation 代表的就是 “放料”、“取料”的标识动作，from 代表就是设备的位置 1、位置 2......，to 代表的就是车上缓存位置 1，车上缓存位置 2.....，station 代表在机台的标识，所以我们想实现一个动作的业务逻辑只需要通过调用机构脚本 modbus_arm.py 并设置正确的 operation，from，to，station 的值即可，比如我们给定了“operation=load，form=1，to=1，station=1”即可实现： 复合机器人将设备 1 上位置 1 的物料挪动到复合机器人缓存位置 1。
1708935134005-f4baac8a-c1d6-4c62-ad99-51c3f6306e0c.jpeg

## 图：机构脚本内容如何业务动作逻辑演变
为了保证逻辑的完整性闭环，我们将如上动作进行细化，还是以给定机脚本参数“operation=load，from=1，to=1，station=1”为例，复合机器人将设备 1 上位置 1 的物料挪动到复合机器人缓存位置 1”为例，我们将整个对接过程进行细节拆分；
1708938679254-3b4a9175-a58f-46af-8c34-916bbbc96a37.jpeg

协作机器人实现 modbus tcp 的网络组态，按照如下步骤建立 arm 手臂和底盘 AMR 之间的通讯变量（建议全部采用可读写寄存器，既下图中的“寄存器输出“类型）
1709100514379-cbd9a304-972e-4506-992b-e860cbd1600c.png

1709100595700-0cf8fc3d-ba33-472d-a9da-2875054188e0.png

1711018860580-f841955b-5251-4f32-b9ce-521ee37eccdd.png

1711018998966-05589c94-bda2-4784-ac68-e36d9e57060d.png

1711020442413-26246ec6-2ec0-492c-8ac3-7424fd2c5a01.png

1711021046561-690e93e8-4f5c-4a42-a962-b3977545e5aa.png

### 组图：arm 的 modbus tcp 通讯变量的建立
### 步骤①在 arm 的示教器上进入“为机器人编程”栏
## 步骤②选择“安装和设置选项”
步骤③④选择 "Modbus"并设置该 ip 地址为 协作机器人的 ip 地址（本文以 “192.168.192.100”为例）
步骤⑤⑥ 按照如上 一一建立 arm 和 AMR 之间的通讯交互的变量
步骤⑦⑧ 建立的变量名称 和 变量地址位需要和 modbus_arm.py 里的通讯变量一致（ 注：arm 里面和 modbus_arm.py 里变量名称最好能一致，保证可阅读性，地址值需要一定相同，但是 arm 的示教器可能因为有字符限制导致无法完全一致，此时可酌情处理 ）
步骤⑨⑩ 全部编辑完成之后，使用 arm 示教器，按照图示⑧⑨保存配置
编辑示教器所有取放动作的轨迹，并且编辑逻辑，下面是多编辑轨迹逻辑的要求，附件中示教器轨迹程序的压缩文件实例如下，解压之后可以使用 UR 示教器用 U 盘导入文件参考（该参考文件只能作为实例参考，因为实例里大量的轨迹动作无法适配您的现场场景）：

## modbus_arm.zip
1711021343868-4cfb6c51-4b77-4374-a1b0-432bcd7efb74.png

1711021420701-ed5f7061-605c-41bc-81f5-fb51acadc3c9.png

1711021958875-b7cbb8c3-96d7-474b-8529-b7f6cbca2ac4.png

1711022364057-7dcd6623-882c-4559-b37c-0ea4a4dd805f.png

1711022423578-e9ebb483-5bb0-4b3e-92ad-f7decb0c7e56.png

1711022472808-7c54db7f-2f19-4cd5-a261-7bd468ff1f64.png

1711022604357-64cd530d-8a35-4c82-9cb1-6e9c906c6850.png

1711022784016-d7979b82-3864-4b9d-894f-021104d33884.png

## 组图：协作机器人轨迹逻辑编程
步骤①通过图示①所示，使用 arm 示教器创建一个新的轨迹示教器程序；
步骤②建立初始化变量（初始化变量既程序重新开始被执行的时候执行一次，只有开始重启、或者中断程序重新执行的时候才会有效），这里是做相关 modbus 可读写寄存器地址交互变量的初始化操作；
步骤③按照图示的方法建立手臂移动逻辑的判断条件，实际和交互过程一致；可以在实例程序中通过图示的箭头指引看到；
步骤④图示四的 isDevPitcture 的 true/false 分别代表拍照和拍照后的取放动作，大多数的情况下，为了保证节拍是需要协作机器人拍照一次，多次进行取放料的，所以这个变量是为了区分是否是第一次拍照的标志位；
步骤⑤在正常的取放料上你能明显的看到需要将手臂到设备取放料、手臂到车上缓存位的各个物料编号编写轨迹，并且和 from & to 所对应的物料编号保持一致；这里的 process 的取值为 0/1 也是为了保证 上料 load 的过程，先从 from 开始取货，然后在到 to 放货；
步骤⑥当手臂已经正常进入到取放料的判断分支之后，可以将手臂状态置为 3 ，代表手臂正常工作中，具体的含义可以参考 modbus_arm.py 中的 ArmStatus 的说明，如下图所示：
1711023625029-a8dbbe4a-ebd7-4758-9bf6-f36d169b19b6.png 

## 图：复合机器人运行状态解析
步骤⑦ 整个动作逻辑交互完整之后，需要手臂端清空相关交互信号；
步骤⑧ 如图所示，线程代表的是一直刷新执行的意思，哪怕动作轨迹程序不执行，线程也会跟随系统扫描周期运行，该线程主要是为了将控制手臂速度百分比和暂停信号通过该逻辑中转到 arm_speed 和 arm_pause 两个 modbus 的可读写寄存器的地址，事实上很多机械臂厂商会有原生的控制线性速度和暂停以及继续的相关接口，这里只是提供了一种思路；

## 实现协作机械手和底盘的安全互锁
底盘通过激光雷达检测的障碍物距离，从而线性的控制手臂运行速度的百分比
1711024251941-82fe5369-1a7b-4ba7-921b-f716f0865824.png 

## 图：动态障碍物减速
步骤① 通过 roboshop 双击进入 modbus_arm.py ，找到方法 dynamic_bos_ctr（） 的方法名，该方法即实现了检测障碍物距离在两个值范围之内，将速度从 0%-100% 进行线性变化，具体的设置参数如下图所示

1711024474931-2acc69d9-b123-480f-a43a-61be0ce84752.png

## 图：动态障碍物距离设置
当障碍物距离大于 armControl_pos 为全速，障碍物距离在 armControl_pos 和 armPause_pos 之间，则速度在百分之 0%到 100% 之间线性变化，当小于等于 armPause_pos 手臂即暂停；从而实现了手臂移动过程中的安全作业，当然图示中的数值可以根据实际需要进行修改；

### ARM 和 arm 的错误互传和控制权归属查询
使用 roboshop 在模型文件中按照下述步骤进行配置，具体操作如下图所示
## image.png

## 图：配置安全互锁相关信号
步骤① 在模型文件中找到“modbusArm”菜单栏，并点击；
步骤②配置手臂相关 ip、端口、slaveid 并启用设备；
步骤③按照步骤 ③所示建立相关 action 动作，具体的选择含义说明如下：
### actions — Write error
1665211505469-aa57b2ca-d760-4b4b-9044-a9bde314e4a9.jpeg

当小车存在配置的错误码时，会向指定保持寄存器写入该错误码的值
holdingRegistersNumber : 地址位，从 0 开始。
errorCode ：小车错误码；当小车出现配置错误码，会向 holdingRegistersNumber 地址位写入该错误码
### actions-1 — Write lock

1665211576335-5be2d0d7-678e-40d9-a820-02ce9c3177aa.jpeg

### 小车控制权状态：0=无人获取控制权，1=有人获取控制权
holdingRegistersNumber : modbus 地址位，从 0 开始。
actions-3 — 03 Read Holding Registers （4x） 和 04 Read Input Registers （3x）

1665211469522-2a35327d-cef1-4923-9b3c-84902a88ec95.jpeg

如上图所示，读取保持寄存器和读取输入寄存器都有相同的三个配置参数：
holdingRegistersNumber/inputRegistersNumber ：地址位，从 0 开始。
errorMsg ：错误信息，通过报错误反馈。
value ：当读到寄存器为此值时代表错误状态，错误状态时会有报错码
所以综上，AMR 底盘会将自己的底盘错误通过 actions 上报到协作机器人提供的 modbu 可读写寄存器地址上；arm 将自己的系统错误状态通过 actions-2 写入到某个 moudbus 可读写地址位上，AMR 检测到一旦不符合条件则会抛出 error 异常；AMR 的控制器则通过 actions-1 所配置的、arm 提供的可读写寄存器地址提供给手臂，所以 arm 是可以根据对应值的状态，在程序对控制权归属、底盘错误状态做相应 GUI 编程，从而保证 arm 和 AMR 作为一个整体的机构安全，当然这里如何编程，我相信您已经该知道如何去实现了。

## RDS 联合测试任务流程
## 安装 BASE-RDS
将最新的 RDSInstallers 安装包，如 Base_RDSInstaller_4.3.0.0.exe（for Windows）安装在目标主机上，直接安装即可（建议安装在跟目录下，同时保证计算机名称为英文）。
1710413383511-3bf25530-a6f2-4b85-aebf-7c90bceebe8e.png

## 加载 CORE 和 RDS
用户可以通过 Roboshop 来更新 Core 和 RDS 。（需在 Robod 软件运行时）。
在目标服务器上，运行 RDS（安装完成后点击桌面上的 RDS 蓝色图标，双击启动）。在同一局域网的 PC 上打开 Roboshop 软件，点击界面右上角的【添加设备】：
1657534867335-6cfd8792-332c-441b-9478-7c10d13e6aa6.png

输入目标服务器的 IP（如 127.0.0.1），点击【辅助程序】：
1657534897665-f59bada3-8868-4970-b76a-86b9f51b8953.png

选择【升级/备份】，将需要升级的 Core 和 RDS 的安装包拖拽到指定位置（也可通过 加载文件 按钮选择 RDS 安装包），点击【开始升级】，如下图：
1657534908192-651777b0-b33f-4be3-8262-3ee939fd4407.png

升级成功后，需要等待不超过 30s。待服务器上 RDS 命令行重启，表明更新成功。如果当前操作的 PC 不是调度服务器，可尝试用浏览器登录 RDS（在浏览器中输入 localhost:8080 ），若能够出现登录页面，也表示更新成功。
## Roboshop 新增 Core
进入 Roboshop 以后，点击右上角的【添加设备】，输入目标服务器的 IP 地址，点击确定，并点击页面右上角的蓝色刷新按钮。
1653529666360-f80d979e-8798-4df7-b8b1-55eff0066b0e.png

1653529670873-d834a2e6-9bb2-443a-91d3-1a9f37e74a5a.png

刷新后出现备注为 Core 的模块，点击【开始连接】，即可进入 Core 界面。
## Core 调度界面功能配置
## 添加机器人组
进入 Core 调度界面后，点击【启动编辑】，并点击【新建】，可建立一个新的场景。在【机器人组】上点击鼠标右键，选择添加组，如图所示：

1710318950705-b95d94c4-80e3-4267-8c77-c6a4bdd670bf.png
## 添加设备
 选中新建的组，在【机器人组】上点击 “+” ，在弹出的【添加设备】页面中勾选机器人，默认为全部勾选，点击【全部】取消勾选，然后选中要添加的机器人即可（需要是真实机器人），即可添加设备到组内。复合机器人 IP 为：192.168.190.35，则选中此设备添加，下载完成即可，添加完成后 在左侧可以看到机器人名称；
1711079066481-fb3ba84f-b339-49b6-b132-cb903131a3c9.png 

1711079279004-90433dde-7e6d-46a6-b55a-ff4edfcf16f8.png

## 添加组内机器人地图到区域
点击【启动编辑】，在机器人组上，如图所示，鼠标移动到“unnamed”分组，点击右键选择【添加/更新地图到区域】，即可显示机器人中的地图列表。选中当前测试车 300XS-UR 对应的地图，确认后即可加载地图。
1711079576974-e405a3ae-6187-4ede-b3e1-36430c51a373.png 

加载完成后【退出编辑】，在弹出的提示框中选择【推送场景】，即可将机器人前面建好的地图推送到 rds 服务器，见下图；
1711079629102-408d2acd-3285-47fa-ad44-896c961c7301.png

## 机器人基本信息
 如图选中当前机器人，右边【基本信息】栏显示该机器人的详细信息。方框中即是设置机器人的电量阈值；
1711079705425-135908b3-5e74-46c1-a4e7-d964526f144a.png

ChargeNeed ：当机器人在未充电状态、电量低于此阈值且机器人没有运单时，机器人将前往绑定的 CP 点进行充电；
ChargeOnly ：当机器人在未充电状态、电量低于此阈值时，则机器人在完成当前运单后自动前往绑定的 CP 点进行充电；
ChargedFull ：当机器人充电至此阈值时，机器人自动结束充电并前往 PP 点停靠；
ChargedOk ： 当机器人充电至此阈值时，机器人达到可接运单状态。
注意：当设置的电量阈值为 -1 时，则不启用该功能。
## 特殊站点属性
CP 点：点击【启动编辑】，选中场景中 CP 点，右边则会显示站点属性，点击【绑定】，勾选机器人名称，值下拉选择为【true】，点击确定即可。绑定后机器人才能去 CP 点充电。如图所示：
1711080441472-e30dbbfa-999e-4c6b-bc4b-1dee9d970e7f.png

PP 点：为停靠点，是调度场景中必须设置的特殊工作站。需要做同样的绑定操作。结束后可点击【退出编辑】并按照提示上传场景。

## 天风任务
 首先打开浏览器，如果本机为服务器，就在浏览器地址输入 http://localhost:8080/ ，进入 RDS 网页端登录界面，输入账号密码，初始默认为用户名：admin，密码：123456 。登录进 RDS 后，可在【运行监控】页面中，右击选中【拉取场景】按钮，和 Core 中的场景保持同步，一般来说该页面的场景会自动更新。
1711080734639-18a66b3d-35c6-4199-b8c0-fa14ede457d9.png

## 创建搬运天风任务
步骤①天风任务】页面——【定义新任务】——弹出任务创建框——命名为 test——设置为普通任务——确认生成。
1711085203808-b2010af6-8644-4cdd-83a3-c938982c5530.png

## 运输任务编辑
当前场景中，业务逻辑是到 Loc-1-1 取货 load，到 Loc-2-1 放货 unload
点击 test 任务右侧的【编辑】按钮，进入任务编辑界面。 
1711085796977-df3e1261-79f2-482b-bb2f-efc790ba8a65.png

## bintask 绑定：
### 步骤①把左侧“选择执行机器人”拖到右侧框中
步骤②把左侧“机器人通用动作”拖到右侧选择执行机器人下级动作中
步骤③④⑤在“机器人通用动作中”选择指令，简单值，下拉框中选 bintask，
## 步骤⑥点击参数
1711086990802-d5f95b87-0b79-4e34-940b-9a335e0faaf1.png

点击参数后，在下面文本框中填入你在地图站点库位中输入的键值，这里是 load
1711087311169-02c3528f-9b50-4314-a858-167c2653652a.png

1711087413367-8bd9c56f-ba08-4aeb-8357-c30fccfec5dd.png

## 绑定库位：
步骤①②点击目标站点名，在下面文本框中填入库位名字 Loc-1-1
1711088156972-d6567a42-e081-47f6-9626-bb0c75bd6b22.png

unload 的动作和前面 load 的操作一致，编辑后如下图
1711088560437-09a578f2-98b1-4377-8926-1d0fde581bbb.png

## 运行任务
在任务列表选中任务 test 点击【运行】按钮，弹出确认界面，就可以提交天风任务。
1711100188721-7f5d6b06-340b-4870-9637-4fd7b8fe8ac9.png 

## 任务查看和运行
在【任务管理】界面，可查看运行的所有过程和运行状态。
1711100115791-c1d01021-8ce2-4aaf-95a4-0f583980adf6.png
