# Curtis F2A 升降驱动配置SOP

### Curtis F2A 升降驱动配置SOP

## 版本

## 更新日期

## 更新说明

## 文档状态

## 维护责任人

## V1.0

### 2024.4.29

## 更新发布

## 使用中

选择 func 功能为 linear 的 motor 模型文件，开始进行升降电机的参数配置 
1709813651002-c606482c-a1ae-42ee-83f2-c8007e2ae67f.png

## can通讯配置
确认上一步can设备已启用，在行走电机 motor 模型文件上根据电气接线配置对应的canport，canID，cbd15在can1，且升降驱动设置的canID为3
1709813510481-192c5640-bef7-422c-a46c-c227f19e92dc.png

## 驱动器品牌根据实际情况勾选，如下图
1709813696226-ea889334-a806-4162-ac78-d9f4b3667649.png

## 位置与机械参数配置
### x: 右手坐标系下的 x 位置，如小车模型中坐标
### y: 右手坐标系下的 y 位置，如小车模型中坐标
### z: 右手坐标系下的 z 位置，如小车模型中坐标
### yaw: 右手坐标系下朝向角，右手坐标系下的 x 位置
### maxRPM: 是指电机的最大转速，请根据实际情况进行填写
inverse: 驱动器是否反向，勾选则为反向，不勾选则为正向。请根据实际情况进行勾选
### wheelRadius: 请根据实·际情况进行填写
### reductionRatio: 请根据实际情况进行填写
### minimumspeed: 请根据实际情况进行填写
### encoderLine： 请根据行走电机实际情况进行填写
## maxAngle: 舵角最小角度
## minAngle: 舵轮转向的最小角度
### steerOffset:舵轮角度的偏置值
steerOffsetFile: steerOffset值所在的文件夹
steerResolution:舵轮旋转的位置模式的速度,现在只能用作kinco 配做转向电机的时候，请根据实际情况进行填写
1709813736161-6998a846-d780-48c4-9790-252463f414ad.png 

1709813751485-5b21d9a3-0978-4837-8661-2d2d3bd544d9.png 

1709813775891-bd9f558b-a7ca-4824-ba31-94e90bf02cc3.png

升降由于是泵控，不带编码器反馈，所以需要配置上下限位di，如下图
1709813798764-2d7594d5-6d98-43b6-a0bd-71ef06229597.png

## 外置编码器不启用
1709813940871-d375c1b8-4915-46b4-9ea5-c22a1b70004e.png

## fork模型文件配置
### 在模型文件左侧找到fork项，本文对fork参数进行配置
DOhAbwTfsoY3lWxADLgcKjtEnrd.png

## basic基础参数
## 模型文件如下图所示：
## image.png

## 具体参数含义解释如下：

### forkBlockRegion：货物扣除区域
## 对应的参数区域如下图所示：
当AGV叉车抬起货叉的时候，叉车的架子会遮挡一部分激光。需要用扣除区域将这部分激光去除，防止碰撞检测误触发。一般与block laser 同时使用。因此搬运车无需启用这个参数。
Ps5QbMCV8oOPpHx8xrYcdTEmnnh.webp

## 具体参数含义解释如下：

## forkTailDi: 货叉尖端 DI
在叉车叉货时其货叉尖端传感器可能会被栈板触发，报阻挡，因此导致无法取货。可以在模型文件中配置货叉尖端 DI，可以指定载货，卸货时是否启用，是否自动清楚错误等功能。
如果没有di型叉尖传感器，则填"-1"不启用。因此cbd15不启用
FHtsbLXBxoqdrOxvG9scWCGfnzh.png

## 具体参数含义解释如下：

forkTailDistanceNode: 货叉尖端测距型传感器
在执行 ForkLoad 任务时可能导致距离传感器会误触发阻挡。通过在模型文件的配置叉尖距离传感器 (distanceNodeId) 的 id后，在载货的过程中会屏蔽该传感器。
## 截图如下所示
OPEWbvvY6oE5M5xJWZxc8bU3nfd.png

不过，大部分情况下为了依旧有检测障碍物的能力，但是不被栈板误触发，我们不屏蔽距离传感器，但是把载货时的碰撞检测距离缩短，这也可以通过配置模型文件实现。
## 具体参数含义解释如下：

## BackLaser: 后避障激光
参数截图如下图所示，搬运车起升高度有限，一般不在叉齿根部装后避障激光，所以填写"-1"不启用，即可。
NfWwbXSngorJBux5p87c1YZfnlf.png

## weight:超重检测
## 参数截图如下图所示：
当叉车在抬升的过程中如果叉车检测的重量持续一段时间超过最大重量，则报错 52170。
## 参数释义如下：

## type: 货叉类型
## 参数截图如下：
TEgWbOP03owhcTxfshEcDMnInY1.png

cbd15起升后货叉距离地面高度0.205m，且上升由是泵控电机执行、下降是阀控制，不带编码器的高度、速度反馈，柯蒂斯控制器仅返回到位信号，因此货叉上升下降为开环运动。
为了避免叉车导航过程中，货叉突然下降，导致的危险情况。当货叉到位后，当货叉下降持续时间小于 maxHeightBiasTime，且货叉高度发生变化范围大于maxHeightBias后，会报错 52171。 由于有报错机器人无法导航，或者继续运行。
## 具体参数解释

## 验证
## 控制货叉上升下降，可正常控制
