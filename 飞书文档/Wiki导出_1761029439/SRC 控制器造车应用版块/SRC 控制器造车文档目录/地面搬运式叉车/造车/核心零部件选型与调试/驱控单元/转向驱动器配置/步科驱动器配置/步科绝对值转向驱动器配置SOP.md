# 步科绝对值转向驱动器配置SOP

## 步科绝对值转向驱动器配置SOP

## 版本

## 更新日期

## 更新说明

## 文档状态

## 维护责任人

## V1.0

### 2024.4.29

## 更新发布

## 使用中

## 工具准备

## 下载步科上位机软件
在使用步科驱动器之前，需要对驱动器的232通讯口进行连接，需要使用上位机软件进行配置，点击下载 ，如图
1709802338558-b6ca8cc1-fac3-4a65-8022-3fd3bbe54786.png 

## 232/485调试线
## Roboshop
## 网线
## 转向驱动器配置
## 导入cdi文件：
1 在导入文件之前，需要先使用RS485调试线与驱动器进行连接(网口端连接驱动器RS232口，USB端连接电脑USB口)，点击“通信设置”，待右边的指示灯为绿色常亮状态时则说明已经成功连接该驱动器，如图二；
1709802357461-08d8b274-6b5b-47e1-a3e7-0405a65dae40.png

### 2 点击“写驱动器配置”，将cdi文件导入到该驱动器中，如图，cdi文件 点击下载 ；
1709802362894-281abebd-68de-4452-9d4e-4053cfb0dd04.png

### 3 点击“打开文件”①，并选择所需要导入的文件，如图；
### 4 点击“写入数据”②，将选择的文件写入到驱动器中，如图；
### 5 点击“存储数据列EEPROM”③，将写入的数据存储到驱动器中并点击“重启”，如图；
1709803748878-7a2fa26d-2c55-4689-ab44-d1f0604c03ec.png

## 手动标定
### 1 点击状态栏里的“I-O”，将“DIN1”里的“紧急停止”取消掉，如图2.1；
1709803814877-15aebc52-3130-4b8e-a0f2-61f0f3802d50.png

### 2 如图2.2 ，点击“驱动器D”-->“初始化/保存/重启”，按照图中的顺序一步步操作， 不可点击“初始化控制参数”
1709803898226-de63f24d-b0df-4d3d-afe5-9e958e5c7016.png

### 3 如图2.3，点击“驱动器D”-->“基本操作”；
① 将工作模式选择为3，此时模式为速度模式；
② 将控制字写入f，为使能状态，可看到有效工作模式为3；
③ 将目标速度给定一个值，-50rpm向左转动，50rpm向右转动，根据实际情况进行设置；
④ 待舵轮旋转到肉眼为正的时候(车头方向，电源线为右)，将目标速度置为0rpm；
⑤ 再将工作模式更改为6，控制字写入103f，此时模式为上电找原点模式，可看到实际位置为0inc
⑥ 再将“I-O”里的“紧急停止”恢复，按照3.2步骤操作一遍即可；
1709803941219-b3d0d71c-e533-4a30-8b05-48609ada9286.png

## 配置底盘模型
### 1 点击①至模型文件界面，在左侧点②加载，此时选择一个已有的单舵轮搬运车模型文件③，后续修改，示例 点击下载 ，打开后点击⑤上传至控制器。
1709719449643-322feff1-ac97-4a63-8018-e0c89228e994.png

### 2 点击①处紫色方框，右侧弹出chassis配置界面，按车体的模型进行长宽配置。
1709719517365-60446281-1b86-4858-aee1-b0f76bccc84d.png

## 3 模型文件具体参数说明如下：
1708952349478-bb6e4d7c-a1ea-4086-b6f2-618f6174fae9.png

## mode: 选择单舵轮模型steer
## Shape: 底盘形状，选择矩形
### rectangle: 选择rectangle矩形
## width: 填入矩形车的宽度
### head: 矩形车的里程中心到车头的距离
### tail: 矩形车的里程中心到车尾的距离
## height: 矩形车的高度
wheelBaseShiftLength: 货叉抬升与货叉降低后的里程中心偏差值
## 转向驱控
选择 func 功能为 steer 的 motor 模型文件，开始进行转向驱动器的参数配置
1709811827693-dc2144c6-7ab9-485e-9ebc-ed2e283cd66e.png

## motor驱动器can通讯配置：
确认上一步can设备已启用，在行走电机 motor 模型文件上根据电气接线配置对应的canport，canID，cbd15在第一路can，且步科转向电机设置的canID为2
1709812209211-43cedfb8-c9e8-4507-863e-9c6d9b447118.png

## 驱动器品牌根据实际情况勾选，如下图
1709812582034-5e3b1228-9075-439d-ab39-5f7744c9a5a1.png

## 电机位置与机械相关参数配置
### x: 右手坐标系下的 x 位置，如小车模型中坐标
### y: 右手坐标系下的 y 位置，如小车模型中坐标
### z: 右手坐标系下的 z 位置，如小车模型中坐标
### yaw: 右手坐标系下朝向角，右手坐标系下的 x 位置
### maxRPM: 是指电机的最大转速，请根据实际情况进行填写
inverse: 驱动器是否反向，勾选则为反向，不勾选则为正向。请根据实际情况进行勾选
### wheelRadius: 请根据实·际情况进行填写
### reductionRatio: 请根据实际情况进行填写
### minimumspeed: 请根据实际情况进行填写
### encoderLine： 请根据行走电机实际情况进行填写
## maxAngle: 舵角最小角度
## minAngle: 舵轮转向的最小角度
### steerOffset:舵轮角度的偏置值
steerOffsetFile: steerOffset值所在的文件夹
steerResolution:舵轮旋转的位置模式的速度,现在只能用作kinco 配做转向电机的时候，请根据实际情况进行填写
1709812765686-1d5c5163-f979-4967-b502-721b5523333e.png 

1709812777082-d06562b7-846b-4a58-b6f5-a6342db3ed5c.png 

1709812799174-d12371d4-9a5f-4876-9d06-f939f2d35e68.png

旋转电机是绝对值编码器，没有零位上下限位、外置编码器等参数，这些值填"-1"不启用
## 验证
手动控制电机转向可以打舵角，到固定角度，如30°，90°，-30°，-90°可以正确执行角度
