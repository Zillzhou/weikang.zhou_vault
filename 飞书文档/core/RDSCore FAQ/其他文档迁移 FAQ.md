# 其他文档迁移 FAQ

## 其他文档迁移 FAQ
## Core绕障功能不起作用如何排查
### 绕障相关知识可参考： AvoidObsRegion 组绕行
## 需要注意：
### 使用前需要保证，发生绕行的区域在绕行高级组内
使用前需要保证机器人的参数配置中的 ObsStopDist 和 Load_ObsStopDist 小于 AvoidPlanDist 。 ObsStopDist 和 Load_ObsStopDist 的参考值为 AvoidPlanDist 一半。
### Core 动作完成后停顿一段时间再运动是为什么
调度系统 Core 在机器人完成用户指派的任务后，会过一段时间自动生成停靠或者充电任务给机器人。这个时间，可以通过 Core 中参数配置的 StartParkTime 和 StartChargeTime 来配置，详见 自动任务的配置参数
### Core 中关于 MAPF 的参数如何理解
前言： MAPF 和 G-MAPF 都属于多车调度算法的范畴，从 RDSCore 的产品迭代角度来说，G-MAPF 是 MAPF 的迭代升级版本，G-MAPF 覆盖所有 MAPF 功能，并且已经不再维护 MAPF，故在今后大多数情况下，MAPF 和 G-MAPF 是可以均用来指代 RDSCore 的多车调度算法
MAPF 参数总表可参考： 使用 Roboshop 一键设置 G-MAPF 通用参数
从用户使用角度来看，当前 G-MAPF 主要从下述 6 个层面阐述参数功能：
机器人视野大小：机器人只会考虑视野范围内的与其它机器人的冲突，避让、绕路的过程都需要在视野范围内完成，同时视野越大，算法的算力需求越大
### 库位避让：是否允许机器人进入绑定了库位的点位避让
双向路对开：算法对于对开与跟车的策略是不同的，应该选择合适的方案
自动修改点位属性：算法根据车辆实时运行状况来动态修改点位属性或参数（如自动添加互斥区等）
## 其他通用参数：
从功能划分的角度，G-MAPF 参数主要阐述下述几大功能模块：
基础概念：视野、下发路线长度、解的质量、定制搜路、叶子结点大小
## 避让逻辑：避让范围、避让点选择
### 排队与绕行：队列模式、队列长度、绕行选择、环形锁
## 旋转检测：旋转检测、自动 fluent
## 错误恢复：阻挡后的解死锁、策略选择
## 曲线检测：复杂曲线解死锁
### 动态修改属性：动态互斥区、动态跟车距离、动态自由点位、
### Core 运单的 ID 是否可以重复使用
目前Core收到重复的ID后，不会创建新的运单。接口层没有重复id的报错，是为了兼容使用 setOrder 接口添加动作块的使用场景。相关信息参见API文档 创建运单
## Core 支持哪些操作系统以及对应版本
目前支持Windows Server 2016/2019, Ubuntu 18.04
参考产品基线中关于操作系统要求的部分 调度系统（RDS）产品基线
## Core 是否能保持门禁的开门信号
目前，当机器人进入门时，Core会 1s 发一次指令。当机器人控制电梯会 一般 2s 发一次指令。参见
## 门（door）电梯（lift)
### Core 是否有用户写 PLC 门控和电梯的标准协议
## 同上条
## 光通讯下调度是否必须使用 RDS
光通信方案下的调度，通常用不到 RDS，仅使用 Core 即可，详细可参见光通讯模块解决方案
### Core 中不同类型机器人能否在同一工作点工作
能，目前没有参考的解决方案，因此具体情况具体分析。
参考设置如下：两种机器人两幅地图，每张地图上设置相同名字的点位，即表明是同一个工作点。
需要注意的是，G-MAPF 下，同名点位的实际坐标相差不宜超过 15cm
### Core 接管第三方车体是否有安全和干扰问题
目前Core支持和其他调度系统在同一个区域内，如同一个车间中工作。 
信号干扰问题还未出现，因为Core不会控制其他调度系统控制的车辆，因为Core有控制权，其他调度系统也无法控制Core控制的车辆。 
交通事故是通过系统间互斥组来避免的。配置系统间互斥组后，同时只能有一个系统占用指定的区域。互斥区资源占用策略其他系统通过HTTP API操作互斥组 占用互斥组释放互斥组查询互斥组状态
## MAPF 的多车是否有数量限制
当超过一辆车时，如果每辆车都以自身任务的最短路进行搜路，会产生死锁时，都属于多车调度的范畴。当前的 MAPF 存在数量限制，同一时间内可能会导致死锁，需要进行联合搜路的机器人数量上限，在 50 个左右。同一时间内不会导致死锁的其他机器人，可以不计算在这个数量之内，场景中整体机器人数量可达百台左右
## Core 的回调配置如何使用
目前的配置文档：完成回调。其中每部分都有简单的实例。目前没有视频教程
## Core 能否支持主动上报反馈信号
### 目前core有两种机制可以主动上报反馈信号：
通过 Websocket 获取机器人信息，详情见 获取所有机器人信息
### 动作块执行完成上报信息 和 拼合单状态变化回调
### Core 是否支持不同种类小车使用同一张地图
不同种类的amr，因为激光高度不同，怎么在同一张地图上用rds进行调度 ?
多类型车在同一区域是应该使用多张地图还是单一地图？RDScore如何是否支持多种地图的使用?
## 不同车型的地图导入RDS怎么保证使用？
问题1， 激光高度不同，不同类型的 AMR 不能用同一张地图。
问题2，不同类型的车，用不同的地图。
问题3，不同车型的地图导入 RDS 后，该车型则只能运行在它配置的地图上，即该车型接收下发任务，只能去配置的地图上的站点。
## Core 断网时任务是否会丢失
网络短暂断连导致 Core 和机器人短暂断连的情况，可以继续执行任务
临时断电导致 Core 重启的情况，需要在参数配置中将启动时清理订单的 ClearDBOnStart 选项关闭，这样在 Core 断联时订单信息会储存进数据库，Core 就会在重启后继续执行任务
## Core 如何保证调度的安全性
调度方面，有很多安全性方面的问题。
### 目前，多车资源占用的，防止碰撞的安全性如下：
## 多机器人的资源占用逻辑
当门和电梯失联时，正在驶入门和电梯的机器人，会立刻停止任务。
### Core 在光通讯下的工作原理和实施手册
请参见：光通讯模块解决方案 。
## Core 是否能控制协议开放的友商车体
目前，Core 只能实现我们自己车子的调度。
### Core 如何实现其他厂家 AGV 的交通管制
目前支持Core控制的AGV和其他系统控制的AGV不同时出现在某个区域内的功能，不需要上报点位。
通过互斥组实现：互斥区资源占用策略 MutexByOtherSys组
## Core 中库位管理的边界是什么样的
Core支持通过PLC实时检测库位状态，给出库位是否在线、是否被占用、占用者信息。
### 详细文档参见库位检测：库位监控（bin）
### Core 中同一区域小车无法同时添加两张地图
对于同一台小车，在一个区域内只能使用同一张地图。除非小车会进行跨区域或者跨楼层时，可以在不同的区域（Area）中添加不同的地图。
## API 能否判断任务无法执行并反馈
调度会对报文格式进行一些检查：如是否缺少必要字段、字段数据类型是否正确
同时也会对订单逻辑进行检查：如机器人是否存在场景中、是否有符合机器人组和标签的机器人、目标点是否可达
这些错误会在订单查询的返回结果中 error 字段显示，如下图：
1692066089685-b6078c02-c6f1-4fba-b9cc-393befebf9f2.png

## Core 的任务分配原则是怎么样的
## 详见文档 选车逻辑（订单分配模块）
简而言之，需要从 优先级、距离、时间 三个维度加权计算订单价值，根据订单价值进行分配
并且支持重分配、换车执行等特殊逻辑，其中 拼合单、分拨单具有独立的分配逻辑
## Core 是否支持订单超时预警
Core 目前不支持运单超时预警，目前也没有这方便的客户需求，和开发计划。
## Core 库位检测同步不及时如何排查
需要检查RDS中的库区配置和Core中的是否一致。
### Core 库位上多动作时优先级顺序是什么样的
库位上的动作，是通过多个串联的 动作block 实现的，执行顺序是按 block 的顺序执行。
### Core 中各种设备的硬件说明及配置方法
### 原始问题1： 电控柜的部署缺少方案以及方法 【蔡扬帆】
原始问题2： 门控、梯控等解决方案缺乏详细的硬件说明及部署方案 【官少伟】
原始问题3： 设备在过自动门和电梯的时候如何进行信息交互？ 【周鑫】
原始问题4： 对于卷帘门、门控的控制方案有没有具体的电气图纸接线 【张贺飞】
RDS的MODBUS通讯没有详细的说明文档，如自动门配置，电梯配置，与产线PLC的IO对接配置【丁龙海】
原始问题5：Modbus poll和slave的测试案例，如何配合RDS做梯控、门控、光电检测等【王浩天】
原始问题6：RDS的modbus通讯的时间设置是怎么样的，最快的扫描周期是多少【赵快】
### Core目前没有指定电控柜，只有软件通信上的协议
### Core目前没有指定门控、梯控的硬件解决方案
门控的交互逻辑：门（door）梯控的交互逻辑：电梯（lift)
## Core目前没有指定门控的硬件解决方式
## 待完成
目前门控、梯控、库位检测和终端的读取时间间隔都为固定值，写入支持配置，默认为2秒写入一次
### Core API是否支持查询当前小车的任务状态
可以通过运单号查询运单状态，可以 通过外部单号查询运单状态，可以分页查询运单信息等
### Core API 中是否支持设备断连状态查询
查询库位状态通过HTTP API查询到的库位状态中， status 为连接状态
## Core 绕行区域如何理解和配置
### 绕行相关文档： 绕行 AvoidObsRegion 组
对于自由导航绕行，机器人只有在绕行区域内被阻挡，才会触发绕行逻辑。在绕行区域外不会触发绕行逻辑，因此需要将使用绕行功能的区域添加进 AvoidObsRegion 高级组中
### Core 是否有对外的 Modbus 协议
RDScore 对外只提供 http 协议的接口，没有 modbus 的接口。
## Core 能否支持与机械臂通讯
core 不可以直接控制机械臂，目前机械臂由 rbk 单独控制
### Core 拼合单功能的调度逻辑是怎么样的
## 拼合单相关文档： 拼合单 创建拼合单
拼合单是给具有运输多个货物功能的机器人使用的，发送时需要指定取货点和放货点，调度根据货物位置、机器人位置，将订单添加到机器人的订单队列中，来实现拼合单
### Core 多车不能同步同一张地图如何排查
## 解决地图不一致问题
## Core 机器人不接单问题如何排查
下发运单的格式不正确，比如机器组，标签不在场景中、缺少必须的字段、数据类型不对。
订单逻辑不对，比如指定的机器人不存在，目标点不可到达、机器人存在报错
没有空闲的机器人可以接单。
调度中有 52113 报错，存在不在线上，但是资源占用的机器人
## 报错如图：
img_v3_02os_ea587804-e669-4709-b3ba-a17f673485ag.jpg

img_v3_02os_5cc54b5e-1b40-472c-89fd-aef23384ee3g.jpg

### Core 多车使用同一张地图时互斥区如何配置
不同类型的车，不可以在同一个机器人组内，也就不可以使用同一张地图
### 相同类型的车，使用同一张地图，互斥区正常使用即可
### Core 机器人数量对服务器的配置要求是否一致
和场景的大小，机器人组数量有关。比如惠州永发项目，16台车，用了 14 G。
### 【现场】【惠州永发电子】【core】【路线规划问题】
而场景简单的场景，150 台车，一共占用了 4G。比如这个coding:
### RoboView与RDS融合的服务器选型测试-极限测试
## MAPF 的原理以及适用于哪些场景
### 添加MAPF使用说明，如何判断什么环境需要启用【张坤】
### 原始问题： MAPF哪些具体场景可以使用【王浩天】
### core上的MAPF在项目过程中具体是用来解决什么问题的
core中MAPF这个功能目前做到什么程度了，什么情况下能用？什么情况下不能用？目前使用下来有很多问题【罗杰】
https://seer-group.coding.net/p/order_issue_pool/bug-tracking/issues/435/detail
## 以上 Coding 出现过此问题

关于 G-MAPF 的检测原理和不适用的情况可以参考文档（ G-MAPF 参考手册 ）。
当人工画互斥区，也无法解决死锁，或造成效率低下时，可以考虑使用 G-MAPF，关于使用算法时出现情况的原因分析可以参考这个问题（ Core 开启 MAPF 后死锁如何解决【向英杰-黄强盛】 ）。
使用 G-MAPF 时需要保证算法的死锁检测条件能够被满足，对于特定区域内不满足的情况，需要对地图中的点位和线路进行优化，或自定义点位属性辅助算法进行检测，关于点位属性的配置，可以参考文档（ G-MAPF 参考手册）。
## Core 挂了，无法重启
## windows 版本：
core 挂了无法重启，可能原因是 core 假死。这个时候需要手动将 rbk.exe 的窗口关闭，然后手动点击 rbk.exe。
如果手动点击 rbk.exe 也无法启动，那么可以右键 点击 rbk.exe，然后选择以管理员权限运行 rbk.exe。
重启后，需要取一下 奔溃前后的日志提给研发分析，具体原因。
