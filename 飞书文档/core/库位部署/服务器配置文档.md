# 服务器配置文档

## 服务器配置文档
## 一 制作Ubuntu18.04系统u盘
## 1 下载Ubuntu18.04镜像
下载地址： Ubuntu18.04 ；
## 2 下载并安装UltraISO
下载地址： UltraISO ；
## 3 制作Ubuntu18.04系统盘；
准备一个4g U盘用来制作启动盘，备份u盘原有数据，制作过程会格式化u盘；
打开安装好的UltraISO软件，点击 继续试用 即可打开软件，点击菜单栏 文件 ，在下拉选项卡点击 打开 ，在弹出的对话框选择下载的Ubuntu18.04镜像ISO文件，点击打开。
1680167053013-9bfdb884-78c4-4469-a0ca-60e44747d4bf.png

1680167064327-9ba684fd-0d02-4b1c-8e26-d55035261027.png

点击菜单栏启动，在打开的选项卡里点击写入硬盘映像，在弹出的对话框依次选择硬盘驱动器（选择刚插入的U盘）、写入方式（USB-HDD+）、格式化、写入。
1680167156477-589df7ec-b53d-4bab-9fbb-4ba761b16972.png

写入完成，点击关闭，Ubuntu18.04系统驱动盘制作完成
## 二 安装Ubuntu18.04系统
## 1 设置启动项
关闭主机，插入U盘，主机开机，迅速不间断按F12（不同电脑进入BIOS的按键不同，一般为F12或delete键）进入BIOS界面，进入Boot Menu，进入Boot Manager后选择插入的U盘为启动项，进入安装界面，选择 Install Ubuntu。
## 2 正式安装
## 选择语言：选择英文
1680167538907-9e2d5977-38a3-4dfc-847c-de0e3269b58a.png

## 键盘布局：选择英文
1680167663459-def32bc2-f90c-4531-a846-5b407477c23c.png

## 网络连接：选择不链接
更新选项：只勾选Normal installation，下方Install third-party software for graphics and Wi-Fi hardware and addtional media formats不勾选。
1680167769793-718e2d50-e0ff-4bfb-a8ce-05784a390c8e.png

选择安装类型：安装Ubuntu、选择安装的磁盘与Windows Manager共存
1680167809421-6d646c04-7df9-46a3-83ea-74c8b6a9e1a9.png

磁盘选择第二块 1TB 磁盘，然后点击 install now
1680167925733-cd5ce6b9-c8c8-4d16-8654-2bbc6e58ea06.png

### 选择时区：点击地图中的中国地图会自动选择上海
1680167981712-55448382-2dd8-4106-926a-3e003da402d3.png

## 创建用户名：创建用户名和密码
1680168007216-4f778a23-3b33-42ad-82f2-81068a9a1db9.png

## 安装系统：安装完成重启电脑并拔掉U盘
1680168034185-a44239a2-da51-4ba5-8f9a-4894196575c2.png

1680168046792-a1c3d39f-583f-4c78-8e2e-931be3ad08c8.png

## 三 安装有线网卡
## 1 安装网卡
## 关闭主机
打开主机侧盖，将有线网卡（ F902T-V4.0 ）插入PCIE插槽并拧紧固定螺丝。
1680168124065-3cb34d45-003f-49f4-b507-3c290a3b15eb.png

1680168136594-b9f021c4-6e2c-44fe-a714-5ac3a66df103.png

## 2 设置BIOS
## 打开电脑
关闭Secure Boot： 开机不间断按F12（不同主板快捷键不同，一般为F12或delete）进入BIOS，此处以联想刃9000K为例，找到Security--->Secure Boot--->Disabled。
1680168698554-b549582f-351b-4781-ae53-1acb026049b3.png

1680168708478-a30f5f50-c825-4c2a-96dc-46657c446bb2.png

关闭板载网卡：找到Devices--->Network Setup--->Onboard Ethernet Controller--->disabled。按F10保存设置，重启电脑。
1680168901238-8dfa26ca-12ab-416d-a60e-8379db2fb426.png

在有线网卡的网口插入网线并打开电脑，在设置中设置网口的IP地址；
## 三 系统更新
## 1 更新源
## 打开软件和更新软件
1680168396257-c446e15b-6ee3-4f55-ba7d-833771f1e8a4.png

1680168400375-4f644131-df99-41a2-b281-9498df4a6bdd.png

设置阿里云源（也可是其他源，如清华源），点击Download from右侧倒三角，选择others，从中选择china，再选择mirrors.aliyun.com，点击choose servece，最后再关闭软件和更新
1680168433424-ea484f46-0c06-4cb7-b1aa-e11a86d9f9d4.png 

1680168438324-8b05845c-0308-467e-b259-4935e36c6c8f.png

## 正在更换更新源
1680168465939-b340700a-84e1-4aab-a0c4-b32dd56f55ce.png

## 2 更新系统
Ctrl + Alt + T打开终端（Terminal），输入以下三行命令，中间遇到询问均选择“Y”
## sudo apt-get update
### sudo apt-get upgrade
sudo apt-get install build-essential
## 重启电脑
## 3 安装NVIDIA驱动
## 打开终端，查看可用NVIDIA显卡驱动
### ubuntu-drivers devices
1680169014424-bf6dd40c-18cc-450d-b726-9f95f6561785.png

安装NVIDIA显卡驱动：找到recommand推荐的显卡型号，如推荐nvidia-driver-470
sudo apt-get install nvidia-driver-470 //遇见询问按y
## 重启电脑
## sudo reboot
### 查看是否安装成功，出现如图信息表示安装成功
## nvidia-smi
1680169371864-5a169fa8-74a9-4564-9cef-67710ede531a.png

## 4 安装CUDA11.1.1
## 下载源文件
## 下载地址： cuda
安装cuda，在下载文件的文件夹下右键打开终端，运行下面命令
sudo sh cuda_11.1.1_455.32.00_linux.run
命令输入完需要等待一会，然后出现第一界面询问是否移除之前的，选择continue ---> accept ---> 选中driver选项，按enter键取消driver 的安装 --->install
1680169556087-cc764254-586c-4e41-9c76-3d337eff2615.png

## 配置cuda环境变量
### sudo gedit ~/.bashrc
## 在打开的文件最后一行添加
export PATH=/usr/local/cuda/bin:$PATH
export LD_LIBRARY_PATH=/usr/local/cuda/lib64:$LD_LIBRARY_PATH
## 然后保存文件
## 验证是否安装成功
cd /usr/local/cuda-11.1/samples/1_Utilities/deviceQuery //
### sudo chmod -R 777 *  //修改文件权限
## sudo make   //编译
./deviceQuery  //运行，出现”Result = PASS“字样时，说明安装成功了
1680169785989-700ce857-c02b-4477-8fa3-d977aaf35a3b.png

## 5 安装CUDNN8.0.5
## 下载CUDNN：
## 下载地址： CUDNN
安装CUDNN，在下载文件的文件夹下右键打开终端，运行下面命令
tar -xzvf ./cudnn-11.1-linux-x64-v8.0.5.39.tgz
sudo cp cuda/include/* /usr/local/cuda/include
sudo cp cuda/lib64/libcudnn* /usr/local/cuda/lib64  # 此过程可能比较久
sudo chmod a+r /usr/local/cuda/include/* /usr/local/cuda/lib64/libcudnn*
## 配置环境变量
### sudo gedit ~/.bashrc
## 在打开的文件最后一行添加
export CUDA_HOME=/usr/local/cuda:$CUDA_HOME
## 然后保存文件
## 创建软连接
sudo ln -sf /usr/local/cuda/targets/x86_64-linux/lib/libcudnn_adv_infer.so.8.0.5 /usr/local/cuda/targets/x86_64-linux/lib/libcudnn_adv_infer.so.8

sudo ln -sf /usr/local/cuda/targets/x86_64-linux/lib/libcudnn.so.8.0.5 /usr/local/cuda/targets/x86_64-linux/lib/libcudnn.so.8

sudo ln -sf /usr/local/cuda/targets/x86_64-linux/lib/libcudnn_cnn_infer.so.8.0.5 /usr/local/cuda/targets/x86_64-linux/lib/libcudnn_cnn_infer.so.8

sudo ln -sf /usr/local/cuda/targets/x86_64-linux/lib/libcudnn_ops_train.so.8.0.5 /usr/local/cuda/targets/x86_64-linux/lib/libcudnn_ops_train.so.8

sudo ln -sf /usr/local/cuda/targets/x86_64-linux/lib/libcudnn_cnn_train.so.8.0.5 /usr/local/cuda/targets/x86_64-linux/lib/libcudnn_cnn_train.so.8

sudo ln -sf /usr/local/cuda/targets/x86_64-linux/lib/libcudnn_ops_infer.so.8.0.5 /usr/local/cuda/targets/x86_64-linux/lib/libcudnn_ops_infer.so.8

sudo ln -sf /usr/local/cuda/targets/x86_64-linux/lib/libcudnn_adv_train.so.8.0.5 /usr/local/cuda/targets/x86_64-linux/lib/libcudnn_adv_train.so.8
## 验证是否安装成功，如下图表示安装成功
cat /usr/local/cuda/include/cudnn_version.h | grep CUDNN_MAJOR -A 2
1680170048814-e68d47de-1a77-4de5-a19a-c390135a482d.png
