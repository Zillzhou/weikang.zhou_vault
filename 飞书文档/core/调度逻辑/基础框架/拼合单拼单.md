# 拼合单拼单

## 拼合单拼单
## JoinableSumDist参数
## 问题：

有1，2，3，4，四条拼合单，两辆车A,B，
## A在入库口附近，B在出库口附近
一开始，只有1和2，分别分配给了两辆车，A执行1，B执行2过程中，又发送了3，A拼上了3，
B执行2，从出库口取完货后，上位系统又发送了订单4，此时，拼给了A，导致问题：
A执行1，3，4，
B执行2，
这是不合理的。
## 其他表现
### 订单下发很久后不执行：因为拼上了，但是拼到后面去了
### 订单很多，但是只有一台车在动，另一台车不动：因为都拼上了
机器人取一个货就走了，明明有新的货可以取，也有空背篓，但是不用：因为其他车拼上了
## 解决方式
### 上面的问题中，不应该让A在拼上1，3，后，拼上4
### 因为它并不是最优的车，应该让B执行2的过程中拼上4
为此，增加参数 JoinableSumDist：取货单插入点前预接单的最大总里程
尝试拼单时，当前的逻辑是：对于机器人当前订单和已经预接的订单，逐个计算终点和待拼订单的起点距离，如果小于joinableDist参数值，就拼。这个过程中没有考虑上面描述的1，3，4这样的情况下，即使3的终点和4的起点很近，也不能拼，因为插入4的取货订单的位置之前，有太多订单：1取货，1放货，3取货，3放货，机器人需要从入库口走到库区中，再从库区中走到出库口，来执行拼上了的4取货。
增加逻辑：如果拼单插入点之前的里程之和大于设定值，就不进行预接单了，让其他车拼，或者先不分配
