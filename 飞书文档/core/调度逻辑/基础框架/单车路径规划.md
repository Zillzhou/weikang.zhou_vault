# 单车路径规划

## 单车路径规划
## @黄强盛
## 简介
此文章介绍在不开启 MAPF 或者 G-MAPF 模式下的单车路径规划。
调度系统中使用的底层搜路算法是 A* 算法 ，以最小代价为原则进行搜路，算法的求解基于地图中设置好的拓扑点位。需要使用 A* 算法的场景主要有：
执行任务时的路径规划；
任务分配时的机器人选择；
机器人生成充电、停靠等自动任务时的目标点选取。
## 路径长度
路径规划中重要一部分是机器人行走某条线路所需的时间。线路的原始耗时是线路权重乘以线路长度。除此之外，我们在机器人行走时还会考虑线路的曲率，线路之间机器人原地旋转需要的时间，线路的堵塞程度来综合计算线路的耗时。
## 原始线路耗时
场景中每条线路可以配置权重。线路的初始耗时为线路物理长度乘以线路权重。线路权重在地图线路中的属性中。

## 参数名称

## 参数位置

## 单位

## 默认值

## 最小值

## 最大值

## 支持版本

## length

## 地图-线路属性

## 0

## -1

## 1e10

## ~latest

## 线路长度权重

## 动态路径长度
机器人在导航规划过程中，会实施规划线路，其会考虑线路的旋转角度、路径曲率、排队时间、停车因子等。这些参数可以在模型文件中进行配置。

## 参数名称

## 参数位置

## 单位

## 默认值

## 最小值

## 最大值

## 支持版本

## angleFactor

### 模型文件-PathPlanning-属性

## 1.0

### 0.0

## 1e10

## ~latest

## 机器人原地旋转的角度系数

## curveFactor

### 模型文件-PathPlanning-属性

### 0.01

### 0.0

## 1e10

## ~latest

## 线路的曲率系数

## queueFactor

### 模型文件-PathPlanning-属性

## 1.0

### 0.0

## 1e10

## ~latest

## 线路的排队系数

## slowDownFactor

### 模型文件-PathPlanning-属性

## 1.0

### 0.0

## 1e10

## ~latest

## 线路的减速系数

## stopFactor

### 模型文件-PathPlanning-属性

### 100.0

### 0.0

## 1e10

## ~latest

## 线路的停车系数

## liftFactor

### 模型文件-PathPlanning-属性

## 1.0

### 0.1

## 1e10

### 0.1.8.221115+

## 电梯线路长度系数

## doorFactor

### 模型文件-PathPlanning-属性

## 1.0

### 0.1

## 1e10

### 0.1.8.221115+

## 门所在线路长度系数

## updateThreshold

### 模型文件-PathPlanning-属性

## m

## 1.0

### 0.001

## 1e10

### 0.1.8.221115+

## 新规划的线路短于之前的线路多少m才更新

## updateRealTime

### 模型文件-PathPlanning-属性

## true

### 是否依据线路的实时状态实时更新机器人的线路

A* 算法中一条线路的实时耗时，是将是上面系数乘以对应值获得总耗时。因此，如果用户想要机器人尽量走直线，不想原地旋转，不想走曲线，可以将 cuveFactor 和 angleFactor 调大，但设置过大时，会导致不合常识的订单分配和路线选择。
对于原地旋转，angleFactor为1时，表示原地掉头的代价和走3.14米的直线相同；为100时，表示原地掉头的代价和走314米的直线相同，可以按照转90度等于走angleFactor*1.5长度的直线快速判断angleFactor是否合适。
如果想车子尽量少走电梯或者门的线路，可以将 liftFactor 和 doorFactor 调大。
如果想让车子遇到阻挡等情况，尽量少重新规划新的线路，可以将 updateThreshold 调大。
## 限制级路线选择
用于限制有货的库位是否允许机器人通行，库位状态信息来源库位监控（bin）
在开启G-MAPF时，需要打开调度参数G-MAPF-CustomizedAster才能使用此功能
### 0.1.9.240814 --- 0.1.9.250319 版本

## 名称

## 位置

## 默认值

## 含义

## 版本

## BinOccupyLimit

## 调度参数

## false

## 为 true 时
## 机器人不可以选择有货的点位的路线

### 0.1.9.240814 至
### 0.1.9.250319

### 0.1.9.250320 及后续版本
### 删除上述调度参数，改用下述模型文件进行设置

## 名称

## 位置

## 默认值

## 含义

## 版本

## binOccupyLimit

## 调度模型文件

## 0

## 0：任何状态机器人都可以通行有货库位
## 1：任何状态机器人都不可通行有货库位
## 2：只有载货机器人不可以通行有货库位

### 0.1.9.250320
## 及后续版本

## image.png
