# 充电与停靠

## 充电与停靠
## @丁禹伯
## 自动充电
### 当机器人需要充电时，调度会生成一个前往可用充电桩的任务
场景中 CP 点表示为充电点。在充电点上我们存在一个属性叫做 chargePoint，用于指示哪些机器人能够去这个 CP 点充电。

## 参数名称

## 参数位置

## 单位

## 默认值

## 最小值

## 最大值

## 支持版本

## chargePoint

## CP 点属性

## bool

## true

## ~latest

## 指示此充电点可以给哪些车充电

自动充电有 4 个阈值。当机器人不在充电时，有两个电量阈值，用于表示机器人两个状态，分别是 chargeNeed 和 chargeOnly；当机器人在充电时，有两个电量阈值，用于表示机器人另外两个状态，分别是chargedOK 和 chargedFull。

## 参数名称

## 参数位置

## 单位

## 默认值

## 最小值

## 最大值

## 支持版本

## chargeNeed

## 机器人属性

## double

## -1

## -1

## 100

## ~latest

当机器人电量低于这个值，并且没有任务执行时，会自动生成充电任务。

## chargeOnly

## 机器人属性

## double

## -1

## -1

## 100

## ~latest

当机器人电量低于这个值时，机器人不会接新的任务，执行完当前任务后生成充电任务

## chargedOK

## 机器人属性

## double

## 50

## 1

## 100

## ~latest

当机器人充电时在电量未达到这个值之前，不会接单。

## chargedFull

## 机器人属性

## double

## 90

## 1

## 100

## ~latest

当机器人电量超过这个值时，如果满足停靠条件，会自动生成停靠任务。

强烈建议上述四个参数大小关系：chargedFull > chargedOK > chargeNeed > chargeOnly
目前这四个阈值支持通过 API 动态修改，详见 修改机器人充电参数
## 机器人电量与订单关系：
机器人电量低于chargeOnly，会触发低电量标志位，此时机器人不会被分配订单
机器人电量低于chargeOnly或chargeNeed且机器人无正在执行订单时，会生成充电任务
## 普通停靠
### 当机器人没有任务时，调度会生成一个前往可用停靠点的任务
场景中的普通站点 LM， 动作站点 AP， 停靠站点 PP， 都可以用于作为停靠点，让机器人在此停靠。点位属性上的 parkPoint 用于指示哪些机器人可以来此停靠。

## 参数名称

## 参数位置

## 单位

## 默认值

## 最小值

## 最大值

## 支持版本

## parkPoint

## LM， AP， PP 点位属性

## bool

## true

## ~latest

## 指示此点位可以给哪些车停靠

当机器人拥有停靠点，在完成任务后，并且没有其他任务需要执行时，会生成停靠任务，前往停靠点。如果机器人拥有多个停靠点，机器人会选择一个停靠代价最小的点位进行停靠。
## 任务优先级
自动任务优先级低于普通任务，若在执行自动任务的过程中接收到普通任务，则机器人会在走完已下发路线后中断自动任务，优先执行其他任务。但是当机器人的电量小于 chargeOnly 时， 需要机器人先去充电。
