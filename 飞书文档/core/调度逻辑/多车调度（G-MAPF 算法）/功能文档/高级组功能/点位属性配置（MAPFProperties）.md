# 点位属性配置（MAPFProperties）

### 点位属性配置（MAPFProperties）
在使用 G-MAPF 框架时，用户可以对地图中的点位设置不同的属性，以定制化一些特殊的需求。

## 参数名称

## 参数 位置

## 默认值

## 支持版本

## MAPFProperties

## 场景/高级组

## Mutex

## ~lastest

## 点位属性的定制化功能

### 目前一共提供了 7 种属性的设置，含义如下表：

## 参数名称

## 参数位置

## 默认值

## 支持版本

## defect

## MAPFProperties

## false

## ~lastest

说明：禁止机器人在这个点位进行避让，该点位不可以作为中转点，但可以作为任务目标点

## fluent

## MAPFProperties

## false

## ~lastest

说明：机器人要么能一次性通过fluent区域，要么就不会进入。

## forced

## MAPFProperties

## false

## ~latest

说明：该点位被声明成可以强制通过，可以通过参数配置设置取消碰撞检测。

## leaves

## MAPFProperties

## false

## ~lastest

说明：设置为叶子结点，叶子结点的含义请参考 叶子结点(Leaves) 的文档说明

## observe

## MAPFproperties

## false

### 0.1.8.230511

## 说明：G_MAPF 进行效率统计的点位

## queuing

## MAPFProperties

## false

## ~latest

说明：位于该区域点位上的机器人强制进入队列模式，可以视为强制不进求解器 不稳定，如需使用请联系研发介入

## release

## MAPFProperties

## false

## ~lastest

说明：可以同时被多个机器人锁定的点位，详见 自由点位（Release）

## station

## MAPFProperties

## false

## ~lastest

说明：算法会倾向于让机器人停留在这个点上进行避让，会改变避让点概率分布，谨慎使用

这些属性配置只能配置点位，而不能配置路线，即使您将线路加入这些高级组里，也不会对线路起作用，演示图如下：
1690767282456-4e11da6e-152d-469a-8da8-d3d07ce15e7e.png

defect、station 的含义均与避让功能有关，当两个机器人的路线存在冲突时，其中一台机器人前往一个避让点来解决这个冲突；对于 G-MAPF 算法，避障点的选取是随机的，在实际应用中，有时对于避障点有特殊需求，这就需要上述两个参数来配置：
defect：如果不想某些点位作为避障点，可以将这些点位设置为 defect 属性，比如实际生产中往往不想机器人去工作站或货区或不属于其负责工作的产线避障，这时就可以将上述点位设置为 defect 属性
## defect 演示示例：
单车道会车场景：AMB-04 位于 LM465，AMB-05 位于 LM463，两车分别前往对方位置，AMB-05 可选择的避让点有 LM476、LM471、LM477 和 LM478 可以选择，在不设置任何 defect 点位时，AMB-05 会在上述四个点位随机选择，如动图 1 所示，AMB-05 选择了 LM477 避让，AMB-04 选择了 LM476 避让
将 LM471 和 LM477 设置为 defect 属性（蓝色点位），则两车不能去这两个点位避让，如动图 2 所示，AMB-05 选择了 LM478 避让，AMB-04 选择了 LM476 避让
1669087923325-ceaf0825-4405-4ee3-93b4-6ad642b92fa4.gif 

1669088126689-fc99c542-6d49-40b6-9827-d6ae9526a23f.gif

fluent：在即将下发的路线中包含 fluent 点位时，如果机器人能够一次性通过 fluent 点位，那么可以下发路线。如果机器人不能一次性通过 fluent 点位，则不能下发路径。
## 下图场景遇到的问题：
黄色点位所在线路为单条双向线，存在两车对开的情况，右上方存在一个单向环形路
希望实现：当一辆从左侧开过来的车要经过右上方时，另一辆从下方开过来想去往左侧的车可以在单向环路的向上单相线上等待，等到左侧来的车完全通过双向路后它再行动
### 下图是没有设置 fluent 属性时的运行情况
可以发现本来通过简单的等待即可顺利通行的情形，实际却进行了很多不必要的避让

### 点位属性配置（MAPFProperties）.mp4
## 使用 fluent 解决此问题思路：
将黄色点位设置为 fluent 属性，这样车辆在行驶到 fluent 区域前时，会判断是否可以一次通过所有的fluent 点位，如果不能，就不会下发路线，从而实现原地等待
## 更改后的效果图如下

### 点位属性配置（MAPFProperties）(1).mp4
station：避障点的选取是随机的，如果我们希望机器人前往某些点位避障，可以设置为 station 属性，注意，这只是会增大机器人选取这些点位为避障点的概率，并不能 100% 保证。
