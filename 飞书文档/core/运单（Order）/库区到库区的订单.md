# 库区到库区的订单

## 库区到库区的订单
## @杨达
### 0.1.9
## 解决的问题
Core的上位系统(RDS/MWMS)下单时，并没有完整的信息来选择库区中最优的库位；另外，库区中具体取放货到哪个库位对Core的上位系统来说并不重要。因此，最好由Core来接受库区输入，自行选择库位。
## 库区
## Core中的库位数据结构由两层组成：
## 库位
## 库区
## 目前场景中，库区和库位的限制：
库区不能嵌套，即，库区中的所有元素都是库位；
库位可以属于一个库区，或者不属于任何库区，不能同时属于多个库区（待确认，roboshop需要支持此功能）；
库位不能嵌套，库位不能组合，一个库位不能包含其他库位，库位不能属于其他库位
## 库区和实际场景的关联：
### 列库中的一列属于一个库区（可能无法满足WMS的需求）
## 待补充
## 地图中的库区类型
## Stack，栈式列库
## 待补充

## 场景配置
需要配置库区，并且库区类型选择 Stack，调度配置取货和放货前置点，以及依据库位对应的点位拓扑关系，计算出库位的前后顺序。
库区前置点：执行库区任务时，机器人会先到库区前置点，再从前置点进入库区
## 下单
## 使用类似拼合单的接口下单：
## URL
### http://host:8088/setOrder
## 请求体
## {
  "fromBinAreas":["A1","A2","A3","A4"],
  "toBinAreas":["B1","B2","B3"],
  "vehicle":"AMB-01",
  "group":"G", 
## "label":"L"
## }

## 字段名称

## 类型

## 描述

## fromBinAreas

## array<string>

## 可选的取货库区，从列表中之一取货

## toBinAreas

## array<string>

## 可选的放货库区，到列表中之一放货
### 在block中指定binArea支持更多定制逻辑（待定）：
## {
  "id":"order1",
## "blocks":[
## {
      "blockId":"block0",
      "location":"A1-pre",
## "operation":"Wait"
    },
## {
      "blockId":"block1",
      "binArea":"A1",
## "binTask":"Load"
    },
## {
      "blockId":"block2",
      "location":"Random",
## "binTask":"Custom"
## }
  ],
  "complete":false,
  "group":"G",
## "label":"L"
## }
## 查询
## 支持分页查询
http://host:8088/areaToAreaOrders
### 分页查询的使用方式和orders接口一致
## 样例数据：
## 分配
### 在分配订单时，根据下面方法确认取货放货库区：
去掉没有可用库位的库区，(待确认：所有库位都满了， 但是有机器人去取货，不久之后就有空库位的情况如何处理？)
## 选取离候选机器人最近的库区
订单分配完成后，
## 一定确认了去哪个库区取货、放货
## 生成了去前置点的block
## 从库区中选择库位
## 栈式列库
## 任意时刻，只能有一台车在库区中
### 离出口近的库位有货时，无法进入离出口远的库位
## 选库位的规则：
过滤掉库位状态不符合操作要求的；如，取货任务要求库位有货，放货要求库位无货
## 过滤掉无法进入的
## 选择离入口最远的
## 其他库区类型待补充
## 参数配置

## 参数名称

## 参数位置

## 单位

## 默认值

## 最小值

## 最大值

## 支持版本

### AreaOrderLoadBinTask

## 参数配置-导航

## -

## Load

## -

## -

## ~latest

## 取货动作

### AreaOrderUnloadBinTask

## 参数配置-导航

## -

## Unload

## -

## -

## ~latest

## 放货动作

## BinStatusExpireTime

## 参数配置-导航

## 秒

## 10

## 0

## 1000

## ~latest

## 选取库位时，库位状态的超时时间

## 报错码

## 报错码

## 报错内容

## 处理方法

## 60022

### No usable bin in area xxx

## 检查报错内容中的库区是否有可用库位
