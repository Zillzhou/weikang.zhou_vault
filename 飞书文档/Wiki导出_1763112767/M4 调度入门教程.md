# M4 调度入门教程

## M4 调度入门教程
## 初始化调度场景
## 入口
打开 M4 的“调度场景”菜单，在最开始，没有任何场景，界面会提示“请先创建或启用至少一个场景”。
## image.png

此时，需要进入场景编辑页面添加场景。点击顶部工具栏的设置按钮，进入场景编辑页面。在首次进入该页面时，场景编辑页会提示当前无任何场景，请先创建至少一个场景。
## image.png

## image.png

## 添加场景
点击界面左上角的“添加场景”，输入场景名为 demo，点击确定。界面新增该场景。
## image.png

在没有导入场景时，该场景缺少数据。各个配置项下方都是空页面。可以手工创建来配置场景，也可以导入已配置好的场景。后文会提到如何手工配置，这里为了方便，先导入教学场景。
M4 调度支持导入 M4 场景和 RDS Core 场景。本次教程以导入 M4 场景为例。将事先准备好的场景包，通过点击基础下的“导入场景”，进行导入。
## image.png

## 观察场景基础信息
导入后，场景的数据被成功解析。基础标签页下，可以看到场景基础信息，包括区域数、机器人组数、机器人数、地图数、场景 ID。除此标签页外，顶部还有机器人、区域、容器类型等其他配置项，如果场景中有，都会解析出来。
## image.png

## 一键仿真
导入场景后，由于没有真车，所有机器人都是离线的。为了方便大家尽快体验功能，这里先用仿真模式。在基础标签页下，点击“一键仿真”，即可创建仿真机器人、门、电梯。

## image.png

## image.png

一键仿真后，机器人变为在线，在顶部切换到“调度场景”标签页，可以看到地图上，机器人随机出现在 LM 点和 PP 点。且会生成停靠单，自动前往停靠点。
## image.png

## 简单发单
M4 提供快捷的简单发单功能，可以输入特定指令，让机器人运行起来。在调度运行页面的左侧，有四个标签页，点击其中的“发单”，切换至发单标签页。
## image.png

发单有简单测试和复杂测试两种，简单测试可以涵盖大部分的使用场景，这里仅介绍简单测试。
初次使用，可以点击“添加简单测试”边的“帮助”按钮，打开简单发单在线帮助的对话框。在对话框内，可以看到简单发单的规则说明以及常见的示例，选择一个指定机器人的示例，点击去执行，该示例就会被直接粘贴到发单的输入框内。
## image.png

## image.png

可以根据场景的实际情况，修改指令，将机器人和点位都修改为场景中实际存在的元素，如：让机器人 Box-2 去 AP41 取货，去 AP42 放货。修改完直接点击执行，机器人将开始执行运单。其他的简单发单指令，都可以通过在线帮助去体验，这里不再赘述。

## image.png

## image.png

## 调度场景界面功能介绍
通过菜单栏中点击“调度场景”，可以看到刚才创建好的调度场景。
M4 中，场景用来描述一个项目内机器人的工作环境，每个场景由其中的机器人及其组成的机器人组，地图及其组成的区域，以及门、电梯等设备构成。
## 切换场景
一个 M4 应用支持多个场景，如果有多个场景，可以通过左上角场景切换下拉框切换调度场景。
## image.png

## 地图
## 区域切换
一个场景可以包含多个区域，比如一个项目有多层车间，每个车间处于不同楼层。机器人可以跨区域运行，比如上下楼。每个区域的地图由在此区域内运行的机器人组的地图合并而成。
如果有多个区域，可以通过地图部分左上角区域切换按钮切换想要查看的区域地图。
## image.png

## 地图元素
在地图中，可以看到多种元素，目前 M4 支持的元素包括：机器人、门、电梯、点位、路径、库位、区块、文字、图片、坐标轴、环境点云。
## 拖动缩放地图
可以通过鼠标拖拽/触屏的方式移动地图视角。通过鼠标滚轮放大（向上）缩小（向下）地图，触控板和移动端支持双指缩放，也可以通过点击工具栏中的放大/缩小地图按钮来放大/缩小地图。
点击工具栏中的“展示完整地图”按钮，可以快速调整视图以查看完整地图，点击“框选放大”按钮，按住鼠标左键拖动即可使用框选框快速框选放大想要查看的部分地图。
## 选中地图元素、框选
单击地图上的元素可以选中地图元素，并且支持框选和复选。点击工具栏中的框选按钮进入框选模式，在框选模式下按住鼠标左键拖动即可使用框选框选中元素，也可以在框选模式下单击地图元素来复选元素。框选模式下，再次点击框选按钮即可退出框选模式，也可以使用 ESC 快速退出框选模式。另外，支持按住快捷键：Ctrl（Windows）/ Cmd（Mac）来快速进入框选模式，松开退出框选模式。
## 搜索
如果想要在地图中查找特定元素，可以点击右上角“搜索”按钮，打开搜索面板，输入想要查找的元素（支持模糊筛选），点击目标元素，即可将地图视角快速定位到对应元素，同时地图元素会闪动提示。目前支持搜索机器人、点位、库位。
## image.png

## 显示设置
通过显示设置功能，可以设置场景界面的显示效果。点击右上角“显示设置”按钮，打开显示设置面板，可以在其中设置地图元素及其属性的显隐、机器人列表样式的显示方式等。
## image.png

## 元素详情面板
选中元素后，可以在场景界面右侧的元素详情面板内查看对应元素的详情面板。
元素详情面板支持收起和展开。同时，可以拖动详情面板左侧边缘，调整面板宽度。
元素详情面板内，展示了该元素的详细信息和一些操作按钮。
详情面板内一个标签页对应一种元素。如果选中了多种类别的元素，如下图中，选中了机器人、门、点位、路径这几种元素，上方对应元素图标按钮会变为蓝色，点击对应图标按钮可以切换至对应的标签页。
如果同一类别的元素选中了多个，对于机器人、电梯、门等而言，可以通过下拉框切换想要查看的元素；对于点位、路径、库位等地图元素而言，会以表格的形式展示元素的详细属性，同时如果存在多个机器人组，会显示同一元素在不同分组地图下的属性值，比如同一个点位，在机器人组 A 下可停靠，但是 机器人组 B 不可停靠。如果选中了多个元素，且属性值不同，可以点击文本框右侧按钮，简要查看属性。机器人、设备（门和电梯）详情面板的详细内容请参照后续对应章节。
## image.png

## 场景状态栏
场景界面最下方是场景状态栏，包含了一些场景配置信息和功能按钮，比如“演示”开关、“回放”开关、是否打开运行记录等，场景配置信息、“回放”开关等功能含义请参照后面的教程，此处介绍“演示”功能。
打开“演示”功能后，地图的视角中心会在各个正在运行的机器人中切换。
## image.png

## 机器人
## 机器人关键概念和状态
在 M4 调度中，机器人存在一些关键的概念和状态。
启用停用：对于临时不使用的机器人，比如送去维修，后续还会使用。可以在系统中停用它，停用后，系统不会连接机器人，也不会接受机器人的连接。
在线：机器人和调度系统有两种连接方式：调度主动连机器人、机器人主动连调度。对于未成功连接上调度系统的机器人，会在系统中显示为离线状态。
可接单：表示机器人是否参与调度：分派和执行运单。对于不可接单的机器人，调度系统会保持和机器人的连接状态，以便获取实时信息，同时会考虑此机器人的位置，将其当作可能移动的障碍物，避免其它机器人与之相撞。
受控：表示调度系统是否有此机器人的控制权。调度系统控制机器人执行动作前，必须先获得机器人的控制权。
仿真：表示此机器人是真实存在的机器人还是模拟的机器人。注意，M4 的仿真机器人是独立的，功能强大的模块，除了没有实际的物理意义，与真机器人无任何差别。具体功能参照后文《仿真中心》章节。
## 机器人详情面板
机器人详情面板，主要用于显示机器人的详细信息，并且可以在详情面板上操作机器人，比如修改机器人某些状态。
如何打开机器人详情面板，请参照《调度场景界面功能介绍》- 元素详情面板。如果同时选中了多个机器人，可以在上方下拉框切换想要查看的机器人。
## image.png

## 配置
点击“配置”按钮，可以打开“编辑机器人”弹窗，用于编辑机器人的信息，具体配置项含义请参考《场景配置》章节。
## image.png

## 操作按钮
通过详情面板上方的按钮，可以对机器人执行一些操作。下面介绍一下各个按钮的功能。
智能恢复：集成了常用的故障恢复功能，如果运行时发现机器人出现问题（包括但不限于不动，不接单，有告警），可以先使用此按钮尝试解决。
AI 诊断：点击后，会打开 AI 诊断弹窗。AI 诊断具体功能请参照《简单处理调度问题》章节。
取消运单：如果机器人身上有运单，可以使用此按钮取消此运单，如果机器人身上有多个运单，会取消当前正在执行的运单。
故障重试：如果机器人正在执行的运单出现故障，可以使用此按钮重试故障的运单。
不接单/可接单：点击后更改机器人的可接单状态。
获取控制权：当该机器人不受当前调度系统控制时，可以使用此按钮获取机器人的控制权。
停用：点击后停用机器人。注意，停用的机器人需要在场景配置中启用，参照后文《场景配置》章节。
重连：点击后会自动重连一次机器人。
软急停/取消软急停：让机器人进入/退出软急停状态。
## 详细信息
机器人详情面板分组展示了机器人的详细信息，可以通过“配置”按钮右侧的切换按钮快速跳转到指定的信息分组。
## 机器人信息
总体展示机器人信息。包括机器人名字，电量，当前站点，机器人型号图标、在线状态，可接单状态，控制权状态，充电状态，是否仿真，是否急停，是否软急停，是否故障（此处故障指机器人自身是否上报故障信息），所属机器人组，备注信息，机器人 IP，连接类型，状态获取时间。
## 故障信息
显示机器人上报的故障信息。并且提供“清除告警”按钮，可以快速清理某些机器人上报故障。
下面通过演示在仿真中心中给机器人添加故障，模拟真机器人的故障情况。
点击场景界面左上方“设置”按钮旁的“仿真”图标按钮。打开仿真中心界面。
## image.png

在仿真中心页面，找到并勾选我们想要添加故障的机器人，这里我们选择 Box-1。点击“修改机器人告警”。
## image.png

在打开的修改机器人告警弹窗中，点击“添加项”，添加一个告警。告警级别输入“Error”，告警码输入“123”（自定义告警，无实际意义），告警信息输入“Error”。最后点击确定。
## image.png

然后我们再添加一个被阻挡的告警，同理勾选机器人，这次点击“修改机器人状态”。
## image.png

在打开的修改机器人状态弹窗中，勾选“被阻挡”，然后选择“是”，最后点击确认。
## image.png

回到调度场景页面，可以看到地图上机器人已经提示“警”“挡”两个字，表示机器人有告警，并且被阻挡了。信息面板中，故障信息也显示了两条告警，一条为自定义的告警信息，另一条是机器人被阻挡的信息。
## image.png

点击“清除告警”，可以看到自定义的告警被清除，阻挡产生的告警短暂消失后又出现，这是由于被阻挡是机器人持续的状态，即使清除，只要仍然处于被阻挡的状态，机器人还是会持续上报故障信息。仿真机器人模拟的是真机器人的情况。
在仿真中心中，可以取消机器人的被阻挡状态，此处不再赘述。仿真的更多功能，请参照后文《仿真中心》章节。
## 运单信息
显示目前机器人正在执行的运单、已接的运单列表，以及当前的执行情况。没有运单时，执行状态为空闲，无其它信息。
## 库位信息
机器人有单负载和多负载之分。顶升机器人、叉车机器人等只有一个库位，而料箱机器人等有多个库位，同时如果料箱机器人需要抓斗本身载货，则最大负载数 = 背篓数 + 1，面板中“N + 1 模式”为“是”。
每个库位上会显示库位的编号信息，是否有货，占用库位的运单编号，容器编号。
## 位置信息
这里显示一些机器人当前实时的一些位置信息，并且还会显示一些历史信息，比如机器人的今日里程，末次上报位置。
## 观察机器人运行状态
下面我们通过《初始化调度场景》- 简单发单的方式，给机器人下发运单，观察在地图上机器人和机器人详情面板的变化。
## image.png

## 机器人任务
地图上机器人中心和点位的连线表示机器人当前的目标点位，一般是机器人当前执行运单步骤的目标点位。不过由于有跨区域运单的情况存在，机器人的目标点位可能是电梯的前置点。
地图上带有颜色的路径表示机器人到达当前目标点位规划的路径，机器人会沿着这些路径行进。
地图上带有颜色的色块表示当前机器人当前占用（预定）的空间资源，用于机器人和周围空间、其它机器人的碰撞检测。
机器人任务的三种属性都会使用当前机器人的颜色来标识，颜色由调度系统随机生成，三种属性都可以在显示设置中开启或关闭，参见《调度场景界面功能介绍》- 显示设置。
## 机器人 HUD
地图上机器人的 HUD 会显示机器人当前执行的运单、对应步骤以及当前步骤的动作，比如图中的 000024:1:load，表示正在执行尾号为 000024 的运单的第一步，动作为 load。
并且会在下方显示机器人当前库位的信息，如图中是料箱机器人，最大载货数为 4，所以在 HUD 上有 4 个小方格。其中第一个小方格为淡蓝色，表示第一个库位即将载货。剩下的库位为灰色，表示为空。
## 机器人详情面板
在运单信息、机器人库位信息、位置信息中，可以看到出现对应变化。

## image.png

## image.png

## image.png

## 场景统计
调度场景界面最上方是场景统计栏，包含了场景中对应状态的机器人和运单的数量统计，鼠标悬浮在某个统计项上，可以查看此统计项包含哪些机器人/运单。
场景统计栏中，机器人部分包含了对空闲、工作中、故障等的机器人数量统计，我们可以以上文提到的方式，给机器人下发一些运单，给另外的机器人添加故障（比如阻挡），此时场景统计栏显示如下。
## image.png

鼠标在统计项上悬浮，还可以看到该统计项内包含哪些机器人。
点击统计项，可以把机器人名字填入机器人列表的筛选框中，自动筛选出对应机器人。
### 20250922095322_rec_.gif

运单的统计项包括未完成运单和故障运单，和机器人统计同理。
## 机器人列表
点击调度场景界面左侧列表页上方“机器人”按钮，即可切换为机器人列表标签页。
通过列表卡片可以快速查看每个机器人的信息。列表内同组机器人可以折叠/展开卡片。卡片分为简单和复杂卡片两种，切换方式见上一章《调度场景界面功能介绍》- 显示设置。
通过机器人列表的筛选框，可以筛选出所需的机器人，支持精确/模糊匹配。如果想要搜索多个机器人，在机器人名中间用逗号分隔即可。

## image.png
## 简单卡片

## image.png
## 复杂卡片

## 简单卡片
仅显示机器人名称、接单状态、空闲状态、在线状态、故障提示，单击卡片可以在地图上快速定位到机器人，如果机器人不在当前区域，则会有对应提示。
对于正在执行任务（非空闲状态）的机器人，还会有动态效果。
## 复杂卡片
会显示机器人名称、在线状态、接单状态、是否为仿真、当前电量、位置信息、当前载货情况、空闲状态、正在执行的运单、控制权、定位状态、状态更新时间、ip。
在复杂卡片上，还可以点击“AI诊断”“智能恢复”“重置”等按钮对机器人进行操作，点击卡片空白处或者右上角定位按钮，可以快速在当前区域内定位机器人，如果机器人不在当前区域，则会有对应提示。
同时，如果想要查看机器人更详细的信息，可以点击“详请”按钮，在列表下方会以 json 格式显示机器人的详细信息，可以通过最上方灰色拖动条调整此面板高度，点击面板上方的切换按钮，可以将部分信息切换为中文。
## image.png

## 批量操作
在机器人列表中，可以全选机器人、选择某个机器人组、单选某个机器人，选中后可以进行设置机器人（不）接单、智能恢复、获取控制权、重连、清除告警、设置软急停和取消软急停操作。此处按钮功能和上文机器人详情面板中的按钮功能一致，区别在于机器人列表内可以批量操作，比如选中所有故障的机器人，批量“智能恢复”。
## image.png

## 运单和发单
## 发单
在场景界面左侧的“发单”标签页中，可以快速便捷的给机器人下发运单。
## 简单/复杂测试
简单发单测试请参照《初始化调度场景》- 简单发单一节。
除了简单测试，还可以通过编写 json 来添加更复杂的运单，点击添加后，富文本框内有默认样例。简单了解即可，本教程不再说明。
## 随机发单
M4 提供强大的随机发单功能，帮助模拟现场真实情况，以方便进行项目仿真，场景优化，节拍测试等操作。
点击“配置随机发单”按钮，打开编辑随机发单弹窗，M4 支持三种随机发单模式，可以根据需求自由选择。
简单随机发单：填写“保持单量”，会保证场景中未完成的运单数量一直保持为“保持单量”。
按机器人组随机发单：会分机器人组保证场景中每个机器人组未完成的运单数量一致保持为“保持单量”。
按业务线随机发单：可以添加多条业务线。每条业务线需要配置起点库位/点位标签、终点库位/点位标签，机器人组。点位和库位的标签可以在对应的元素详情面板中查看。配置完成后，会在对应标签的点位/库位中随机选择起点和终点，并指定机器人组下发运单，并保证未完成的运单数为“保持单量”。
三种模式都支持选择容器类型（当配置了容器尺寸超过机器人底盘，必选），在创建运单时，会指定对应的容器类型。配置完成后，需要勾选启用随机发单，并点击提交。可以在发单标签页查看是否启用随机发单。
## image.png

## 运单列表
点击调度场景界面左侧列表页上方“运单”按钮，即可切换为运单列表标签页。
列表最上方，可以筛选想要查看的运单，包括“最新”“未完成”“故障”三种，运单列表最多展示 50 条运单数据。如果想要查看更多的运单，可以点击“查看全部运单”按钮，跳转至新通用运单界面。
## 运单卡片
通过运单卡片可以快速查看每个运单的信息，这里以上文简单发单的方式为例，创建一个新运单。
## image.png

在运单卡片中，我们可以查看此运单的一些信息，包括运单编号，运单状态，运单类型（业务，停靠，让路，充电），运单当前步骤，执行机器人，取放货位置，搬运容器，创建时间。
还可以进行取消运单，挂起，AI 诊断等操作。
点击运单编号，可以打开运单详情弹窗，以查看更详细的信息。
## image.png

## 新通用运单
在菜单中选择“新通用运单”，或者使用上文介绍的方法，都可以进入新通用运单界面。
新通用运单是 M4 的一个业务对象，包含了业务对象的基础功能，比如导出、查询、列表界面等，此处不再赘述。
## 新增
下面介绍如何在新通用运单界面新增一个更详细的运单。
点击新通用运单界面左上角的“新增”按钮，打开新增弹窗。
## image.png

新增时会自动选择 M4 内的第一个场景，我们可以指定此运单的优先级，机器人，机器人组等，此处我们可以选择指定机器人为 Box-2，表示我们指定由此机器人执行此运单。如果指定机器人组，系统则会自动选择所选机器人组中可以执行此运单且最合适的机器人执行，如果都不指定，系统则会自动选择所有机器人中可以执行此运单且最合适的机器人执行。
点击“添加步骤”，打开点击步骤弹窗，首先我们选择这一步骤的目标点位/库位，这里我们选择 AP41，动作填写 Load，表示我们想在此步取货，binTask 不填写，参数会根据我们填写的动作或 binTask 自动生成，没有特殊需求，不需要更改。
由于我们想在此步取货，所以必须正确勾选下面的“在此步取货”，否则系统无法正确识别取货步骤。同理如果后续添加放货步骤，也必须正确勾选“在此步卸货”。在 M4 调度中，一个运单至多只能有一组取放货步骤，或者没有取放货步骤，且取放货步骤必须成对出现。
## image.png

步骤编辑完成，点击“确定”，保存此步骤。
## image.png

对于添加好的步骤，可以编辑/删除该步骤，也可以继续添加后续步骤。此处我们可以不添加后续步骤，勾选“暂不封口”，表示此运单执行完后，还可以继续添加步骤。
## image.png

点击“提交”，可以在列表中看到此运单已经成功创建，回到调度场景界面，可以看到指定机器人 Box-2 正在执行刚才添加的取货步骤。

## image.png

## image.png

取货步骤完成后，运单变成待执行状态，我们回到新通用运单界面，在列表页中找到刚才创建的运单，点击查看，在步骤内点击添加步骤，可以继续为运单添加放货步骤。也可以在调度场景界面，运单列表里点击对应运单卡片的单号，打开运单弹窗，来为运单添加步骤。
点击添加步骤，点位或库位选择 AP42，动作填写 unLoad，勾选“在此步卸货”为是，表示这是一个卸货步骤，点击“提交”。
## image.png

添加完放货步骤后，我们不再需要为运单添加后续步骤，所以此时我们需要对运单进行封口操作，代表此运单已经接受。对于封口的运单，所有步骤都执行完成后，会变成已完成的状态。可以点击查看运单弹窗中的“封口”按钮，对运单进行封口，也可以在新通用运单列表界面中，选中要封口的运单，点击上方的“封口”按钮，进行（批量）封口。

## image.png

## image.png

## 运单数据统计
在新通用运单这个业务对象内，我们设置了一些字段，比如完成时间，执行耗时，处理耗时，机器人分配时间等，便于观察一个运单的执行情况，或者进行一些统计。同时，列表界面上方也有内建的一些统计信息，如故障运单、挂起运单等。
## image.png

## 猎鹰任务发单
在现场应用时，大部分时候都采取编写猎鹰任务的方式来下发运单，下面简单介绍如何通过编写 M4 猎鹰任务来为调度下发运单。注意，学习本节前，请确保已经掌握猎鹰任务的基础使用。
此次猎鹰任务的大致流程为：创建第一个运单，让机器人从起点搬运至终点，第一个运单结束后，创建第二个运单，让另一个机器人从起点搬运至终点。
在猎鹰任务管理界面，先添加一个任务模板。这里我们可以取名为“猎鹰任务下发运单”。
### 添加两个任务参数，作为搬运任务的起点和终点。参数配置如下：

## image.png

## image.png

按照上述流程，我们一次性添加好所需组件，和 M4 调度有关的组件都在“三代调度运单”分组下。每个组件的含义都可以通过组件名和组件说明了解，此处不再赘述。

## image.png

## image.png

接下来设置每个组件的输入参数。
b1 组件，创建第一个运单。
场景名称，在固定值中填入 demo。
期望执行的机器人，在固定值中填入 Box-2，方便下发第二个运单的时候，让另一个机器人执行。
关键位置，由于猎鹰任务的特性，运行到这个组件的时候，已经创建出了运单，但是没有步骤，所以此处我们需要填入关键位置，和在新通用运单里新建运单有所不同。这里我们引用 [任务输入参数] 起点。
其它参数，可以按需填写，此处我们不需要，所以不填写。
b2 组件，为第一个运单添加取货步骤，并等待此步骤完成。
运单号，引用 b1 组件输出的运单号，表示我们是给 第一个运单 添加步骤。
点位或库位，引用 [任务输入参数] 起点。
operation，机构动作名，填入 Load。
在此步取货，设置为 是。
b3 组件，为第一个运单添加放货步骤，并等待此步骤完成。
运单号，引用 b1 组件输出的运单号，表示我们是给 第一个运单 添加步骤。
点位或库位，引用 [任务输入参数] 终点。
operation，机构动作名，填入 unLoad。
在此步卸货，设置为 是。
b4 组件，结束第一个运单，也就是封口第一个运单。
运单号，引用 b1 组件输出的运单号。
b5 组件，创建第二个运单。这里其它参数同 b1 组件，但是期望执行的机器人，我们填入 Jack-1，表示我们想让 Jack-1 去执行运单。
b6、b7 组件，同 b2、b3 组件，注意运单号引用 b5 组件输入的运单号，表示给第二个运单添加步骤。
b8、b9 组件，分别引用 b6、b7 组件输出的步骤 ID。
b10 组件，同 b4 组件，注意运单号引用 b5 组件输入的运单号，表示封口第二个运单。
组件参数设置完成后，我们保存并运行此猎鹰任务，并输入起点为 AP41，终点为 AP42，查看运行效果。
细心的同学应该已经发现了，第二个运单添加步骤的组件似乎和第一个运单不太一样，这里我们讲解一下区别。
第一个运单使用的是添加三代运单步骤并等待完成这个组件，此组件在添加步骤后，会一直等到此步骤执行完成，才会继续执行后续的组件。对应到运行效果中，可以发现当第一个步骤执行完成后，第二个步骤才添加到运单中。
第二个运单使用的是 添加三代运单步骤 这个组件，此组件在添加步骤后，不会等到此步骤执行完成，会直接执行后续的组件。对应到运行效果中，可以发现第一个步骤未执行完毕，就有第二个步骤了。最后我们使用等待三代运单步骤完成这个组件，在所有步骤执行完成后，再封口第二个运单。
所以实际上添加三代运单步骤并等待完成 = 添加三代运单步骤 + 等待三代运单步骤完成，且中间不执行其它组件。在实际项目中，可以按需选择。
## 场景编辑
M4 支持在场景运行过程中实时修改场景配置，并立即生效。
在调度场景界面，点击左上角“设置”按钮，即可进入场景编辑界面。如果有多个场景，我们可以在左侧场景列表选择我们要查看/编辑的场景。
部分功能已在《初始化调度场景》中介绍，下面介绍其它功能。
## 停用场景
对于暂时不使用的，但是将来可能还需要的场景，可以点击“停用按钮”，将其停用。停用的场景会显示在在左侧场景列表的“停用场景”分组内。停用场景时，场景内的机器人、门、电梯等也会被停用。如果有对应的仿真设备，会一并删除。
点击已经被停用的场景，可以看到场景已被停用的提示以及场景 ID，我们可以启用此场景，重新恢复使用，也可以在不启用场景的情况下，直接导出或者删除场景，方便使用。

## image.png

## image.png

## 配置
点击“配置”，可以进入配置标签页，在此标签页下，我们可以修改调度系统的总体配置，比如交管策略，派单策略等。
目前，调度配置项的默认值都是我们测试过的，正常运行调度时，基本无需修改，如果确实有修改的需要，比如充电策略等，可以自行查看每个配置项的说明，进行合理的修改。
## 机器人
点击“机器人”，可以进入机器人标签页，在此标签页下，我们可以修改场景中的机器人信息，新增删除机器人。机器人标签页上方是对此场景中机器人数量的统计，包括所有机器人数，启用机器人数和停用机器人数。
## image.png

在机器人操作栏，可以（批量）启用/停用机器人、启用/停用仿真，新增删除机器人。
## image.png

在 M4 中，一个场景的机器人可以划分为多组，组内机器人地图、模型相同，在相同的区域中运行。
下面通过新增 顶升 机器人为例，来演示机器人配置的相关功能。
首先机器人一定要属于一个机器人组，所以我们先添加一个机器人组，点击“添加机器人组”按钮，打开编辑机器人组弹窗。
输入机器人组名称：DS。
货物能旋转，开启，表示此机器人组的机器人顶升机构支持旋转。
货物尺寸超过机器人底盘，开启，表示此机器人组的机器人载货后，货物轮廓会超过机器人底盘大小。
### 碰撞模型，我们按照顶升机器人的实际大小分别输入
## 机器人宽度：0.5
## 机器人头部：0.4
## 机器人尾部：0.4
安全距离，这里没有特殊需求，按照默认值即可。
机器人速度配置，可以暂不填写。
型号，目前型号主要用于地图上的显示，我们选择第一个，表示顶升机器人的图标即可。
叉车，都是叉车相关的配置，我们配置的是顶升机器人，则不需要配置。
## image.png

编辑完成后，点击“确定”，可以看到此机器人组已经成功添加。
接下来我们为 DS 机器人组添加机器人。
点击机器人操作栏中的“添加”，打开新增机器人弹窗。
我们可以选择添加一个机器人，或者同时添加多个机器人，添加一个机器人时直接输入名称即可，这里我们演示如何添加多个机器人。
选择“新增机器人数量”为多个。
机器人名称前缀，一般是机器人组名加“-”，所以此处我们填入 DS-。
编号位数填入 1，开始编号为 1，结束编号为 2，表示我们添加了三个机器人编号从 1 到 2。
机器人组选择刚才创建的机器人组 DS。
厂商默认为 仙工，无需修改。
最大载货数，N+1，由于是顶升机器人，只有一个载货位，使用默认值 1 即可。
由于没有真机器人，所以我们启用仿真。
## image.png

配置完成后，点击保存。
机器人成功创建后，仍处于离线状态，这是由于此机器人组不存在于任何一个区域中（没有地图），系统也就无法创建对应的仿真机器人。
## 区域
点击“区域”，进入区域标签页。在区域标签页下，我们可以查看/编辑现有区域，也可以新增区域。
如果一个机器人组在某个区域下有地图，即代表这个机器人可以在此区域下运行。
## image.png

点击操作列的“查看”按钮，可以打开 smap 查看器，快速查看此机器人在对应区域下的地图。smap 查看器内，也可以通过左上角的工具栏缩小、放大地图，查看全部地图、搜索地图元素。
## image.png

下面，我们为上文中新增的机器人组添加地图。
我们可以先点机器人组 Jack 在区域 F1 的地图名“f1.smap”将地图下载下来。
点击 F1 区域的编辑按钮，打开区域编辑弹窗。
点击机器人组 DS 一栏的“上传地图”按钮，上传刚才下载的地图。
## image.png

点击“保存”。回到基础标签页，点击“一键仿真”，重新创建仿真机器人。
在调度场景页面，即可查看到上文创建的机器人出现在 F1 区域中。
## 容器类型
点击“容器类型”，进入容器类型标签页，在此页面下，可以新建、删除、编辑此场景下的容器类型。
教程提供的场景下，已经包含一个容器类型，我们可以点击此容器类型的卡片，查看容器类型的信息。
## image.png

左侧尺寸数据的含义，可以在右侧容器预览图中查看，此处不再赘述。
## 下发带有容器类型的运单
下面我们给上文创建的机器人下发带有容器类型的运单的运单，查看运行效果。
在调度场景页面，根据《初始化调度场景》章节教学的方法，打开简单发单在线帮助。
找到示例中的第 9 条，点击“去执行”。
## image.png

将机器人名，容器类型名，点位名改为现在场景中的数据：DS-1@CT1$AP41:Load->AP42:Unload。
点击“执行”，观察运行效果。
可以看到，机器人取货完成后，身上出现代表容器的灰白色方块，并且碰撞模型也会对应增加。
## image.png

## 设备
目前 M4 支持在调度中配置门和电梯两种设备。
## 门
教程提供的场景，已经配置好了门。在地图上可以看到，门的显示如下图所示。

## image.png
## 门关

## image.png
## 门开

选中“门”，我们可以在元素详情面板中，查看门的详情，比如是否停用、在线、故障、仿真等信息，以及当前的开关门状态，正在使用的机器人等。还可以进行开门、关门等操作。
## image.png

在 M4 中，配置好门后，系统会自动识别处理需要使用门的任务，并自动执行开关门等操作。
下面，我们可以使用《初始化调度场景》章节中教学的简单发单方法，创建一个需要经过门的运单，观察运行情况。
简单发单命令：Box-2@LM35:wait->LM27:wait
可以看到，机器人到达 LM35 后，门自动打开，供机器人通过，机器人通过后，门自动关闭。门的详情面板内，也会显示当前经过的机器人。
## image.png

## 电梯
教程提供的场景，已经配置好了电梯，在地图上可以看到，电梯的显示如下，会显示当前名字和所在楼层，以及电梯门的打开关闭状态。
## image.png

选中电梯，我们可以在电梯的详情面板中，查看电梯当前状态，比如是否停用、在线、故障、仿真等信息，以及当前区域和目标区域。还可进行呼叫电梯至指定区域，关闭电梯门等操作。
在 M4 中，配置好电梯后，系统会自动识别处理跨区域任务，并自动执行呼叫电梯，运送机器人等操作。
下面，我们可以使用《初始化调度场景》章节中教学的简单发单方法，创建一个需要经过门的运单，观察运行情况。在发单前，我们可以先在场景编辑中，查看哪些机器人组可以在多个区域中运行。如图所示，应为机器人组 Fork。
## image.png

简单发单命令：Fork-1@AP42:Load->AP66:UnLoad
可以看到，Fork-1 在区域 F1 的 AP42 完成取货动作后，需要前往区域 F2 的 AP66 执行放货动作时，系统自动呼叫电梯至区域 F1，并将电梯门打开，机器人乘坐电梯到达区域 F2 后，电梯门自动关闭。在详情面板中，也会显示正在使用当前电梯的机器人。
## image.png

## 地图编辑
## 入口
调度场景页默认为查看模式，如果要编辑地图，需要先进入编辑模式。在进入编辑模式前，我们先切换到需要编辑的区域，因为编辑模式下，不允许切换区域。然后在调度场景页面右上角，点击编辑按钮，进入编辑模式。
## image.png

进入编辑模式后，右上角的编辑按钮变成退出编辑按钮。机器人、门、电梯默认不显示。在地图底部，可以看到各项常规编辑类按钮，包括保存、取消保存、撤销、重做、删除等。每个按钮的含义可以通过鼠标悬浮在按钮上看到。
## image.png

## 分组地图与合并地图
对某个区域而言，由于车型的差异，每个区域下每个机器人组有各自的地图。这个区域下的所有机器人组的地图合并成一张汇总的“逻辑地图”，即合并地图。
在地图底部，我们可以选择编辑的对象，即切换编辑合并后的地图，还是某个机器人组的地图。
## image.png

在合并的地图里，添加元素、修改元素、删除元素对所有机器人组生效。如将一个单向路径变为双向、将双向路径变为单向、修改路径某属性，都属于添加、删除、修改元素的范围，会对所有机器人组生效，且以上操作是立即响应生效，具体表现为元素详情面板的变化，不需要等待保存。
## 元素详情面板
元素详情面板默认折叠，需要在地图中选择一个元素，点击右侧的展开按钮，将元素详情面板展开。
## image.png

以点位为例，点击地图的某个点位，如 LM27。点位的详情面板展示点位属性，对于不可编辑的属性，会呈现只读或禁用状态，无法修改。
当编辑对象是合并地图的时候，表头分别是属性列、默认值列、各机器人组定制列。
默认值列展示合并地图的属性值，各机器人组定制列展示各机器人组是否定制的状态。当机器人组需要定制时，在对应的定制列填写属性即可。
如果某属性不支持定制，会显示“不支持定制”的标识，如果某机器人组的值和默认值相同，则表现为空白，但如果和默认值不同，表示存在定制，则会显示出该组特有的值。
## image.png

当编辑对象是分组地图的时候，表头分别是属性列、默认值列、该组的设置列。
默认值列的值来源于合并地图中的“默认值”列的值，当合并地图的默认值被修改后，分组地图的默认值列同步变化。
## image.png

## 修改点位属性示例
我们以修改 LM27 点位的“不允许避让”属性为例，在合并地图的默认值中修改“不允许避让”为是，分组定制中，Jack 和 Box 两组都改为否，剩下 Fork 不变。
## image.png

切换到 Jack 分组地图，可以看到默认值列和本组的列的该属性的值已经发生变化，Box 组同理。
## image.png

Fork 组未定制，因此该列的值为空，表示遵从默认值。
## image.png

为了演示方便，以上修改先不保存，保存在后文编辑都介绍完毕再讲解。
## 路径方向变化
我们选中 LM27 和 LM31 中间的路径，是双向路，因此有两条路径元素。可以在路径详情面板的顶部米字筛选器和右侧的输入框中看到选中路径的方向和路径的名称。
## image.png

路径详情面板有三个快捷按钮，分别是“变为双向线”、“变为单向线”、“反转方向”。
变为双向线：只对单向路径生效，点击后，为选中的路径增加一条反向的路径。
变为单向线：只对双向路径生效，点击后，四种对应方向的双向路径（上/下，左/右，左上/右下，右上/左下），固定保留 上、左、左上、右上 四种方向的路径，删除另一个方向的路径。比如 上/下 方向的双向路径，保留向上的路径，删除向下方向的路径。
反转方向：只对单向路径生效，点击后，反转路径方向，既交换路径的起点和终点。
## image.png

我们点击“变为单向线”按钮，该条路径变为单向线，切换到分组地图查看，分组地图中如果有该元素，该条路径元素也会被修改为单向线。
## image.png

## image.png

## image.png

我们再选中 Box 组地图的该路径，点击路径详情面板的“反转方向”将其反转方向，可以看到路径已经改变方向，变为向右。

## image.png

## image.png

但是其他组的该路径方向不受影响，依然向左；由于多组地图的该路径方向不一致，因此合并地图也不会改变方向，也是向左。只有当区域下所有分组地图的路径方向都一致时，合并地图的路径方向才会变为这个一致的方向。
## image.png

具体大家可以自己尝试一下，这里将所有分组地图的该条路径的的方向都变为向右时，发现合并地图也变为向右了
## image.png

除了以上操作外，我们还可以选择单向路，点击面板上的“变为双向线”，将其变为双向路径。
## image.png

## 批量修改
除了点选元素，编辑其属性外，支持批量修改元素属性。在地图底部操作栏，找到框选按钮，鼠标框选元素。右侧详情面板会自动识别框选的元素类型，并将元素详情面板顶部的标签变为蓝色，表示框选范围中涵盖该类元素。这里默认按照顶部的元素类别的标签顺序打开详情面板。
我们选择了点位和路径两类元素，默认打开了点位的详情面板，我们可以为这些点位批量设置属性值，比如设置为不允许避让。
## image.png

切换到路径的详情面板，可以看到路径方向选择器中标识除了当前涵盖的路径方向。
## image.png

在路径方向选择器中取消选择上下的方向，在地图中可以看到，这里只保留了左右朝向的路径，然后将其设置为倒走，即可批量设置成功。
## image.png

其他元素的批量修改同理。
## 添加地图元素
## 添加文字
由于文字和图片是地图装饰性元素，因此只有调度形成的合并地图才可以添加文字和图片，分组地图没有文字和图片元素。我们确保编辑对象是合并地图，点击地图底部的操作栏中的添加文字按钮。
## image.png

一段默认文字会被添加到地图中，且是默认选中状态，打开其属性面板，可以看到分组定制的列下都是“-”，这是因为机器人组地图不支持文字和图片元素。
## image.png

我们可以修改对应属性，比如修改文字的内容变为"机台"，并修改其颜色，字号为 20，然后将其拖动到合适的位置即可。
## image.png

## 文字“特殊位置”属性有两种：
锁定到屏幕上方：层级最上，选中时优先级最高，且固定位置、层级、文字大小，文字大小不随着地图缩放。常用于作为一个地图的标题固定显示。如本教学场景的 seer demo scene 文字。
### 无：默认是无，这种方式，文字将随着地图缩放
## image.png

层叠有地图之上和地图之下区分，主要是决定了文字在地图元素的上方还是下方。
## image.png

## image.png

可点击顶部“删除所选文字”按钮，删除文字。
## 添加图片
点击地图底部操作栏的“添加图片”按钮，选择一张图片添加到地图中。
## image.png

添加的图片支持八个句柄调整图片大小，在详情面板可以更改图片的宽高、不透明度、xy 值等属性。点击详情面板顶部的“删除所选图片”按钮即可删除图片。
## image.png

## 添加区块
我们只能在合并地图中添加区块，点击底部的添加区块按钮，用鼠标左键在地图目标位置绘制一个区块，添加完，默认被选中。详情面板可以看到区块的属性。
## image.png

区块的备注名就是区块显示在地图中的文字，还可以修改区块的停用、xy 值和宽长。
## 目前区块支持三种类型：
## 说明区：仅做说明，无其他用途
## 互斥区：该区域只能有一台车
自由导航区：机器人进入该区域，调度不再进行交通管制（如不再申请空间资源），由机器人自行进行导航避障。
## image.png

## 删除地图元素
可以删除单个元素，也可以同时删除多个元素。在点选模式下，选择一个元素，可以按住 shift 复选其他元素；或者直接点击框选按钮，进入框选模式，框选元素。点击地图底部操作栏的删除按钮。将弹出对话框，当选择了多种元素时，可以在对话框内对元素取消勾选，避免误操作，确定删除对象后，点击确定，即可删除。

## image.png

## image.png

## 撤销与重做
在地图底部的操作栏，有两个箭头，分别表示撤销和重做，比如刚刚删除了地图元素，但是删错了，可以点击撤销，撤销到上一步，或重做。
## image.png

## 缓存
如果编辑中，保存退出前，页面崩溃了，或直接关闭了。下次再打开，会检测到有未清除的缓存。提示用户：检测到有未保存的编辑，是否加载。确定后，加载缓存。主要是为了避免丢失编辑的内容。
## image.png

## 保存与推送
当对地图编辑完毕，点击底部的保存按钮，修改将保存。对于元素属性来说，只有启用和停用是不用推送到机器人地图中的，其他所有属性的编辑，都需要进行推送地图的操作后，才会生效。
当修改的内容不想保存，则点击底部的取消保存按钮，系统自动退出编辑模式。
我们修改完毕，点击保存，在提示的对话框中，点击立即推送按钮，然后在推送地图给机器人的对话框中，点击“仅选择不匹配的机器人”按钮，实现快速勾选，点击底部的“推送”，将修改推送给机器人即可。
除了同步推送，还支持异步推送，即后台推送。

## image.png

## image.png

## 仿真中心
## 入口
点击调度场景顶部的仿真中心按钮，进入仿真中心页面。
## image.png

## 仿真配置
点击"仿真配置"按钮，点击后弹出"仿真配置"对话框。
## image.png

配置中分为三小节。
## image.png

可以启用仿真电量，并配置充电耗电时，电量增加或者减少时的速率，来实现更精准的模拟（如验证充电策略）。当未启用的时候，仿真机器人的电量恒定不变，不会增加或消耗。
可以配置动作耗时，分为三种速度和一个默认动作耗时。还可以点击“添加动作”，给其他动作自定义耗时。如给 load 动作定义 0.5 秒的耗时。
## image.png

到点偏差：距离偏差默认 0.005 m，角度偏差默认 0.01 rad，可以根据需求修改。
## 修改机器人配置
勾选一个机器人，点击“修改机器人配置”，或者直接点击机器人卡片，在弹出的对话框中，点击“修改机器人配置”

## image.png

## image.png

在对话框中，可以修改机器人的各项配置，比如修改机器人背篓数，或者给机器人上传地图。
## image.png

## 修改机器人状态
勾选一个机器人，点击“修改机器人状态”，或者直接点击机器人卡片，在弹出的对话框中，点击“修改机器人状态”

## image.png

## image.png

在对话框中，可以修改机器人各项状态。在仿真时，经常需要构造一些急停或者阻挡等信息，或者给机器人的不同背篓构造不同的容器，都可以在此处设置。注意要先对需要设置的配置项打上勾，才能进行设置，主要是为了避免误触。
## image.png

## 修改机器人告警
勾选目标机器人，点击“修改机器人告警”，为机器人添加告警信息，可以构造仿真机器人的告警场景。这里告警级别有三种，error、warning、fatal，告警码为任意数字。这两项的输入有限制，不能随便填，否则不生效。

## image.png

## image.png

确定后，就可以在地图页面看到机器人的告警信息，主要在三处有提示：左侧机器人卡片、右侧机器人详情面板、机器人本体呈现“警”字标识。
## image.png

## 随机初始化点位
选择目标机器人，点击“随机初始点位”，界面将提示成功，目标机器人则随机变更初始点位。
## image.png

## 急停/软急停与解除
勾选目标机器人，点击顶部的对应按钮，就可以对一台或多台机器人进行批量急停和解除急停，或者软急停的操作。
## image.png

操作成功后，机器人详情面板上会有相关状态显示。
## image.png

## 回放
## 场景回放
场景回放可以帮助查看机器人历史运行情况。情景再现，方便回溯和排查问题。
## 运行记录
首先，确保运行记录是打开状态。场景编辑 -> 配置 -> 机器人，可以打开运行记录并自定义记录保留天数。
## image.png

运行记录是否开启，也可以直接在地图下方场景状态栏中查看。
## 回放入口
在地图状态栏，可以进入和退出回放模式。开启后，地图下方显示回放面板，同时地图区域显示回放时间段的运行情况。关闭回放时，回到实时地图。页面如下。
## image.png

## 回放时间段的运行情况（图）
## 回放面板
回放面板包括回放文件、播放设置、时间轴。
可以通过下拉框选择要回放的时间段文件。回放文件每小时自动生成一个文件，默认会显示当前最新文件。可以刷新、下载回放文件、打开其他下载的回放文件。在现场应用中，我们可以在本地打开项目现场远程发送的回放文件，帮助我们远程分析现场问题，前提是现场场景和本地场景需要相同。
## image.png

## 时间轴
时间轴显示刻度、滑块，可以通过拖动滑块，切换到滑块对应时刻下的内容。时间轴上，不同颜色表示不同状态。
灰白色表示底色。灰色表示此时间内有录制，白色表示此时间内没有录制。
绿色表示此时间内场景里有机器人正在运行。
红色表示此时间内场景运行有故障。
## image.png

中间的按钮可以单击以控制回放开始、暂停。
## image.png

播放栏有四个跳转关键帧的快捷键，点击左右两侧的箭头（绿/红），可以快速跳转到上/下一帧有机器人运行的帧/场景有故障的帧，例如：
单击右侧（绿）的箭头，滑块会从当前灰色位置，跳转到绿色部分（场景有机器人运行）开始的位置。
## image.png

单击右侧（红）的箭头，滑块会从当前位置，跳转到红色部分（场景有故障）开始的位置。
## image.png

可以根据需要调整回放视频的倍速。右侧输入框支持输入分、秒，定位到视频具体时刻，也可以通过 +、- 调整当前时刻。
## image.png

## 运单重放
运单重放可以重新创建所选运单，帮助回溯问题，或者检验问题是否已修复。
注意：运单重返是将过去的运单重新创建执行一遍，和场景回放有所不同，所以执行结果和之前可能不相同。
## 导出快照
首先，找到运单列表页顶部操作栏“导出快照”按钮，可以对运单进行导出。注意，该功能只支持业务单的导出。
## image.png

单击“导出快照”后，弹出对话框。可以填写备注（对本次导出的目的或说明），在下一次打开快照时会显示出来。同时选择导出范围，包括选定范围和自定义查询。
选定范围：需要人工勾选运单列表页需要导出的业务运单，此时弹窗下方会进行提示，已选中 X 行，再点击“导出快照”按钮。
自定义查询：可通过条件筛选，例如选择“状态”= “已完成”的业务运单，进行导出。

## image.png

## image.png

点击“生成 orders.json 文件”，对话框提示，成功导出，点击下载到本地。完成本次业务运单快照导出。
## image.png

## 开始重放
在发单面板下方界面，找到“开始重放”按钮，点击上传 orders.json 文件。加载后对话框显示如下，此时可以对状态进行筛选，默认全部选择。
可通过保持分配关系，将运单分给记录中原来分派的机器人，前提是场景得有该机器人。若不选择，运单可以重分派给其他机器人。点击执行后，系统会自动创建一个运单。

## image.png

## image.png

## image.png

点击执行后。从创建时间最早的运单开始进行运单回放，机器人接单，同时左侧提示“重放中......”，还可以点击“停止重放”。重放会重新生成新的单号（与原来运单单号无关），可以在新通用运单列表中查看。
## image.png

## 简单处理调度问题
## AI 诊断
## AI 诊断入口
遇到机器人、运单问题推荐优先询问 AI 诊断，AI 诊断可以处理使用过程中绝大部分常见问题。AI 诊断有以下入口：
场景统计栏左统一入口。点击后，选择机器人/运单问题诊断。查看全部，进入到问题诊断页。先选择需要诊断的机器人/运单，再搜索问题。
## image.png

## image.png

机器人复杂卡片下方/机器人详情面板。点击后，默认诊断对象为该机器人，此时可以搜索需要询问的问题，点击立即诊断。

## image.png

## image.png

## image.png

运单卡片下方。点击后，默认诊断对象为该运单，此时可以搜索需要询问的问题。点击立即诊断。

## image.png

## image.png

## AI 诊断举例
## 常见问题 1：机器人为什么不动？
这里我们先通过上文介绍的方法，在仿真中心中，将机器人 Jack-1 电量设置为 9%（低于 ChargeOnly 电量 10%，表示机器人电量过低，必须要去充电）
给 Jack-1 创建一个到 LM40 等待的运单。
## image.png

此时机器人状态在线、可接单。但机器人并未去接单。我们可以通过 AI 诊断排查问题。
诊断结果表示，有运单的机器人/运单没有故障，才可以接单。同时我们发现运单为待分派状态，说明此时机器人未被分派，继续提问机器人能否接单，AI 诊断结果表示当前机器人电量低于阈值，不能接单。

## image.png

## image.png

## 常见问题 2：机器人为什么不去充电？
Jack-1 机器人当前电量为 9%，但并未生成充电运单。
我们通过 AI 诊断，发现原因为配置了：暂停自动充电。因此，解决这个问题，我们只需要先取消“暂停自动充电”。
## image.png

## image.png

### 常见问题 3：运单为什么没有机器人接单？
创建一个运单：到 LM61 取货、LM62 放货的运单。运单一直待分派，没有机器人接单。通过 AI 诊断，诊断结果为路径不可达。
通过排查我们发现， LM61 、LM62 所在区域接单的机器人组被停用，该区域没有可以到达的机器人。因此需要重新启用机器人组/让其他机器人组到该区域工作。

## image.png

## image.png

## 人工完成
一些特殊情况，例如当机器人完成取货后，因为一些原因取消了订单，此时货物还在机器人身上，系统会报错，需要人工取走。
我们可以先给机器人下发一个取放货运单，再机器人取货后，点击取消运单，以模拟现场情况。可以发现，地图上机器人 HUD 的库位信息变为红色，系统出现告警。
当人工取走后点击“人工完成”，告警消失。
## image.png

## 故障重试
当机器人执行运单且出现故障时，系统会告警，可以排除故障后，点击“故障重试”，恢复运单执行，也可以点击“取消运单”，取消后不可恢复。
## image.png

## 待完成内容：
## 高级
## 批量搜索、高级筛选
## 地图分屏
## 调试
## 实时路况
工具栏“更多”菜单。测量尺，启用/停用地图元素。
在“更多菜单”中点击“测量尺”按钮，进入测量尺模式，在地图上选择起点和终点，可以得到起点终点的坐标和坐标差值，以及两点之间的长度、角度和弧度。
## image

（批量）选中地图元素后，点击“更多菜单”中的“启用/停用地图元素”，在点击后的二次弹窗中再次确认，可以快速启用/停用选中的地图元素，如果选中了多种类别的元素，可以选择想要停用的地图元素类型。
## image.png
